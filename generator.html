<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
<!-- üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨: Content Security Policy -->
 <meta http-equiv="Content-Security-Policy" 
    content="default-src 'self'; 
             script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com; 
             style-src 'self' 'unsafe-inline'; 
             img-src 'self' data: blob: https:;
             media-src 'self' data: blob: https:;
             connect-src 'self' ws: wss: https:;
             frame-src https://www.youtube.com https://www.youtube-nocookie.com https://www.tiktok.com https://www.instagram.com https://youtube.com https://youtu.be;">
			   
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title id="pageTitle">CardGift - Digital Card Generator</title>
  
  <!-- PWA Meta tags -->
  <meta name="description" content="–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ –∑–∞ —Å–µ–∫—É–Ω–¥—ã!">
  <meta name="theme-color" content="#FFD700">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <!-- Favicon fix -->
   <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÅ</text></svg>">
  
  <!-- DYNAMIC OPEN GRAPH for social previews -->
<meta property="og:title" content="CardGift ‚Äì Digital Card Generator" id="ogTitle">
<meta property="og:description" content="–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ –∑–∞ —Å–µ–∫—É–Ω–¥—ã!" id="ogDescription">
<meta property="og:image" content="" id="ogImage">
<meta property="og:image:width" content="1200" id="ogImageWidth">
<meta property="og:image:height" content="630" id="ogImageHeight">
<meta property="og:url" content="" id="ogUrl">
<meta property="og:type" content="website">
<meta property="og:site_name" content="CardGift">
<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="CardGift ‚Äì Digital Card Generator" id="twitterTitle">
<meta name="twitter:description" content="–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ –∑–∞ —Å–µ–∫—É–Ω–¥—ã!" id="twitterDescription">
<meta name="twitter:image" content="" id="twitterImage">

  
  <!-- WEB3 –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="js/wallet-state.js"></script>
  
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
  <script src="/js/config.js"></script>

<!-- –í–°–ï –í–ê–®–ò –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –°–¢–ò–õ–ò - –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô -->
<style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: Arial, sans-serif;
      }
      
      body {
          background-color: #111;
          color: #FFF;
          padding: 20px;
          max-width: 480px;
          margin: 0 auto;
          position: relative;
      }

      /* –ó–æ–ª–æ—Ç—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ */
      body::before {
          content: '';
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.05) 0%, transparent 50%),
                      radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
          pointer-events: none;
          z-index: -1;
      }

      /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
      .language-switcher {
          position: fixed;
          top: 10px;
          right: 10px;
          z-index: 1000;
          display: flex;
          background: rgba(0, 0, 0, 0.8);
          border-radius: 15px;
          padding: 4px;
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 215, 0, 0.3);
      }

      .lang-btn {
          background: transparent;
          border: none;
          color: #FFD700;
          padding: 6px 10px;
          border-radius: 10px;
          cursor: pointer;
          font-size: 12px;
          font-weight: bold;
          transition: all 0.3s ease;
          min-width: 30px;
      }

      .lang-btn.active {
          background: rgba(255, 215, 0, 0.3);
          color: #FFF;
      }

      .lang-btn:hover {
          background: rgba(255, 215, 0, 0.2);
      }
      
      .header {
          text-align: center;
          margin-bottom: 30px;
          margin-top: 40px;
      }
      
      .logo {
          font-size: 36px;
          font-weight: bold;
          background: linear-gradient(45deg, #FFD700, #FFA500);
          -webkit-background-clip: text;
          background-clip: text;
          -webkit-text-fill-color: transparent;
          margin-bottom: 10px;
      }
      
      .tagline {
          font-size: 16px;
          color: #CCC;
      }
      
      .section {
          background-color: #222;
          border-radius: 15px;
          padding: 20px;
          margin-bottom: 20px;
          border: 1px solid #333;
      }
      
      .section-header {
          display: flex;
          align-items: center;
          font-size: 18px;
          font-weight: bold;
          margin-bottom: 15px;
          color: #FFD700;
      }
      
      .section-header .icon {
          margin-right: 10px;
          font-size: 24px;
      }
      
      .input-field {
          width: 100%;
          background-color: #333;
          border: 1px solid #444;
          color: #FFF;
          padding: 12px 15px;
          border-radius: 10px;
          font-size: 16px;
          margin-bottom: 10px;
          resize: vertical;
      }
      
      .input-field:focus {
          outline: none;
          border-color: #FFD700;
      }
      
      textarea.input-field {
          min-height: 100px;
      }
      
      .media-upload {
          border: 2px dashed #FFD700;
          border-radius: 10px;
          padding: 40px 20px;
          text-align: center;
          cursor: pointer;
          transition: all 0.3s ease;
          margin-bottom: 15px;
      }
      
      .media-upload:hover {
          background-color: rgba(255, 215, 0, 0.05);
      }
      
      .media-upload-icon {
          font-size: 48px;
          margin-bottom: 15px;
          color: #FFD700;
      }
      
      .media-upload-text {
          color: #CCC;
      }
      
      .media-upload-subtext {
          font-size: 14px;
          color: #888;
          margin-top: 10px;
      }
      
      #mediaPreview {
          display: none;
          margin-bottom: 15px;
          border-radius: 10px;
          overflow: hidden;
          background-color: #000;
      }
      
      .style-options {
          display: flex;
          overflow-x: auto;
          gap: 15px;
          margin-bottom: 20px;
          scrollbar-width: none;
          -ms-overflow-style: none;
          scroll-behavior: smooth;
      }
      
      .style-options::-webkit-scrollbar {
          display: none;
      }
      
      .style-option {
          flex: 0 0 120px;
          border: 2px solid #444;
          border-radius: 10px;
          padding: 15px 10px;
          text-align: center;
          cursor: pointer;
          transition: all 0.3s ease;
      }
      
      .style-option:hover {
          border-color: #FFD700;
          background-color: rgba(255, 215, 0, 0.05);
      }
      
      .style-option.active {
          border-color: #FFD700;
          background-color: rgba(255, 215, 0, 0.1);
      }
      
      .style-icon {
          font-size: 32px;
          margin-bottom: 10px;
      }
      
      .style-name {
          font-weight: bold;
          color: #CCC;
      }

      .toggle-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
      }
      
      .toggle-label {
          font-weight: bold;
          color: #CCC;
      }
      
      .timer-input {
          display: flex;
          align-items: center;
          margin-bottom: 10px;
      }
      
      .timer-label {
          width: 180px;
          color: #CCC;
      }
      
      .timer-field {
          width: 80px;
          background-color: #333;
          border: 1px solid #444;
          color: #FFF;
          padding: 8px;
          border-radius: 5px;
          text-align: center;
      }
      
      .timer-suffix {
          margin-left: 10px;
          color: #888;
      }
      
      .header-actions {
          display: flex;
          justify-content: space-between;
          gap: 10px;
          margin-bottom: 15px;
      }
      
      .instruction-btn {
          background: linear-gradient(45deg, #1E88E5, #1565C0);
          color: white;
          border: none;
          border-radius: 30px;
          padding: 10px 20px;
          font-weight: bold;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 10px;
          transition: all 0.3s ease;
          flex: 1;
      }
      
      .instruction-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(30, 136, 229, 0.3);
      }
      
      .create-btn {
          background: linear-gradient(45deg, #43A047, #2E7D32);
          color: white;
          border: none;
          border-radius: 10px;
          padding: 15px;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          width: 100%;
          margin-top: 20px;
          transition: all 0.3s ease;
      }
      
      .create-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(67, 160, 71, 0.3);
      }

      .create-btn:disabled {
          background: #666;
          cursor: not-allowed;
          transform: none;
      }

      .create-btn.loading {
          position: relative;
          color: transparent;
      }

      .create-btn.loading::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          width: 20px;
          height: 20px;
          margin: -10px 0 0 -10px;
          border: 2px solid transparent;
          border-top-color: white;
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }

      @keyframes spin {
          to { transform: rotate(360deg); }
      }
      
      /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
      .modal {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.9);
          z-index: 1000;
          overflow: auto;
          padding: 20px;
          justify-content: center;
          align-items: center;
      }
      
      .modal-content {
          background-color: #222;
          border-radius: 15px;
          padding: 30px;
          max-width: 480px;
          width: 100%;
          margin: auto;
          position: relative;
      }
      
      .close-btn {
          position: absolute;
          top: 20px;
          right: 20px;
          font-size: 24px;
          color: #888;
          background: none;
          border: none;
          cursor: pointer;
      }
      
      .modal-title {
          font-size: 24px;
          color: #FFD700;
          margin-bottom: 20px;
      }

      .modal-content p {
          margin-bottom: 15px;
          line-height: 1.6;
      }
      
      .modal-content ul {
          margin-left: 20px;
          margin-bottom: 20px;
      }
      
      .modal-content li {
          margin-bottom: 10px;
      }
      
      .preview-container {
          width: 100%;
          height: 600px;
          overflow: hidden;
          background-color: #000;
          border-radius: 10px;
          position: relative;
      }
      
      .share-options {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 15px;
          margin-top: 20px;
      }
      
      .share-option {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 5px;
          padding: 15px 10px;
          border-radius: 10px;
          cursor: pointer;
          transition: all 0.3s ease;
      }
      
      .share-option:hover {
          background-color: rgba(255, 255, 255, 0.05);
          transform: translateY(-2px);
      }
      
      .share-icon {
          font-size: 32px;
      }
      
      .share-name {
          font-size: 14px;
          color: #CCC;
      }
      
      .loader-overlay {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.8);
          z-index: 2000;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          gap: 15px;
      }
      
      .loader {
          border: 5px solid #333;
          border-top: 5px solid #FFD700;
          border-radius: 50%;
          width: 50px;
          height: 50px;
          animation: spin 1s linear infinite;
      }
      
      .template-options {
          display: flex;
          overflow-x: auto;
          gap: 10px;
          margin-bottom: 20px;
          scrollbar-width: none;
          -ms-overflow-style: none;
      }
      
      .template-options::-webkit-scrollbar {
          display: none;
      }
      
      .template-btn {
          background: rgba(255, 255, 255, 0.1);
          border: 1px solid #555;
          color: #CCC;
          padding: 8px 15px;
          border-radius: 20px;
          cursor: pointer;
          transition: all 0.3s ease;
          white-space: nowrap;
          flex-shrink: 0;
      }
      
      .template-btn:hover {
          background: rgba(255, 215, 0, 0.1);
          border-color: #FFD700;
          color: #FFD700;
      }
      
      .archive-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
          gap: 15px;
          margin-top: 20px;
      }
      
      .archive-item {
          border-radius: 10px;
          overflow: hidden;
          cursor: pointer;
          transition: all 0.3s ease;
      }
      
      .archive-item:hover {
          transform: translateY(-5px);
          box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
      }
      
      .archive-item-preview {
          width: 100%;
          aspect-ratio: 1;
          object-fit: cover;
      }
      
      .archive-item-date {
          background-color: rgba(0, 0, 0, 0.7);
          color: #CCC;
          padding: 5px;
          font-size: 12px;
          text-align: center;
      }
      
      .archive-empty {
          grid-column: 1 / -1;
          text-align: center;
          color: #888;
          padding: 20px;
      }
      
      #renderCanvas {
          display: none;
      }
      
      .wallet-buttons {
          display: flex;
          justify-content: center;
          gap: 10px;
          margin-top: 15px;
          flex-wrap: wrap;
      }

      .id-button {
          background: linear-gradient(45deg, #FFD700, #FFA500);
          color: #000;
          border-radius: 30px;
          padding: 8px 15px;
          font-weight: bold;
          cursor: pointer;
          display: flex;
          align-items: center;
          transition: all 0.3s ease;
          border: 2px solid #FFD700;
          flex: 1;
          justify-content: center;
      }

      .id-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
      }

      .id-label {
          margin-right: 5px;
      }

      .copy-icon {
          margin-left: 5px;
          font-size: 0.8em;
      }

      .connect-wallet-btn {
          background: linear-gradient(45deg, #1E88E5, #1565C0);
          color: white;
          border: none;
          border-radius: 30px;
          padding: 10px 20px;
          font-weight: bold;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 5px;
          transition: all 0.3s ease;
          width: 100%;
      }

      .connect-wallet-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(30, 136, 229, 0.3);
      }
      
      .text-editor {
          display: flex;
          flex-direction: column;
          gap: 10px;
      }

      .style-background {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 1;
      }

      .style-classic {
          background: linear-gradient(135deg, #FFD700, #FFA500);
      }

      .style-sunset {
          background: linear-gradient(135deg, #ff6b6b, #ffa726, #ffcc02);
      }

      .style-ocean {
          background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
      }

      .style-space {
          background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      }

      .style-neon {
          background: linear-gradient(135deg, #ff00cc, #333399, #00ffcc);
      }

      .text-controls {
          display: flex;
          flex-wrap: wrap;
          gap: 15px;
          margin-top: 10px;
      }

      .emoji-btn {
          background: linear-gradient(45deg, #FFD700, #FFA500);
          color: #000;
          border: none;
          border-radius: 30px;
          padding: 10px 20px;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
          width: 100%;
      }

      .emoji-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
      }

      .text-position {
          background: rgba(255, 255, 255, 0.05);
          border-radius: 10px;
          padding: 10px;
          width: 100%;
      }

      .position-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 5px;
          margin-top: 8px;
      }

      .position-btn {
          background: rgba(255, 255, 255, 0.1);
          border: 1px solid #FFD700;
          color: #FFD700;
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
          cursor: pointer;
          transition: all 0.2s ease;
      }

      .position-btn:hover {
          background: rgba(255, 215, 0, 0.2);
      }

      .position-btn.active {
          background: rgba(255, 215, 0, 0.4);
          border: 2px solid #FFD700;
          color: #FFF;
      }

      .emoji-picker {
          display: none;
          background: #1a1a1a;
          border: 1px solid #FFD700;
          border-radius: 10px;
          padding: 10px;
          margin-top: 10px;
          max-height: 200px;
      }

      .emoji-categories {
          display: flex;
          gap: 5px;
          margin-bottom: 10px;
          overflow-x: auto;
          padding-bottom: 5px;
          scrollbar-width: none;
          -ms-overflow-style: none;
      }

      .emoji-categories::-webkit-scrollbar {
          display: none;
      }

      .emoji-categories button {
          background: none;
          border: none;
          font-size: 18px;
          cursor: pointer;
          opacity: 0.7;
          transition: all 0.2s ease;
      }

      .emoji-categories button:hover {
          opacity: 1;
          transform: scale(1.2);
      }

      .emoji-categories button.active {
          opacity: 1;
          border-bottom: 2px solid #FFD700;
      }

      .emoji-container {
          display: grid;
          grid-template-columns: repeat(8, 1fr);
          gap: 5px;
          max-height: 150px;
          overflow-y: auto;
          scrollbar-width: none;
          -ms-overflow-style: none;
      }

      .emoji-container::-webkit-scrollbar {
          display: none;
      }

      .emoji-container button {
          background: none;
          border: none;
          font-size: 24px;
          cursor: pointer;
          transition: all 0.2s ease;
      }

      .emoji-container button:hover {
          transform: scale(1.2);
          background: rgba(255, 255, 255, 0.1);
          border-radius: 5px;
      }

      /* –ò–°–ü–†–ê–í–õ–ï–ù –°–¢–ò–õ–¨ –¢–ï–ö–°–¢–ê - –±–µ–ª—ã–π —Ü–≤–µ—Ç —Å —á–µ—Ä–Ω–æ–π –∫–æ–Ω—Ç—É—Ä–Ω–æ–π —Ç–µ–Ω—å—é */
      .card-greeting-new {
          color: #FFFFFF !important;
          text-shadow: 
               -3px -3px 0 #000,
               3px -3px 0 #000,
               -3px 3px 0 #000,
               3px 3px 0 #000,
               -4px 0 0 #000,
               4px 0 0 #000,
               0 -4px 0 #000,
               0 4px 0 #000,
               -2px -2px 4px rgba(0, 0, 0, 0.8),
               2px 2px 4px rgba(0, 0, 0, 0.8),
               0 0 12px rgba(0, 0, 0, 0.6) !important;
          font-weight: bold !important;
          font-size: 18px !important;
          white-space: pre-wrap !important;
          line-height: 1.3 !important;
          word-wrap: break-word !important;
          overflow-wrap: break-word !important;
          z-index: 10 !important;
          position: absolute !important;
          background: none !important;
          border: none !important;
          border-radius: 0 !important;
          padding: 0 !important;
          display: block !important;
          box-sizing: border-box !important;
          max-width: 100% !important;
      }

      .card-text, .card-title, .text-overlay {
          text-shadow: 
              -1px -1px 0 #000,
              1px -1px 0 #000,
              -1px 1px 0 #000,
              1px 1px 0 #000,
              -2px 0 0 #000,
              2px 0 0 #000,
              0 -2px 0 #000,
              0 2px 0 #000;
          color: white !important;
      }
      
      .card-greeting {
          position: absolute;
          color: #FFFFFF !important;
          font-weight: bold;
          font-size: 18px;
          line-height: 1.4;
          text-shadow: 2px 2px 4px #000000;
          z-index: 3;
      }

      /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ë–ï–ì–£–©–ï–ô –°–¢–†–û–ö–ò */
      .marquee-container {
          background: rgba(255, 215, 0, 0.9);
          color: #000;
          position: absolute;
          top: 50%;
          left: 0;
          width: 100%;
          height: 40px;
          display: flex;
          align-items: center;
          z-index: 15;
          overflow: hidden;
          cursor: pointer;
          font-weight: bold;
          font-size: 14px;
      }

      .marquee-text {
          animation: marquee 15s linear infinite;
          white-space: nowrap;
      }

      @keyframes marquee {
          0% { transform: translateX(100%); }
          100% { transform: translateX(-100%); }
      }
      
      /* –ö–Ω–æ–ø–∫–∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
      .preview-edit-buttons {
          display: flex;
          gap: 10px;
          margin-top: 10px;
      }
      
      .preview-edit-btn {
          flex: 1;
          background: linear-gradient(45deg, #1E88E5, #1565C0);
          color: white;
          border: none;
          border-radius: 10px;
          padding: 8px 0;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
      }
      
      .preview-edit-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 8px rgba(30, 136, 229, 0.3);
      }
      
      .preview-edit-btn.edit {
          background: linear-gradient(45deg, #FFD700, #FFA500);
          color: #000;
      }

      /* –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ */
     .welcome-banner {
         background: linear-gradient(45deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
         border: 2px solid #FFD700;
         border-radius: 15px;
         padding: 20px;
         margin-bottom: 25px;
         text-align: center;
         display: none;
     }

     .welcome-banner.show {
         display: block;
         animation: fadeInDown 0.6s ease;
     }

     .welcome-banner h3 {
         color: #FFD700;
         margin-bottom: 10px;
     }

     .welcome-banner p {
         color: #CCC;
         line-height: 1.5;
     }

     @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* ‚úÖ –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ê–†–•–ò–í–ê –ò –£–†–û–í–ù–ï–ô */
    .archive-status-info {
        background: rgba(76, 175, 80, 0.1);
        border: 1px solid #4CAF50;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        display: none;
    }

    .archive-status-info.show {
        display: block;
    }

    .archive-status-info h4 {
        color: #4CAF50;
        margin-bottom: 10px;
        font-size: 16px;
    }

    .archive-usage-bar {
       background: rgba(255, 255, 255, 0.1);
       border-radius: 10px;
       height: 20px;
       overflow: hidden;
       margin-bottom: 10px;
       position: relative;
   }

   .archive-usage-fill {
       background: linear-gradient(45deg, #4CAF50, #2E7D32);
       height: 100%;
       border-radius: 10px;
       transition: width 0.5s ease;
       position: relative;
   }

   .archive-usage-text {
       color: #CCC;
       font-size: 12px;
       text-align: center;
       margin-top: 5px;
   }

   /* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞ */
   .archive-locked {
       background: rgba(255, 68, 68, 0.1);
       border: 2px solid #ff4444;
       border-radius: 10px;
       padding: 15px;
       text-align: center;
       margin-top: 15px;
   }

   .archive-locked h4 {
       color: #ff6666;
       margin-bottom: 10px;
   }

   .archive-locked p {
       color: #CCC;
       margin-bottom: 15px;
       font-size: 14px;
   }

   .activation-btn {
      background: linear-gradient(45deg, #FFD700, #FFA500);
      color: #000;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
  }

  .activation-btn:hover {
     transform: translateY(-1px);
     box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
 }

 /* –ò–ù–°–¢–†–£–ö–¶–ò–ò - —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ —Å—Ç–∏–ª–∏ */
 .instructions-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    overflow-y: auto;
    padding: 20px 0;
}

.instructions-content {
   background: linear-gradient(145deg, #1a1a2e, #16213e);
   margin: 20px auto;
   padding: 30px;
   border-radius: 20px;
   max-width: 600px;
   width: 90%;
   color: #fff;
   border: 2px solid #ffd700;
   box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
   position: relative;
   min-height: fit-content;
}

.instructions-header {
   text-align: center;
   color: #ffd700;
   font-size: 24px;
   margin-bottom: 20px;
   border-bottom: 2px solid #ffd700;
   padding-bottom: 10px;
}

.instructions-section {
   margin-bottom: 25px;
}

.instructions-section h3 {
   color: #ffd700;
   margin-bottom: 15px;
   font-size: 18px;
}

.instructions-section strong {
   color: #ffd700;
   display: block;
   margin-bottom: 8px;
   margin-top: 15px;
}

.instructions-list {
  list-style: none;
  padding-left: 0;
  margin-bottom: 15px;
}

.instructions-list li {
  margin-bottom: 8px;
  padding-left: 20px;
  position: relative;
  line-height: 1.4;
  color: #e0e0e0;
}

.instructions-list li:before {
  content: "‚Ä¢";
  color: #ffd700;
  position: absolute;
  left: 0;
  font-weight: bold;
}

.close-instructions {
  background: #ffd700;
  color: #000;
  border: none;
  padding: 12px 20px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  margin-top: 20px;
  width: 100%;
  font-size: 16px;
  transition: all 0.3s ease;
}

.close-instructions:hover {
 background: #ffed4e;
 transform: translateY(-1px);
}

/* –§–æ–Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ */
.style-background {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 1;
}

.style-background.style-classic {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.style-background.style-sunset {
background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
}

.style-background.style-ocean {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.style-background.style-space {
background: radial-gradient(ellipse at center, #0c0c0c 0%, #000000 70%);
background-image: 
   radial-gradient(2px 2px at 20px 30px, #fff, transparent),
   radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
   radial-gradient(1px 1px at 90px 40px, #fff, transparent),
   radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
   radial-gradient(2px 2px at 160px 30px, #fff, transparent);
}

.style-background.style-neon {
background: linear-gradient(45deg, #FF006E, #8338EC, #3A86FF);
background-size: 400% 400%;
animation: neonGradient 3s ease infinite;
}

@keyframes neonGradient {
0% { background-position: 0% 50%; }
50% { background-position: 100% 50%; }
100% { background-position: 0% 50%; }
}

/* –ë–õ–û–ö–ò–†–û–í–ö–ê –ù–ï–ü–û–î–•–û–î–Ø–©–ï–ì–û –ö–û–ù–¢–ï–ù–¢–ê */
.content-blocked-modal {
 position: fixed;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 background: rgba(0,0,0,0.9);
 display: flex;
 align-items: center;
 justify-content: center;
 z-index: 10000;
}

.content-blocked-content {
 background: #222;
 border: 2px solid #ff4444;
 border-radius: 15px;
 padding: 30px;
 max-width: 400px;
 text-align: center;
 color: white;
}

.content-blocked-icon {
 font-size: 48px;
 margin-bottom: 20px;
}

.content-blocked-title {
 color: #ff6666;
 font-size: 20px;
 margin-bottom: 15px;
}

.content-blocked-message {
 color: #CCC;
 margin-bottom: 20px;
 line-height: 1.4;
}

.content-blocked-button {
 background: linear-gradient(45deg, #FFD700, #FFA500);
 color: #000;
 border: none;
 border-radius: 8px;
 padding: 12px 24px;
 font-weight: bold;
 cursor: pointer;
 transition: all 0.3s ease;
}

/* üé® –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ü–†–ï–í–¨–Æ –ú–û–î–ê–õ–ö–ò */
.share-modal {
 position: fixed;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 background: rgba(0, 0, 0, 0.9);
 z-index: 9999;
 display: flex;
 align-items: center;
 justify-content: center;
 padding: 20px;
}

.share-modal-content {
 background: #222;
 border-radius: 15px;
 padding: 30px;
 max-width: 500px;
 width: 100%;
 max-height: 90vh;
 overflow-y: auto;
 position: relative;
 color: white;
 border: 2px solid #FFD700;
 box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
}

.share-methods {
 display: grid;
 grid-template-columns: 1fr;
 gap: 20px;
 margin-top: 20px;
}

.share-method {
 background: rgba(255, 255, 255, 0.05);
 border: 1px solid #444;
 border-radius: 12px;
 padding: 20px;
 transition: all 0.3s ease;
}

.share-method:hover {
 border-color: #FFD700;
 background: rgba(255, 215, 0, 0.1);
}

.share-method h4 {
 color: #FFD700;
 margin-bottom: 10px;
 font-size: 18px;
}

.share-method p {
 color: #CCC;
 margin-bottom: 15px;
 line-height: 1.4;
}

.share-method-buttons {
 display: flex;
 gap: 10px;
 flex-wrap: wrap;
}

.share-method-btn {
 background: linear-gradient(45deg, #FFD700, #FFA500);
 color: #000;
 border: none;
 border-radius: 8px;
 padding: 10px 20px;
 font-weight: bold;
 cursor: pointer;
 transition: all 0.3s ease;
 flex: 1;
 min-width: 120px;
}

.share-method-btn:hover {
 transform: translateY(-2px);
 box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
}

.share-method-btn.secondary {
 background: linear-gradient(45deg, #1E88E5, #1565C0);
 color: white;
}

.preview-image-container {
 text-align: center;
 margin-bottom: 20px;
}

/* üé® –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –°–û–¶–ò–ê–õ–¨–ù–´–• –ö–ù–û–ü–û–ö */
.social-platforms {
 display: grid;
 grid-template-columns: repeat(4, 1fr);
 gap: 10px;
 margin-top: 15px;
 width: 100%;
}

.social-platform-btn {
  background: #333;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 11px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  min-height: 60px;
  justify-content: center;
}

.social-platform-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.social-platform-btn.whatsapp { background: #25D366; }
.social-platform-btn.telegram { background: #2CA5E0; }
.social-platform-btn.facebook { background: #4267B2; }
.social-platform-btn.instagram { background: #E4405F; }
.social-platform-btn.x { background: #000000; }
.social-platform-btn.viber { background: #665CAC; }
.social-platform-btn.tiktok { background: #FF0050; }
.social-platform-btn.email { background: #34495E; }

/* üé¨ –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –í–ò–î–ï–û */
.video-container {
 position: relative;
 width: 100%;
 height: 100%;
 overflow: hidden;
 border-radius: 10px;
}

.video-iframe {
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 border: none;
 border-radius: 10px;
}

.video-placeholder {
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translate(-50%, -50%);
 background: rgba(0, 0, 0, 0.8);
 color: #FFD700;
 padding: 20px;
 border-radius: 10px;
 text-align: center;
 font-weight: bold;
}

.video-error {
 background: rgba(255, 68, 68, 0.8);
 color: white;
}

.video-loading {
 background: rgba(255, 215, 0, 0.8);
 color: #000;
}

/* ‚úÖ –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –°–ò–°–¢–ï–ú–´ –£–í–ï–î–û–ú–õ–ï–ù–ò–ô */
.notification-container {
   position: fixed;
   bottom: 20px;
   left: 50%;
   transform: translateX(-50%);
   z-index: 10001;
   pointer-events: none;
}

.notification {
   background: rgba(0, 0, 0, 0.95);
   color: white;
   padding: 16px 28px;
   border-radius: 12px;
   margin-bottom: 10px;
   opacity: 0;
   transform: translateY(100%);
   transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
   border: 1px solid #333;
   max-width: 90vw;
   text-align: center;
   font-weight: 500;
   box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
   backdrop-filter: blur(8px);
   pointer-events: auto;
   cursor: pointer;
}

.notification.show {
   opacity: 1;
   transform: translateY(0);
}

.notification.success {
   border-color: #4CAF50;
   background: rgba(76, 175, 80, 0.15);
   color: #4CAF50;
}

.notification.error {
   border-color: #f44336;
   background: rgba(244, 67, 54, 0.15);
   color: #f44336;
}

.notification.warning {
   border-color: #FF9800;
   background: rgba(255, 152, 0, 0.15);
   color: #FF9800;
}

.notification.info {
   border-color: #2196F3;
   background: rgba(33, 150, 243, 0.15);
   color: #2196F3;
}

/* ‚úÖ –°–¢–ò–õ–ò –î–õ–Ø –£–†–û–í–ù–ï–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø */
.user-level-badge {
   display: inline-block;
   padding: 4px 12px;
   border-radius: 12px;
   font-size: 12px;
   font-weight: bold;
   margin-left: 8px;
}

.user-level-0 {
   background: rgba(128, 128, 128, 0.2);
   color: #888;
   border: 1px solid #666;
}

.user-level-1 {
   background: rgba(76, 175, 80, 0.2);
   color: #4CAF50;
   border: 1px solid #4CAF50;
}

.user-level-2 {
   background: rgba(33, 150, 243, 0.2);
   color: #2196F3;
   border: 1px solid #2196F3;
}

.user-level-3 {
   background: rgba(156, 39, 176, 0.2);
   color: #9C27B0;
   border: 1px solid #9C27B0;
}

.user-level-4 {
   background: rgba(255, 152, 0, 0.2);
   color: #FF9800;
   border: 1px solid #FF9800;
}

.user-level-5 {
   background: rgba(244, 67, 54, 0.2);
   color: #f44336;
   border: 1px solid #f44336;
}

.user-level-6 {
   background: linear-gradient(45deg, rgba(255, 215, 0, 0.3), rgba(255, 165, 0, 0.3));
   color: #FFD700;
   border: 1px solid #FFD700;
}

/* ‚úÖ –°–¢–ò–õ–ò –î–õ–Ø –ü–†–û–ì–†–ï–°–° –ë–ê–†–û–í */
.progress-bar {
   background: rgba(255, 255, 255, 0.1);
   border-radius: 10px;
   height: 8px;
   overflow: hidden;
   margin: 8px 0;
}

.progress-fill {
   height: 100%;
   border-radius: 10px;
   transition: width 0.5s ease;
   background: linear-gradient(45deg, #4CAF50, #2E7D32);
}

.progress-fill.warning {
   background: linear-gradient(45deg, #FF9800, #F57C00);
}

.progress-fill.danger {
   background: linear-gradient(45deg, #f44336, #d32f2f);
}

/* ‚úÖ –°–¢–ò–õ–ò –î–õ–Ø –ö–ù–û–ü–û–ö –ê–†–•–ò–í–ê */
.archive-action-buttons {
   display: flex;
   gap: 10px;
   margin-top: 15px;
}

.archive-btn {
   flex: 1;
   background: linear-gradient(45deg, #1E88E5, #1565C0);
   color: white;
   border: none;
   border-radius: 8px;
   padding: 10px 16px;
   font-weight: bold;
   cursor: pointer;
   transition: all 0.3s ease;
   font-size: 14px;
}

.archive-btn:hover {
   transform: translateY(-2px);
   box-shadow: 0 4px 8px rgba(30, 136, 229, 0.3);
}

.archive-btn.save {
   background: linear-gradient(45deg, #4CAF50, #2E7D32);
}

.archive-btn.view {
   background: linear-gradient(45deg, #9C27B0, #7B1FA2);
}

.archive-btn:disabled {
   background: #666;
   cursor: not-allowed;
   transform: none;
   box-shadow: none;
}

/* –ê–¥–∞–ø—Ç–∏–≤ */
@media (max-width: 480px) {
 body {
     padding: 10px;
 }
 
 .logo {
     font-size: 28px;
 }
 
 .preview-container {
     height: 400px;
 }

 .instructions-content {
     margin: 10px auto;
     padding: 20px;
     width: 95%;
 }

 .instructions-header {
     font-size: 20px;
 }

 .share-modal-content {
     padding: 20px;
     margin: 10px;
 }

 .share-methods {
     gap: 15px;
 }

 .social-platforms {
     grid-template-columns: repeat(4, 1fr);
 }

 .notification {
     max-width: 95vw;
     margin: 0 10px;
 }

 .archive-action-buttons {
     flex-direction: column;
 }

 .user-level-badge {
     display: block;
     margin: 5px 0 0 0;
     text-align: center;
 }
}
</style>
</head>
<body>
<!-- –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ -->
<div class="language-switcher">
<button class="lang-btn active" onclick="switchLanguage('en')" id="langEn">EN</button>
<button class="lang-btn" onclick="switchLanguage('ru')" id="langRu">RU</button>
<button class="lang-btn" onclick="switchLanguage('ua')" id="langUa">UA</button>
</div>

<div class="header">
<div class="logo">CardGift</div>
<div class="tagline" id="tagline">Create stunning digital cards in seconds!</div>

<!-- ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –°–ï–ö–¶–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø –° –£–†–û–í–ù–Ø–ú–ò -->
<div class="section">
<div class="section-header">
 <span class="icon">üë§</span> <span id="yourProfile">Your Profile</span>
</div>
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
 <div>
     <div style="color: #FFD700; font-weight: bold;">
         ID: <span id="currentUserId">Connecting...</span>
         <span id="userLevelBadge" class="user-level-badge user-level-0">FREE</span>
     </div>
     <div id="userLevel" style="color: #CCC; font-size: 14px;">Free User</div>
     <div id="userCards" style="color: #888; font-size: 12px;">Cards: 0/5</div>
 </div>
 <div style="display: flex; gap: 8px;">
     <button onclick="showInstructions()" style="background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; border: none; border-radius: 8px; padding: 8px 16px; cursor: pointer; font-weight: 600; box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3); transition: all 0.3s ease;">
         <span id="instructionsBtn">üìã Instructions</span>
     </button>
     <button onclick="goToDashboard()" style="background: linear-gradient(45deg, #1E88E5, #1565C0); color: white; border: none; border-radius: 8px; padding: 8px 16px; cursor: pointer;">
         <span id="dashboardBtn">üìä Dashboard</span>
     </button>
 </div>
</div>
</div>

<!-- ‚úÖ –£–õ–£–ß–®–ï–ù–ù–û–ï WEB3 –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö–û–®–ï–õ–¨–ö–ê -->
<div class="section">
<div class="section-header">
 <span class="icon">üîó</span> <span id="blockchainConnection">Blockchain Connection</span>
</div>
<div id="walletSection">
 <button id="walletConnectBtn" onclick="connectWallet()" class="connect-wallet-btn">
     <span id="connectSafePalWallet">üîó Connect SafePal Wallet</span>
 </button>
 <div id="walletStatus"></div>
 <div id="networkStatus" style="margin-top: 10px; font-size: 12px; text-align: center; color: #888;"></div>
</div>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ò–ù–°–¢–†–£–ö–¶–ò–ô -->
<div id="instructionsModal" class="instructions-modal">
<div class="instructions-content">
 <div class="instructions-header" id="instructionsHeader">üìã CardGift Guide</div>
 
 <div class="instructions-section">
     <h3 id="quickStartTitle">üöÄ Quick Start</h3>
     
     <div style="margin-bottom: 15px;">
         <strong id="addPhotoTitle">1. üì∏ Adding Photo</strong>
         <ul class="instructions-list">
             <li id="instruction1">Click on the 'üì∏ Photo' area</li>
             <li id="instruction2">Select an image from your device</li>
             <li id="instruction3"><em>Important: Use vertical photos for mobile (9:16 ratio)</em></li>
             <li id="instruction4"><em>Avoid: Horizontal photos ‚Äî they look bad on mobile cards</em></li>
         </ul>
     </div>

     <div style="margin-bottom: 15px;">
         <strong id="addTextTitle">2. ‚úçÔ∏è Adding Text</strong>
         <ul class="instructions-list">
             <li id="instruction5">Enter your greeting in the text field</li>
             <li id="instruction6">Add personal message (appears by timer)</li>
             <li id="instruction7">You can use emojis üéâüíïüéÇ</li>
         </ul>
     </div>

     <div style="margin-bottom: 15px;">
         <strong id="timersTitle">3. ‚è±Ô∏è Timer Settings</strong>
         <ul class="instructions-list">
             <li id="instruction8">Personal message timer: When personal text appears (1‚Äì30 sec)</li>
             <li id="instruction9">Button offer timer: When 'Get generator' button shows (1‚Äì60 sec)</li>
             <li id="instruction10">Banner timer: When advertising banner appears (if enabled)</li>
         </ul>
     </div>

     <div style="margin-bottom: 15px;">
         <strong id="buttonPositionTitle">4. üìç Button Positioning</strong>
         <ul class="instructions-list">
             <li id="instruction11">Choose from 9 positions for 'Liked the card?' button</li>
             <li id="instruction12">Avoid positions that cover important content</li>
             <li id="instruction13">Button is 1/3 screen width for neat appearance</li>
         </ul>
     </div>

     <div style="margin-bottom: 15px;">
         <strong id="styleTitle">5. üé® Style Selection</strong>
         <ul class="instructions-list">
             <li id="instruction14">‚ú® Gold (classic)</li>
             <li id="instruction15">üåÖ Sunset (romantic)</li>
             <li id="instruction16">üåä Ocean (fresh)</li>
             <li id="instruction17">üåå Space (modern)</li>
         </ul>
     </div>
 </div>

 <div class="instructions-section">
     <h3 id="additionalFeaturesTitle">üì¢ Additional Features</h3>
     <ul class="instructions-list">
         <li id="instruction18"><strong>üé® Demo Templates:</strong> Ready texts for different occasions. Perfect for inspiration.</li>
         <li id="instruction19"><strong>üì¢ Advertising Banner:</strong> Add HTML code for your banner. Perfect for business or event advertising. Set appearance timer.</li>
         <li id="instruction20"><strong>üîó Referral System:</strong> Your unique 7-digit ID. Share referral link. Track new users (future feature).</li>
     </ul>
 </div>

 <div class="instructions-section">
     <h3 id="mobileOptimizationTitle">üéØ Mobile Optimization Tips</h3>
     <div style="margin-bottom: 10px;">
         <strong id="bestPhotoFormatsTitle">Best Photo Formats:</strong>
         <ul class="instructions-list">
             <li id="instruction21">Vertical photos ‚Üí perfect for mobile cards</li>
             <li id="instruction22">Square photos ‚Üí will show with background</li>
             <li id="instruction23">Avoid horizontal ‚Üí work poorly on mobile</li>
         </ul>
     </div>
     <div style="text-align: center; background: rgba(255, 215, 0, 0.1); padding: 15px; border-radius: 10px; border: 1px solid #ffd700;">
         <strong id="mainRule">üì± Main Rule: Always think mobile! Your cards will be viewed on phones. ‚ú®</strong>
     </div>
 </div>

 <button class="close-instructions" onclick="hideInstructions()" id="closeInstructionsBtn">Close</button>
</div>
</div>

<!-- üé¨ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –ú–ï–î–ò–ê –° –ü–û–î–î–ï–†–ñ–ö–û–ô –í–°–ï–• –í–ò–î–ï–û -->
<div class="section">
<div class="section-header">
 <span class="icon">üì∑</span> <span id="media">Photo/Video</span>
</div>

<label for="mediaUpload" class="media-upload">
 <div class="media-upload-icon">üì∑</div>
 <div class="media-upload-text" id="uploadMedia">Click to upload photo or video</div>
 <div class="media-upload-subtext" id="uploadRecommendation">Recommended: vertical format (9:16)</div>
 <input type="file" id="mediaUpload" style="display: none;" accept="image/*,video/*" onchange="handleMediaUpload(event)">
</label>

<div id="mediaPreview"></div>

<div id="orInsertVideo" style="margin-top: 15px; color: #CCC; font-weight: bold;">Or insert video URL:</div>
<input type="text" id="videoUrl" class="input-field" placeholder="YouTube, TikTok, Instagram Reels URL...">

<!-- üé¨ –ò–ù–î–ò–ö–ê–¢–û–† –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–ú–´–• –ü–õ–ê–¢–§–û–†–ú -->
<div style="display: flex; gap: 10px; margin-top: 10px; justify-content: center; flex-wrap: wrap;">
 <span style="background: #FF0000; color: white; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: bold;">üì∫ YouTube</span>
 <span style="background: #FF0050; color: white; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: bold;">üéµ TikTok</span>
 <span style="background: #E4405F; color: white; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: bold;">üì∑ Instagram</span>
</div>
</div>

<!-- ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–ï–ö–¶–ò–Ø –¢–ï–ö–°–¢–ê -->
<div class="section">
<div class="section-header">
 <span class="icon">‚úèÔ∏è</span> <span id="text">Text</span>
</div>

<div class="text-editor">
 <textarea id="greetingText" placeholder="Enter your greeting here..." class="input-field"></textarea>
 
 <div class="text-controls">
     <button class="emoji-btn" onclick="toggleEmojiPicker()">
         üòä <span id="addEmoji">Add Emoji</span>
     </button>
     
     <div class="text-position">
         <span>üìç <span id="textPosition">Text Position</span></span>
         <div class="position-grid">
             <button class="position-btn" data-position="topLeft" onclick="setTextPosition('topLeft')">‚Üñ</button>
             <button class="position-btn" data-position="top" onclick="setTextPosition('top')">‚Üë</button>
             <button class="position-btn" data-position="topRight" onclick="setTextPosition('topRight')">‚Üó</button>
             <button class="position-btn" data-position="left" onclick="setTextPosition('left')">‚Üê</button>
             <button class="position-btn" data-position="center" onclick="setTextPosition('center')">‚Ä¢</button>
             <button class="position-btn" data-position="right" onclick="setTextPosition('right')">‚Üí</button>
             <button class="position-btn" data-position="bottomLeft" onclick="setTextPosition('bottomLeft')">‚Üô</button>
             <button class="position-btn" data-position="bottom" onclick="setTextPosition('bottom')" class="active">‚Üì</button>
             <button class="position-btn" data-position="bottomRight" onclick="setTextPosition('bottomRight')">‚Üò</button>
         </div>
     </div>
 </div>
 
 <div id="emojiPicker" class="emoji-picker">
     <div class="emoji-categories">
         <button data-category="smileys" class="active" onclick="loadEmojis('smileys')">üòä</button>
         <button data-category="animals" onclick="loadEmojis('animals')">üê∂</button>
         <button data-category="food" onclick="loadEmojis('food')">üçî</button>
         <button data-category="travel" onclick="loadEmojis('travel')">‚úàÔ∏è</button>
         <button data-category="activities" onclick="loadEmojis('activities')">‚öΩ</button>
         <button data-category="objects" onclick="loadEmojis('objects')">üí°</button>
         <button data-category="symbols" onclick="loadEmojis('symbols')">‚ù§Ô∏è</button>
         <button data-category="flags" onclick="loadEmojis('flags')">üèÅ</button>
     </div>
     <div class="emoji-container">
         <!-- –≠–º–æ–¥–∑–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
     </div>
 </div>
</div>

<div class="template-options">
 <div id="useTemplate">Use template:</div>
 <button class="template-btn" onclick="useTemplate('birthday')">üéÇ <span id="birthday">Birthday</span></button>
 <button class="template-btn" onclick="useTemplate('newyear')">üéÑ <span id="newyear">New Year</span></button>
 <button class="template-btn" onclick="useTemplate('love')">üíï <span id="love">Love</span></button>
 <button class="template-btn" onclick="useTemplate('thanks')">üôè <span id="thanks">Thanks</span></button>
 <button class="template-btn" onclick="useTemplate('congrats')">üéâ <span id="congrats">Congrats</span></button>
</div>

<div style="margin-top: 15px;">
 <button onclick="showInstructions()" style="background: linear-gradient(45deg, #1E88E5, #1565C0); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; margin-right: 10px;">
     üìã <span id="instructions">Instructions</span>
 </button>
 <button onclick="showPreview()" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer;">
     üëÅÔ∏è <span id="preview">Preview</span>
 </button>
</div>
</div>

<!-- ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–ï–ö–¶–ò–Ø –°–¢–ò–õ–ï–ô -->
<div class="section">
<div class="section-header">
 <span class="icon">üé®</span> <span id="style">Style</span>
</div>

<div class="style-options">
 <div class="style-option active" data-style="classic" onclick="selectStyle('classic')">
     <div class="style-icon">‚ú®</div>
     <div class="style-name" id="classic">Classic</div>
 </div>
 <div class="style-option" data-style="sunset" onclick="selectStyle('sunset')">
     <div class="style-icon">üåÖ</div>
     <div class="style-name" id="sunset">Sunset</div>
 </div>
 <div class="style-option" data-style="ocean" onclick="selectStyle('ocean')">
     <div class="style-icon">üåä</div>
     <div class="style-name" id="ocean">Ocean</div>
 </div>
 <div class="style-option" data-style="space" onclick="selectStyle('space')">
     <div class="style-icon">üåå</div>
     <div class="style-name" id="space">Space</div>
 </div>
 <div class="style-option" data-style="neon" onclick="selectStyle('neon')">
     <div class="style-icon">üí´</div>
     <div class="style-name" id="neon">Neon</div>
 </div>
</div>
</div>

<!-- ‚úÖ –†–ê–°–®–ò–†–ï–ù–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò -->
<div class="section">
<div class="section-header">
 <span class="icon">‚öôÔ∏è</span> <span id="advancedSettings">Advanced Settings</span>
</div>

<!-- CTA —Å —á–µ–∫–±–æ–∫—Å–æ–º –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
<div class="toggle-row">
 <div class="toggle-label" id="callToAction">Call to Action</div>
 <input type="checkbox" id="ctaToggle" checked onchange="toggleCTA()">
</div>

<div id="ctaSettings">
 <input type="text" id="ctaTitle" class="input-field" placeholder="Like this card?">
 <input type="text" id="ctaButton" class="input-field" placeholder="Get Card Generator">
 <input type="text" id="ctaUrl" class="input-field" placeholder="https://example.com">
 
 <div class="text-position">
         <span id="buttonPosition">Button Position:</span>
         <div class="position-grid">
             <button class="position-btn" data-position="topLeft" onclick="setCTAPosition('topLeft')">‚Üñ</button>
             <button class="position-btn" data-position="top" onclick="setCTAPosition('top')">‚Üë</button>
             <button class="position-btn" data-position="topRight" onclick="setCTAPosition('topRight')">‚Üó</button>
             <button class="position-btn" data-position="left" onclick="setCTAPosition('left')">‚Üê</button>
             <button class="position-btn" data-position="center" onclick="setCTAPosition('center')">‚Ä¢</button>
             <button class="position-btn" data-position="right" onclick="setCTAPosition('right')">‚Üí</button>
             <button class="position-btn" data-position="bottomLeft" onclick="setCTAPosition('bottomLeft')">‚Üô</button>
             <button class="position-btn" data-position="bottom" onclick="setCTAPosition('bottom')" class="active">‚Üì</button>
             <button class="position-btn" data-position="bottomRight" onclick="setCTAPosition('bottomRight')">‚Üò</button>
         </div>
     </div>
     
     <div class="timer-input">
         <div class="timer-label" id="messageTimer">Message show delay:</div>
         <input type="number" id="messageTimerInput" class="timer-field" value="0" min="0" max="10">
         <div class="timer-suffix" id="seconds">seconds</div>
     </div>
     
     <div class="timer-input">
         <div class="timer-label" id="buttonTimer">Button show delay:</div>
         <input type="number" id="buttonTimerInput" class="timer-field" value="3" min="0" max="10">
         <div class="timer-suffix" id="seconds2">seconds</div>
     </div>
 </div>

 <!-- –û—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è –¥–ª—è –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ -->
 <div class="toggle-row">
     <div class="toggle-label" id="marqueeText">Running Text</div>
     <input type="checkbox" id="marqueeToggle" onchange="toggleMarquee()">
 </div>

 <div id="marqueeSettings" style="display: none;">
     <input type="text" id="marqueeTextInput" class="input-field" placeholder="Your running text...">
     <input type="text" id="marqueeUrl" class="input-field" placeholder="https://your-link.com">
     
     <div class="timer-input">
         <div class="timer-label" id="marqueeTimer">Show running text after:</div>
         <input type="number" id="marqueeTimerInput" class="timer-field" value="7" min="0" max="15">
         <div class="timer-suffix" id="seconds3">seconds</div>
     </div>
 </div>

 <div class="toggle-row">
     <div class="toggle-label" id="banner">Banner</div>
     <input type="checkbox" id="bannerToggle" onchange="toggleBanner()">
 </div>

 <div id="bannerSettings" style="display: none;">
     <textarea id="bannerHtml" class="input-field" placeholder="<div>Your HTML Banner Code</div>"></textarea>
     <input type="text" id="bannerUrl" class="input-field" placeholder="https://your-redirect-url.com">
     
     <div class="timer-input">
         <div class="timer-label" id="bannerTimer">Show the banner after:</div>
         <input type="number" id="bannerTimerInput" class="timer-field" value="5" min="0" max="10">
         <div class="timer-suffix" id="seconds4">seconds</div>
     </div>
 </div>
</div>

<!-- ‚úÖ –ù–û–í–ê–Ø WEB3 –ê–†–•–ò–í–ù–ê–Ø –°–ò–°–¢–ï–ú–ê -->
<div class="section">
<div class="section-header">
 <span class="icon">üìã</span> <span id="archive">Archive</span>
</div>

<!-- ‚úÖ –°–¢–ê–¢–£–° –ê–†–•–ò–í–ê –ü–û –£–†–û–í–ù–Ø–ú -->
<div id="archiveStatusInfo" class="archive-status-info">
 <h4 id="archiveAccessTitle">Archive Access</h4>
 <div id="archiveUsageInfo">
   <div class="archive-usage-bar">
     <div id="archiveUsageFill" class="archive-usage-fill" style="width: 0%;"></div>
   </div>
   <div class="archive-usage-text">
     <span id="archiveUsageText">Cards used: 0/5</span>
   </div>
 </div>
 <div style="font-size: 12px; color: #CCC; margin-top: 8px;">
   <span id="archiveFeatures">‚úÖ Save cards ‚úÖ Share links ‚úÖ View history</span>
 </div>
</div>

<div id="archiveSection">
 <p style="color: #CCC; margin-bottom: 15px;" id="archiveDescription">Save your best cards to archive</p>
 
 <div class="archive-action-buttons">
   <button id="saveToArchiveBtn" onclick="saveCurrentToArchive()" disabled class="archive-btn save">
       üíæ <span id="saveToArchive">Save to Archive</span>
   </button>
   <button id="viewArchiveBtn" onclick="goToArchive()" class="archive-btn view">
       üìÇ <span id="viewArchive">View Archive</span>
   </button>
 </div>
</div>

<!-- ‚úÖ –°–ò–°–¢–ï–ú–ê –ë–õ–û–ö–ò–†–û–í–ö–ò –î–õ–Ø –ù–ï–ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ù–´–• -->
<div id="archiveLocked" class="archive-locked" style="display: none;">
 <h4>üîí <span id="archiveLockedTitle">Archive Locked</span></h4>
 <p id="archiveLockedText">Activate your account on opBNB network to access archive and advanced features</p>
 <button class="activation-btn" onclick="goToActivation()">
     <span id="activateAccount">Activate (0.01 BNB)</span>
 </button>
</div>

<div id="archiveGrid" class="archive-grid">
 <!-- WEB3 –∞—Ä—Ö–∏–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω -->
</div>
</div>

<!-- ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ö–ù–û–ü–ö–ê –°–û–ó–î–ê–ù–ò–Ø –° –ò–ù–î–ò–ö–ê–¢–û–†–ê–ú–ò -->
<button class="create-btn" id="createCardBtn" onclick="createCard()">
<span id="createCard">Create Card</span>
</button>

<!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
<!-- ‚úÖ –£–õ–£–ß–®–ï–ù–ù–´–ô –ü–†–ï–î–ü–†–û–°–ú–û–¢–† -->
<div id="previewModal" class="modal">
<div class="modal-content">
 <button class="close-btn" onclick="closePreview()">√ó</button>
 <h2 class="modal-title">Card Preview</h2>
 <div id="previewContainer" style="background: #000; border-radius: 10px; overflow: hidden; height: 400px; display: flex; align-items: center; justify-content: center;">
     <span style="color: #666;" id="previewHere">Preview will be here</span>
 </div>
 <div style="margin-top: 20px; display: flex; gap: 10px;">
     <button onclick="closePreview()" style="flex: 1; background: #666; color: white; border: none; border-radius: 8px; padding: 10px;">‚úèÔ∏è <span id="edit">Edit</span></button>
     <button onclick="createCard(); closePreview();" style="flex: 1; background: linear-gradient(45deg, #43A047, #2E7D32); color: white; border: none; border-radius: 8px; padding: 10px;">‚úÖ <span id="create">Create</span></button>
 </div>
</div>
</div>

<!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
<div id="loaderOverlay" class="loader-overlay">
<div class="loader"></div>
<div id="creating">Creating your card...</div>
</div>

<!-- Canvas –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ -->
<canvas id="renderCanvas"></canvas>

<!-- ‚úÖ –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô -->
<div id="notificationContainer" class="notification-container"></div>

<!-- WEB3 SCRIPTS -->
<script src="/js/wallet.js"></script>
<script src="/js/api.js"></script>

<script>
// üõ°Ô∏è –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –§–ò–õ–¨–¢–†–ê–¶–ò–ò –ö–û–ù–¢–ï–ù–¢–ê
const forbiddenWords = [
'–±–ª—è–¥—å', '—Å—É–∫–∞', '—Ö—É–π', '–ø–∏–∑–¥–∞', '–µ–±–∞—Ç—å', '—É–±–ª—é–¥–æ–∫', '–º—É–¥–∞–∫', '–≥–∞–≤–Ω–æ',
'–≥–æ–≤–Ω–æ', '–¥–µ—Ä—å–º–æ', '—Å—Ä–∞—Ç—å', '—Å—Ä–∞–∫–∞', '–∂–æ–ø–∞', '–ø–∏–¥–æ—Ä', '–ø–µ–¥–∏–∫',
'–ø–æ—Ä–Ω–æ', '—Å–µ–∫—Å', '—Ç—Ä–∞—Ö', '–µ–±–ª—è', '–º–∏–Ω–µ—Ç', '–æ—Ä–≥–∏—è', '–º–∞—Å—Ç—É—Ä–±–∞—Ü–∏—è',
'porn', 'sex', 'fuck', 'pussy', 'dick', 'cock', 'bitch', 'whore',
'—É–±–∏—Ç—å', '—É–±–∏–π—Å—Ç–≤–æ', '—Å–º–µ—Ä—Ç—å', '–∫—Ä–æ–≤—å', '—Ä–∞—Å—Å—Ç—Ä–µ–ª', '–ø–æ–≤–µ—Å–∏—Ç—å',
'–∑–∞—Ä–µ–∑–∞—Ç—å', 'kill', 'murder', 'death', 'blood', 'violence',
'–≥–µ—Ä–æ–∏–Ω', '–∫–æ–∫–∞–∏–Ω', '–º–∞—Ä–∏—Ö—É–∞–Ω–∞', '–Ω–∞—Ä–∫–æ—Ç–∏–∫', '–Ω–∞—Ä–∫–æ—Ç–∞', '—Ç—Ä–∞–≤–∞',
'drugs', 'cocaine', 'heroin', 'marijuana', 'weed',
'–≥–µ–π', '–ª–µ—Å–±–∏—è–Ω–∫–∞', '—Ç—Ä–∞–Ω—Å–≥–µ–Ω–¥–µ—Ä', '–≥–æ–º–æ—Å–µ–∫—Å—É–∞–ª', '–ª–≥–±—Ç', '–∫–≤–∏—Ä',
'gay', 'lesbian', 'transgender', 'homosexual', 'lgbt', 'queer',
'—Ñ–∞—à–∏—Å—Ç', '–Ω–∞—Ü–∏—Å—Ç', '—Ä–∞—Å–∏–∑–º', '—ç–∫—Å—Ç—Ä–µ–º–∏–∑–º', '—Ç–µ—Ä—Ä–æ—Ä–∏–∑–º',
'fascist', 'nazi', 'racism', 'extremism', 'terrorism'
];

function checkContent(text) {
if (!text || typeof text !== 'string') return { isClean: true, text: text };

const lowerText = text.toLowerCase();
let foundBadWords = [];

forbiddenWords.forEach(word => {
  if (lowerText.includes(word.toLowerCase())) {
      foundBadWords.push(word);
  }
});

if (foundBadWords.length > 0) {
  console.warn('üö´ –û–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç:', foundBadWords);
  return {
      isClean: false,
      text: text,
      badWords: foundBadWords,
      message: '–¢–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç'
  };
}

return { isClean: true, text: text };
}

// üõ°Ô∏è –§–£–ù–ö–¶–ò–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò - –û–ß–ò–°–¢–ö–ê –î–ê–ù–ù–´–•
function sanitizeInput(input) {
if (!input || typeof input !== 'string') return '';

return input
  .replace(/</g, '&lt;')
  .replace(/>/g, '&gt;')
  .replace(/"/g, '&quot;')
  .replace(/'/g, '&#x27;')
  .replace(/\//g, '&#x2F;')
  .replace(/javascript:/gi, '')
  .replace(/on\w+=/gi, '')
  .replace(/<script/gi, '')
  .replace(/<\/script>/gi, '')
  .replace(/<iframe/gi, '')
  .replace(/<object/gi, '')
  .replace(/<embed/gi, '');
}

// üé¨ –£–õ–£–ß–®–ï–ù–ù–´–ô –ö–õ–ê–°–° –î–õ–Ø –í–ò–î–ï–û –ü–†–û–¶–ï–°–°–û–†–ê –° –ü–†–ê–í–ò–õ–¨–ù–´–ú CORS
class VideoProcessor {
constructor() {
    this.supportedPlatforms = {
        youtube: {
            patterns: [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/,
                /youtube\.com\/embed\/([a-zA-Z0-9_-]{11})/,
                /youtube\.com\/v\/([a-zA-Z0-9_-]{11})/,
                /youtube\.com\/shorts\/([a-zA-Z0-9_-]{11})/
            ],
            embed: (id) => `https://www.youtube-nocookie.com/embed/${id}?enablejsapi=1&controls=1&rel=0&modestbranding=1&playsinline=1&origin=${encodeURIComponent(window.location.origin)}`
        },
        tiktok: {
            patterns: [
                /tiktok\.com\/@[\w.-]+\/video\/(\d+)/,
                /vm\.tiktok\.com\/([a-zA-Z0-9]+)/
            ],
            embed: (id) => `https://www.tiktok.com/embed/v2/${id}`
        },
        instagram: {
            patterns: [
                /instagram\.com\/p\/([a-zA-Z0-9_-]+)/,
                /instagram\.com\/reel\/([a-zA-Z0-9_-]+)/
            ],
            embed: (id) => `https://www.instagram.com/p/${id}/embed/`
        }
    };
}

parseVideoUrl(url) {
    if (!url || typeof url !== 'string') {
        return { isValid: false, error: 'Invalid URL' };
    }

    url = url.trim();
    
    if (!this.isUrlSafe(url)) {
        return { isValid: false, error: 'Unsafe URL detected' };
    }

    for (const [platform, config] of Object.entries(this.supportedPlatforms)) {
        for (const pattern of config.patterns) {
            const match = url.match(pattern);
            if (match) {
                const videoId = match[1];
                return {
                    isValid: true,
                    platform: platform,
                    videoId: videoId,
                    originalUrl: url,
                    embedUrl: config.embed(videoId)
                };
            }
        }
    }

    return { isValid: false, error: 'Unsupported video platform' };
}

isUrlSafe(url) {
    const lowerUrl = url.toLowerCase();
    
    const blockedDomains = [
        'malware', 'virus', 'phishing', 'spam', 'adult', 'xxx', 'porn'
    ];
    
    for (const blocked of blockedDomains) {
        if (lowerUrl.includes(blocked)) {
            return false;
        }
    }

    if (!lowerUrl.startsWith('http://') && !lowerUrl.startsWith('https://')) {
        return false;
    }

    return true;
}

createVideoElement(videoData, container) {
    container.innerHTML = '';
    
    if (!videoData.isValid) {
        this.showVideoError(container, videoData.error);
        return;
    }

    const videoContainer = document.createElement('div');
    videoContainer.className = 'video-container';
    
    this.showVideoLoading(videoContainer);
    
    const iframe = document.createElement('iframe');
    iframe.className = 'video-iframe';
    iframe.src = videoData.embedUrl;
    iframe.frameBorder = '0';
    iframe.allowFullscreen = true;
    iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen';
    iframe.sandbox = 'allow-scripts allow-same-origin allow-presentation';
    
    iframe.onload = () => {
        this.hideVideoLoading(videoContainer);
    };
    
    iframe.onerror = () => {
        iframe.style.display = 'none';
        const fallback = document.createElement('div');
        fallback.innerHTML = `<a href="${videoData.originalUrl}" target="_blank" style="color: #FFD700;">‚ñ∂Ô∏è Open on ${videoData.platform}</a>`;
        iframe.parentNode.appendChild(fallback);
    };
    
    videoContainer.appendChild(iframe);
    container.appendChild(videoContainer);
    
    return iframe;
}

showVideoLoading(container) {
    const loading = document.createElement('div');
    loading.className = 'video-placeholder video-loading';
    loading.innerHTML = 'üîÑ Loading video...';
    container.appendChild(loading);
}

showVideoError(container, message) {
    container.innerHTML = '';
    const error = document.createElement('div');
    error.className = 'video-placeholder video-error';
    error.innerHTML = `‚ùå ${message}`;
    container.appendChild(error);
}

hideVideoLoading(container) {
    const loading = container.querySelector('.video-loading');
    if (loading) {
        loading.remove();
    }
}

async checkVideoContent(videoData) {
    const contentChecks = {
        isAppropriate: true,
        warnings: [],
        blocked: false
    };

    const lowerUrl = videoData.originalUrl.toLowerCase();
    const forbiddenKeywords = ['adult', 'nsfw', 'xxx', 'porn', 'sex', 'violence', 'gore', 'death'];
    
    for (const keyword of forbiddenKeywords) {
        if (lowerUrl.includes(keyword)) {
            contentChecks.isAppropriate = false;
            contentChecks.blocked = true;
            contentChecks.warnings.push(`Inappropriate content detected: ${keyword}`);
        }
    }

    return contentChecks;
}
}

// –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –≤–∏–¥–µ–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
const videoProcessor = new VideoProcessor();

// üé® –£–õ–£–ß–®–ï–ù–ù–´–ô –ö–õ–ê–°–° –î–õ–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò –ü–†–ï–í–¨–Æ –° –ü–†–ê–í–ò–õ–¨–ù–´–ú CORS
class SocialPreviewGenerator {
constructor() {
   this.canvasWidth = 1200;
   this.canvasHeight = 630;
}

async generatePreviewImage(cardData) {
   try {
       console.log('üé® –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–≤—å—é –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π...');
       
       const canvas = document.createElement('canvas');
       canvas.width = this.canvasWidth;
       canvas.height = this.canvasHeight;
       const ctx = canvas.getContext('2d');

       // –†–∏—Å—É–µ–º —Ñ–æ–Ω
       this.drawBackground(ctx, cardData.style);
       
       // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
       if (cardData.mediaUrl && cardData.mediaType === 'image') {
           await this.drawMainImage(ctx, cardData.mediaUrl);
       }
       
       // –î–æ–±–∞–≤–ª—è–µ–º –æ–≤–µ—Ä–ª–µ–π
       this.drawTextOverlay(ctx);
       
       // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è
       this.drawGreetingText(ctx, cardData.greeting);
       
       // –î–æ–±–∞–≤–ª—è–µ–º –±—Ä–µ–Ω–¥–∏–Ω–≥
       this.drawBranding(ctx);
       
       const imageData = canvas.toDataURL('image/jpeg', 0.5);
       console.log('‚úÖ –ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ');
       
       return imageData;
       
   } catch (error) {
       console.error('‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–≤—å—é:', error);
       return this.generateFallbackPreview(cardData);
   }
}

drawBackground(ctx, style) {
   const gradients = {
       classic: ['#667eea', '#764ba2'],
       sunset: ['#ff9a9e', '#fecfef', '#ffd89b'],
       ocean: ['#667eea', '#764ba2'],
       space: ['#0c0c0c', '#434343'],
       neon: ['#FF006E', '#8338EC', '#3A86FF']
   };
   
   const colors = gradients[style] || gradients.classic;
   const gradient = ctx.createLinearGradient(0, 0, this.canvasWidth, this.canvasHeight);
   
   gradient.addColorStop(0, colors[0]);
   gradient.addColorStop(1, colors[1]);
   
   if (colors[2]) {
       gradient.addColorStop(0.5, colors[2]);
   }
   
   ctx.fillStyle = gradient;
   ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);
}

async drawMainImage(ctx, imageData) {
   return new Promise((resolve) => {
       const img = new Image();
       img.crossOrigin = "anonymous";
       
       img.onload = () => {
           try {
               const scale = Math.max(
                   this.canvasWidth / img.width,
                   this.canvasHeight / img.height
               );
               
               const newWidth = img.width * scale;
               const newHeight = img.height * scale;
               const x = (this.canvasWidth - newWidth) / 2;
               const y = (this.canvasHeight - newHeight) / 2;
               
               ctx.globalAlpha = 0.7;
               ctx.drawImage(img, x, y, newWidth, newHeight);
               ctx.globalAlpha = 1.0;
               
               resolve();
           } catch (error) {
               console.warn('CORS error drawing image:', error);
               // –†–∏—Å—É–µ–º —Ü–≤–µ—Ç–Ω–æ–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –∫–∞–∫ fallback
               ctx.fillStyle = 'rgba(255, 215, 0, 0.3)';
               ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);
               resolve();
           }
       };
       
       img.onerror = () => {
           console.warn('Image load error, using fallback');
           ctx.fillStyle = 'rgba(255, 215, 0, 0.3)';
           ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);
           resolve();
       };
       
       img.src = imageData;
   });
}

drawTextOverlay(ctx) {
   const gradient = ctx.createLinearGradient(0, 0, 0, this.canvasHeight);
   gradient.addColorStop(0, 'rgba(0, 0, 0, 0.3)');
   gradient.addColorStop(0.5, 'rgba(0, 0, 0, 0.5)');
   gradient.addColorStop(1, 'rgba(0, 0, 0, 0.7)');
   
   ctx.fillStyle = gradient;
   ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);
}

drawGreetingText(ctx, greeting) {
   if (!greeting) return;

   ctx.textAlign = 'center';
   ctx.fillStyle = '#FFFFFF';
   
   const lines = greeting.split('\n').filter(line => line.trim());
   
   if (lines[0]) {
       ctx.font = 'bold 64px Arial, sans-serif';
       this.drawTextWithStroke(ctx, lines[0], this.canvasWidth / 2, 200, '#000000', 4);
   }
   
   if (lines[1]) {
       ctx.font = '48px Arial, sans-serif';
       ctx.fillStyle = '#FFD700';
       this.drawTextWithStroke(ctx, lines[1], this.canvasWidth / 2, 280, '#000000', 3);
   }
   
   if (lines.length > 2) {
       ctx.font = '36px Arial, sans-serif';
       ctx.fillStyle = '#FFFFFF';
       let y = 350;
       
       for (let i = 2; i < Math.min(lines.length, 5); i++) {
           this.drawTextWithStroke(ctx, lines[i], this.canvasWidth / 2, y, '#000000', 2);
           y += 50;
       }
   }
}

drawBranding(ctx) {
   const buttonY = this.canvasHeight - 120;
   const buttonWidth = 500;
   const buttonHeight = 70;
   const buttonX = (this.canvasWidth - buttonWidth) / 2;
   
   const buttonGradient = ctx.createLinearGradient(buttonX, buttonY, buttonX + buttonWidth, buttonY);
   buttonGradient.addColorStop(0, '#FFD700');
   buttonGradient.addColorStop(1, '#FFA500');
   
   ctx.fillStyle = buttonGradient;
   this.roundedRect(ctx, buttonX, buttonY, buttonWidth, buttonHeight, 35);
   ctx.fill();
   
   ctx.font = 'bold 32px Arial, sans-serif';
   ctx.fillStyle = '#000000';
   ctx.textAlign = 'center';
   ctx.fillText('üéÅ VIEW GREETING CARD', this.canvasWidth / 2, buttonY + 45);
   
   const logoX = this.canvasWidth - 150;
   const logoY = 30;
   
   ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
   this.roundedRect(ctx, logoX - 10, logoY - 10, 140, 80, 15);
   ctx.fill();
   
   ctx.font = 'bold 28px Arial, sans-serif';
   ctx.fillStyle = '#FFD700';
   ctx.textAlign = 'center';
   ctx.fillText('CardGift', logoX + 60, logoY + 30);
   ctx.font = '16px Arial, sans-serif';
   ctx.fillStyle = '#FFFFFF';
   ctx.fillText('Generator', logoX + 60, logoY + 55);
}

drawTextWithStroke(ctx, text, x, y, strokeColor, strokeWidth) {
   ctx.strokeStyle = strokeColor;
   ctx.lineWidth = strokeWidth;
   ctx.strokeText(text, x, y);
   ctx.fillText(text, x, y);
}

roundedRect(ctx, x, y, width, height, radius) {
   ctx.beginPath();
   ctx.moveTo(x + radius, y);
   ctx.lineTo(x + width - radius, y);
   ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
   ctx.lineTo(x + width, y + height - radius);
   ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
   ctx.lineTo(x + radius, y + height);
   ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
   ctx.lineTo(x, y + radius);
   ctx.quadraticCurveTo(x, y, x + radius, y);
   ctx.closePath();
}

generateFallbackPreview(cardData) {
   const canvas = document.createElement('canvas');
   canvas.width = this.canvasWidth;
   canvas.height = this.canvasHeight;
   const ctx = canvas.getContext('2d');
   
   const gradient = ctx.createLinearGradient(0, 0, this.canvasWidth, this.canvasHeight);
   gradient.addColorStop(0, '#667eea');
   gradient.addColorStop(1, '#764ba2');
   ctx.fillStyle = gradient;
   ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);
   
   ctx.font = 'bold 48px Arial, sans-serif';
   ctx.fillStyle = '#FFFFFF';
   ctx.textAlign = 'center';
   ctx.fillText('üéâ Greeting Card', this.canvasWidth / 2, this.canvasHeight / 2);
   
   ctx.font = '32px Arial, sans-serif';
   ctx.fillStyle = '#FFD700';
   ctx.fillText('CardGift - Card Generator', this.canvasWidth / 2, this.canvasHeight / 2 + 60);
   
   return canvas.toDataURL('image/jpeg', 0.5);
}

async saveCardWithPreview(cardData) {
   try {
       console.log('üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞—Ä—Ç—É —Å –ø—Ä–µ–≤—å—é...');
       
       const previewImage = await this.generatePreviewImage(cardData);
       const cardUrl = `${window.location.origin}/cards/${cardData.cardId}.html`;
       
       await saveCard(cardData);
       
       return {
           success: true,
           previewImageUrl: previewImage,
           cardViewUrl: cardUrl,
           shareUrl: cardUrl,
           fallback: false
       };
       
   } catch (error) {
       console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
       throw error;
   }
}

generateMetaTags(cardData, previewImageUrl) {
   const title = this.extractTitle(cardData.greeting) || 'Greeting Card - CardGift';
   const description = this.extractDescription(cardData.greeting) || 'Beautiful personal card created with CardGift';
   const url = `${window.location.origin}/card-viewer.html?id=${cardData.cardId}`;
   
   return {
       'og:title': this.escapeHTML(title),
       'og:description': this.escapeHTML(description),
       'og:image': previewImageUrl,
       'og:image:width': '1200',
       'og:image:height': '630',
       'og:image:alt': this.escapeHTML(`Preview: ${title}`),
       'og:type': 'website',
       'og:url': url,
       'og:site_name': 'CardGift',
       'twitter:card': 'summary_large_image',
       'twitter:title': this.escapeHTML(title),
       'twitter:description': this.escapeHTML(description),
       'twitter:image': previewImageUrl
   };
}

extractTitle(greeting) {
   if (!greeting) return null;
   const lines = greeting.split('\n').filter(line => line.trim());
   return lines[0] ? this.truncateText(lines[0], 60) : null;
}

extractDescription(greeting) {
   if (!greeting) return null;
   const lines = greeting.split('\n').filter(line => line.trim());
   return lines[1] ? this.truncateText(lines[1], 120) : null;
}

truncateText(text, maxLength) {
   if (text.length <= maxLength) return text;
   return text.substring(0, maxLength - 3) + '...';
}

escapeHTML(text) {
   const div = document.createElement('div');
   div.textContent = text;
   return div.innerHTML;
}
}

// –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–µ–≤—å—é
const socialPreviewGenerator = new SocialPreviewGenerator();

// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–´–ô –ö–õ–ê–°–° –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –£–†–û–í–ù–Ø–ú–ò
class UserLevelManager {
   constructor() {
       this.levels = {
           0: { name: 'FREE', cardLimit: 5, archiveLimit: 0, features: ['Basic cards'] },
           1: { name: 'USER', cardLimit: 20, archiveLimit: 20, features: ['Archive', 'Basic sharing'] },
           2: { name: 'MINI', cardLimit: 100, archiveLimit: 100, features: ['Advanced sharing', 'Templates'] },
           3: { name: 'ADMIN', cardLimit: 200, archiveLimit: 200, features: ['All features', 'Priority support'] },
           4: { name: 'SUPER', cardLimit: 500, archiveLimit: 500, features: ['Unlimited sharing', 'Custom branding'] },
           5: { name: 'MANAGER', cardLimit: 1000, archiveLimit: 1000, features: ['Team features', 'Analytics'] },
           6: { name: 'AUTHOR', cardLimit: -1, archiveLimit: -1, features: ['Unlimited everything', 'Co-author access'] }
       };
   }

   getLevelInfo(level) {
       return this.levels[level] || this.levels[0];
   }

   getCardLimit(level) {
       const info = this.getLevelInfo(level);
       return info.cardLimit === -1 ? '‚àû' : info.cardLimit;
   }

   getArchiveLimit(level) {
       const info = this.getLevelInfo(level);
       return info.archiveLimit === -1 ? '‚àû' : info.archiveLimit;
   }

   canCreateCard(level, currentCount) {
       const info = this.getLevelInfo(level);
       return info.cardLimit === -1 || currentCount < info.cardLimit;
   }

   canSaveToArchive(level, currentArchiveCount) {
       const info = this.getLevelInfo(level);
       return info.archiveLimit === -1 || currentArchiveCount < info.archiveLimit;
   }

   getLevelBadgeClass(level) {
       return `user-level-${level}`;
   }

   updateUserInterface(user) {
       if (!user) return;

       const levelInfo = this.getLevelInfo(user.level);
       
       // –û–±–Ω–æ–≤–ª—è–µ–º badge
       const badge = document.getElementById('userLevelBadge');
       if (badge) {
           badge.className = `user-level-badge ${this.getLevelBadgeClass(user.level)}`;
           badge.textContent = levelInfo.name;
       }

       // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏–º–∏—Ç—ã –∫–∞—Ä—Ç
       const cardsElement = document.getElementById('userCards');
       if (cardsElement) {
           const currentCount = user.cardCount || 0;
           const limit = this.getCardLimit(user.level);
           cardsElement.textContent = `Cards: ${currentCount}/${limit}`;
       }

       // –û–±–Ω–æ–≤–ª—è–µ–º –∞—Ä—Ö–∏–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
       this.updateArchiveStatus(user);
   }

   updateArchiveStatus(user) {
       const statusInfo = document.getElementById('archiveStatusInfo');
       const usageFill = document.getElementById('archiveUsageFill');
       const usageText = document.getElementById('archiveUsageText');
       
       if (!statusInfo || !usageFill || !usageText) return;

       const levelInfo = this.getLevelInfo(user.level);
       const archiveCount = user.archiveCount || 0;
       const archiveLimit = this.getArchiveLimit(user.level);

       if (user.level >= 1) {
           statusInfo.classList.add('show');
           
           if (archiveLimit === '‚àû') {
               usageFill.style.width = '100%';
               usageFill.classList.remove('warning', 'danger');
               usageText.textContent = `Archive: ${archiveCount}/‚àû`;
           } else {
               const percentage = (archiveCount / archiveLimit) * 100;
               usageFill.style.width = `${percentage}%`;
               
               if (percentage > 80) {
                   usageFill.classList.add('danger');
                   usageFill.classList.remove('warning');
               } else if (percentage > 60) {
                   usageFill.classList.add('warning');
                   usageFill.classList.remove('danger');
               } else {
                   usageFill.classList.remove('warning', 'danger');
               }
               
               usageText.textContent = `Archive: ${archiveCount}/${archiveLimit}`;
           }
       } else {
           statusInfo.classList.remove('show');
       }
   }
}

// –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —É—Ä–æ–≤–Ω–µ–π
const levelManager = new UserLevelManager();

// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
class NotificationManager {
   constructor() {
       this.container = document.getElementById('notificationContainer');
       if (!this.container) {
           this.container = document.createElement('div');
           this.container.id = 'notificationContainer';
           this.container.className = 'notification-container';
           document.body.appendChild(this.container);
       }
       this.notifications = [];
   }

   show(message, type = 'info', duration = 3000) {
       const notification = document.createElement('div');
       notification.className = `notification ${type}`;
       notification.textContent = message;
       
       const id = Date.now() + Math.random();
       notification.dataset.id = id;
       
       this.container.appendChild(notification);
       this.notifications.push({ id, element: notification, timeout: null });
       
       // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
       setTimeout(() => {
           notification.classList.add('show');
       }, 100);
       
       // –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ
       const timeoutId = setTimeout(() => {
           this.remove(id);
       }, duration);
       
       // –°–æ—Ö—Ä–∞–Ω—è–µ–º timeout –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã
       const notifIndex = this.notifications.findIndex(n => n.id === id);
       if (notifIndex !== -1) {
           this.notifications[notifIndex].timeout = timeoutId;
       }
       
       // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∏–∫—É
       notification.addEventListener('click', () => {
           this.remove(id);
       });
       
       return id;
   }

   remove(id) {
       const notifIndex = this.notifications.findIndex(n => n.id === id);
       if (notifIndex === -1) return;
       
       const notification = this.notifications[notifIndex];
       
       // –û—Ç–º–µ–Ω—è–µ–º timeout
       if (notification.timeout) {
           clearTimeout(notification.timeout);
       }
       
       // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
       notification.element.classList.remove('show');
       
       setTimeout(() => {
           if (notification.element.parentNode) {
               notification.element.parentNode.removeChild(notification.element);
           }
           this.notifications.splice(notifIndex, 1);
       }, 400);
   }

   clear() {
       this.notifications.forEach(notification => {
           if (notification.timeout) {
               clearTimeout(notification.timeout);
           }
           if (notification.element.parentNode) {
               notification.element.parentNode.removeChild(notification.element);
           }
       });
       this.notifications = [];
   }
}

// –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
const notificationManager = new NotificationManager();

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ WEB3
let currentLanguage = 'en';
let selectedStyle = 'classic';
let selectedTextPosition = 'bottom';
let selectedCTAPosition = 'bottom';
let uploadedMedia = null;
let currentUser = null;
let walletConnected = false;

// ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –ü–ï–†–ï–í–û–î–´ –° –ù–û–í–´–ú–ò –≠–õ–ï–ú–ï–ù–¢–ê–ú–ò
const translations = {
en: {
  pageTitle: "CardGift - Digital Card Generator",
  tagline: "Create stunning digital cards in seconds!",
  yourProfile: "Your Profile",
  instructionsBtn: "üìã Instructions",
  dashboardBtn: "üìä Dashboard",
  instructionsHeader: "üìã CardGift Guide",
  quickStartTitle: "üöÄ Quick Start",
  addPhotoTitle: "1. üì∏ Adding Photo",
  instruction1: "Click on the 'üì∏ Photo' area",
  instruction2: "Select an image from your device",
  instruction3: "Important: Use vertical photos for mobile (9:16 ratio)",
  instruction4: "Avoid: Horizontal photos ‚Äî they look bad on mobile cards",
  addTextTitle: "2. ‚úçÔ∏è Adding Text",
  instruction5: "Enter your greeting in the text field",
  instruction6: "Add personal message (appears by timer)",
  instruction7: "You can use emojis üéâüíïüéÇ",
  timersTitle: "3. ‚è±Ô∏è Timer Settings",
  instruction8: "Personal message timer: When personal text appears (1‚Äì30 sec)",
  instruction9: "Button offer timer: When 'Get generator' button shows (1‚Äì60 sec)",
  instruction10: "Banner timer: When advertising banner appears (if enabled)",
  buttonPositionTitle: "4. üìç Button Positioning",
  instruction11: "Choose from 9 positions for 'Liked the card?' button",
  instruction12: "Avoid positions that cover important content",
  instruction13: "Button is 1/3 screen width for neat appearance",
  styleTitle: "5. üé® Style Selection",
  instruction14: "‚ú® Gold (classic)",
  instruction15: "üåÖ Sunset (romantic)",
  instruction16: "üåä Ocean (fresh)",
  instruction17: "üåå Space (modern)",
  additionalFeaturesTitle: "üì¢ Additional Features",
  instruction18: "üé® Demo Templates: Ready texts for different occasions. Perfect for inspiration.",
  instruction19: "üì¢ Advertising Banner: Add HTML code for your banner. Perfect for business or event advertising. Set appearance timer.",
  instruction20: "üîó Referral System: Your unique 7-digit ID. Share referral link. Track new users (future feature).",
  mobileOptimizationTitle: "üéØ Mobile Optimization Tips",
  bestPhotoFormatsTitle: "Best Photo Formats:",
  instruction21: "Vertical photos ‚Üí perfect for mobile cards",
  instruction22: "Square photos ‚Üí will show with background",
  instruction23: "Avoid horizontal ‚Üí work poorly on mobile",
  mainRule: "üì± Main Rule: Always think mobile! Your cards will be viewed on phones. ‚ú®",
  closeInstructionsBtn: "Close",
  blockchainConnection: "Blockchain Connection",
  connectSafePalWallet: "üîó Connect SafePal Wallet",
  media: "Photo/Video",
  uploadMedia: "Click to upload photo or video",
  uploadRecommendation: "Recommended: vertical format (9:16)",
  orInsertVideo: "Or insert video URL:",
  text: "Text",
  addEmoji: "Add Emoji",
  textPosition: "Text Position",
  useTemplate: "Use template:",
  birthday: "Birthday",
  newyear: "New Year",
  love: "Love",
  thanks: "Thanks",
  congrats: "Congrats",
  instructions: "Instructions",
  preview: "Preview",
  style: "Style",
  classic: "Classic",
  sunset: "Sunset",
  ocean: "Ocean",
  space: "Space",
  neon: "Neon",
  advancedSettings: "Advanced Settings",
  callToAction: "Call to Action",
  buttonPosition: "Button Position:",
  messageTimer: "Message show delay:",
  buttonTimer: "Button show delay:",
  seconds: "seconds",
  marqueeText: "Running Text",
  marqueeTimer: "Show running text after:",
  banner: "Banner",
  bannerTimer: "Banner show delay:",
  archive: "Archive",
  archiveAccessTitle: "Archive Access",
  archiveFeatures: "‚úÖ Save cards ‚úÖ Share links ‚úÖ View history",
  archiveDescription: "Save your best cards to archive",
  saveToArchive: "Save to Archive",
  viewArchive: "View Archive",
  archiveLockedTitle: "Archive Locked",
  archiveLockedText: "Activate your account on opBNB network to access archive and advanced features",
  activateAccount: "Activate (0.01 BNB)",
  createCard: "Create Card",
  previewHere: "Preview will be here",
  edit: "Edit",
  create: "Create",
  creating: "Creating your card...",
  contentBlocked: "Content Blocked",
  contentPolicyViolation: "Your content violates our community guidelines and cannot be published.",
  tryAgain: "Try Again",
  shareCardTitle: "üéâ Your card is ready!",
  shareCardDescription: "Your card is created and ready to send:",
  shareImageMethod: "üì± For Messengers (Recommended)",
  shareImageDescription: "Share beautiful preview directly",
  downloadImage: "Share Preview",
  shareLinkMethod: "üîó Via Link",
  shareLinkDescription: "For email or social networks",
  copyLink: "Copy Link",
  shareOn: "Share on"
},
ru: {
  pageTitle: "CardGift - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –æ—Ç–∫—Ä—ã—Ç–æ–∫",
  tagline: "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ –∑–∞ —Å–µ–∫—É–Ω–¥—ã!",
  yourProfile: "–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å",
  instructionsBtn: "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
  dashboardBtn: "üìä –ü–∞–Ω–µ–ª—å",
  instructionsHeader: "üìã –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ CardGift",
  quickStartTitle: "üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç",
  addPhotoTitle: "1. üì∏ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ",
  instruction1: "–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –æ–±–ª–∞—Å—Ç—å 'üì∏ –§–æ—Ç–æ'",
  instruction2: "–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞",
  instruction3: "–í–∞–∂–Ω–æ: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (–ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ 9:16)",
  instruction4: "–ò–∑–±–µ–≥–∞–π—Ç–µ: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ ‚Äî –æ–Ω–∏ –ø–ª–æ—Ö–æ —Å–º–æ—Ç—Ä—è—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∫–∞—Ö",
  addTextTitle: "2. ‚úçÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞",
  instruction5: "–í–≤–µ–¥–∏—Ç–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –ø–æ–ª–µ —Ç–µ–∫—Å—Ç–∞",
  instruction6: "–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ —Ç–∞–π–º–µ—Ä—É)",
  instruction7: "–ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏ üéâüíïüéÇ",
  timersTitle: "3. ‚è±Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤",
  instruction8: "–¢–∞–π–º–µ—Ä –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: –ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ–∫—Å—Ç (1‚Äì30 —Å–µ–∫)",
  instruction9: "–¢–∞–π–º–µ—Ä –∫–Ω–æ–ø–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –ö–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ '–ü–æ–ª—É—á–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä' (1‚Äì60 —Å–µ–∫)",
  instruction10: "–¢–∞–π–º–µ—Ä –±–∞–Ω–Ω–µ—Ä–∞: –ö–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∫–ª–∞–º–Ω—ã–π –±–∞–Ω–Ω–µ—Ä (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)",
  buttonPositionTitle: "4. üìç –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏",
  instruction11: "–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ 9 –ø–æ–∑–∏—Ü–∏–π –¥–ª—è –∫–Ω–æ–ø–∫–∏ '–ü–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å –æ—Ç–∫—Ä—ã—Ç–∫–∞?'",
  instruction12: "–ò–∑–±–µ–≥–∞–π—Ç–µ –ø–æ–∑–∏—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç –≤–∞–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç",
  instruction13: "–ö–Ω–æ–ø–∫–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1/3 —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–≥–æ –≤–∏–¥–∞",
  styleTitle: "5. üé® –í—ã–±–æ—Ä —Å—Ç–∏–ª—è",
  instruction14: "‚ú® –ó–æ–ª–æ—Ç–æ (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π)",
  instruction15: "üåÖ –ó–∞–∫–∞—Ç (—Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π)",
  instruction16: "üåä –û–∫–µ–∞–Ω (—Å–≤–µ–∂–∏–π)",
  instruction17: "üåå –ö–æ—Å–º–æ—Å (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π)",
  additionalFeaturesTitle: "üì¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏",
  instruction18: "üé® –î–µ–º–æ-—à–∞–±–ª–æ–Ω—ã: –ì–æ—Ç–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤. –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è.",
  instruction19: "üì¢ –†–µ–∫–ª–∞–º–Ω—ã–π –±–∞–Ω–Ω–µ—Ä: –î–æ–±–∞–≤—å—Ç–µ HTML-–∫–æ–¥ –¥–ª—è —Å–≤–æ–µ–≥–æ –±–∞–Ω–Ω–µ—Ä–∞. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–µ–∫–ª–∞–º—ã –±–∏–∑–Ω–µ—Å–∞ –∏–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–∞–π–º–µ—Ä –ø–æ—è–≤–ª–µ–Ω–∏—è.",
  instruction20: "üîó –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: –í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π 7-–∑–Ω–∞—á–Ω—ã–π ID. –î–µ–ª–∏—Ç–µ—Å—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–æ–π. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–±—É–¥—É—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è).",
  mobileOptimizationTitle: "üéØ –°–æ–≤–µ—Ç—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏",
  bestPhotoFormatsTitle: "–õ—É—á—à–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ñ–æ—Ç–æ:",
  instruction21: "–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ ‚Üí –∏–¥–µ–∞–ª—å–Ω—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–æ–∫",
  instruction22: "–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Ñ–æ—Ç–æ ‚Üí –ø–æ–∫–∞–∂—É—Ç—Å—è —Å —Ñ–æ–Ω–æ–º",
  instruction23: "–ò–∑–±–µ–≥–∞–π—Ç–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö ‚Üí –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö",
  mainRule: "üì± –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –í—Å–µ–≥–¥–∞ –¥—É–º–∞–π—Ç–µ –æ –º–æ–±–∏–ª—å–Ω—ã—Ö! –í–∞—à–∏ –æ—Ç–∫—Ä—ã—Ç–∫–∏ –±—É–¥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö. ‚ú®",
  closeInstructionsBtn: "–ó–∞–∫—Ä—ã—Ç—å",
  blockchainConnection: "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–ª–æ–∫—á–µ–π–Ω—É",
  connectSafePalWallet: "üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å SafePal –∫–æ—à–µ–ª–µ–∫",
  media: "–§–æ—Ç–æ/–í–∏–¥–µ–æ",
  uploadMedia: "–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ",
  uploadRecommendation: "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (9:16)",
  orInsertVideo: "–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ URL –≤–∏–¥–µ–æ:",
  text: "–¢–µ–∫—Å—Ç",
  addEmoji: "–î–æ–±–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏",
  textPosition: "–ü–æ–∑–∏—Ü–∏—è —Ç–µ–∫—Å—Ç–∞",
  useTemplate: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω:",
  birthday: "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è",
  newyear: "–ù–æ–≤—ã–π –≥–æ–¥",
  love: "–õ—é–±–æ–≤—å",
  thanks: "–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å",
  congrats: "–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ",
  instructions: "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
  preview: "–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä",
  style: "–°—Ç–∏–ª—å",
  classic: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π",
  sunset: "–ó–∞–∫–∞—Ç",
  ocean: "–û–∫–µ–∞–Ω",
  space: "–ö–æ—Å–º–æ—Å",
  neon: "–ù–µ–æ–Ω",
  advancedSettings: "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
  callToAction: "–ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é",
  buttonPosition: "–ü–æ–∑–∏—Ü–∏—è –∫–Ω–æ–ø–∫–∏:",
  messageTimer: "–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–∫–∞–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:",
  buttonTimer: "–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–∫–∞–∑–∞ –∫–Ω–æ–ø–∫–∏:",
  seconds: "—Å–µ–∫—É–Ω–¥",
  marqueeText: "–ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞",
  marqueeTimer: "–ü–æ–∫–∞–∑–∞—Ç—å –±–µ–≥—É—â—É—é —Å—Ç—Ä–æ–∫—É —á–µ—Ä–µ–∑:",
  banner: "–ë–∞–Ω–Ω–µ—Ä",
  bannerTimer: "–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–∫–∞–∑–∞ –±–∞–Ω–Ω–µ—Ä–∞:",
  archive: "–ê—Ä—Ö–∏–≤",
  archiveAccessTitle: "–î–æ—Å—Ç—É–ø –∫ –∞—Ä—Ö–∏–≤—É",
  archiveFeatures: "‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç ‚úÖ –°—Å—ã–ª–∫–∏ –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞ ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤",
  archiveDescription: "–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å–≤–æ–∏ –ª—É—á—à–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ –≤ –∞—Ä—Ö–∏–≤",
  saveToArchive: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤",
  viewArchive: "–ü—Ä–æ—Å–º–æ—Ç—Ä –∞—Ä—Ö–∏–≤–∞",
  archiveLockedTitle: "–ê—Ä—Ö–∏–≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
  archiveLockedText: "–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –≤ —Å–µ—Ç–∏ opBNB –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞—Ä—Ö–∏–≤—É –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º",
  activateAccount: "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å (0.01 BNB)",
  createCard: "–°–æ–∑–¥–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç–∫—É",
  previewHere: "–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±—É–¥–µ—Ç –∑–¥–µ—Å—å",
  edit: "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å",
  create: "–°–æ–∑–¥–∞—Ç—å",
  creating: "–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏...",
  contentBlocked: "–ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
  contentPolicyViolation: "–í–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—à–∏–º –ø—Ä–∞–≤–∏–ª–∞–º —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω.",
  tryAgain: "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞",
  shareCardTitle: "üéâ –í–∞—à–∞ –æ—Ç–∫—Ä—ã—Ç–∫–∞ –≥–æ—Ç–æ–≤–∞!",
  shareCardDescription: "–í–∞—à–∞ –æ—Ç–∫—Ä—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ:",
  shareImageMethod: "üì± –î–ª—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)",
  shareImageDescription: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤—ã–º –ø—Ä–µ–≤—å—é –Ω–∞–ø—Ä—è–º—É—é",
  downloadImage: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–µ–≤—å—é",
  shareLinkMethod: "üîó –°—Å—ã–ª–∫–æ–π",
  shareLinkDescription: "–î–ª—è email –∏–ª–∏ —Å–æ—Ü—Å–µ—Ç–µ–π",
  copyLink: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É",
  shareOn: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤"
},
ua: {
  pageTitle: "CardGift - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ü–∏—Ñ—Ä–æ–≤–∏—Ö –ª–∏—Å—Ç—ñ–≤–æ–∫",
  tagline: "–°—Ç–≤–æ—Ä—é–π—Ç–µ –¥–∏–≤–æ–≤–∏–∂–Ω—ñ —Ü–∏—Ñ—Ä–æ–≤—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏ –∑–∞ —Å–µ–∫—É–Ω–¥–∏!",
  yourProfile: "–í–∞—à –ø—Ä–æ—Ñ—ñ–ª—å",
  instructionsBtn: "üìã –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó",
  dashboardBtn: "üìä –ü–∞–Ω–µ–ª—å",
  instructionsHeader: "üìã –ö–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ CardGift",
  quickStartTitle: "üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç",
  addPhotoTitle: "1. üì∏ –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–æ—Ç–æ",
  instruction1: "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –æ–±–ª–∞—Å—Ç—å 'üì∏ –§–æ—Ç–æ'",
  instruction2: "–í–∏–±–µ—Ä—ñ—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ –ø—Ä–∏—Å—Ç—Ä–æ—é",
  instruction3: "–í–∞–∂–ª–∏–≤–æ: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Ñ–æ—Ç–æ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö (–ø—Ä–æ–ø–æ—Ä—Ü—ñ—ó 9:16)",
  instruction4: "–£–Ω–∏–∫–∞–π—Ç–µ: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ñ —Ñ–æ—Ç–æ ‚Äî –≤–æ–Ω–∏ –ø–æ–≥–∞–Ω–æ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤–∫–∞—Ö",
  addTextTitle: "2. ‚úçÔ∏è –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É",
  instruction5: "–í–≤–µ–¥—ñ—Ç—å –≤—ñ—Ç–∞–Ω–Ω—è –≤ –ø–æ–ª–µ —Ç–µ–∫—Å—Ç—É",
  instruction6: "–î–æ–¥–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–∑'—è–≤–ª—è—î—Ç—å—Å—è –∑–∞ —Ç–∞–π–º–µ—Ä–æ–º)",
  instruction7: "–ú–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –µ–º–æ–¥–∑—ñ üéâüíïüéÇ",
  timersTitle: "3. ‚è±Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞–π–º–µ—Ä—ñ–≤",
  instruction8: "–¢–∞–π–º–µ—Ä –æ—Å–æ–±–∏—Å—Ç–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: –ö–æ–ª–∏ –∑'—è–≤–ª—è—î—Ç—å—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç (1‚Äì30 —Å–µ–∫)",
  instruction9: "–¢–∞–π–º–µ—Ä –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó: –ö–æ–ª–∏ –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ '–û—Ç—Ä–∏–º–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä' (1‚Äì60 —Å–µ–∫)",
  instruction10: "–¢–∞–π–º–µ—Ä –±–∞–Ω–µ—Ä–∞: –ö–æ–ª–∏ –∑'—è–≤–ª—è—î—Ç—å—Å—è —Ä–µ–∫–ª–∞–º–Ω–∏–π –±–∞–Ω–µ—Ä (—è–∫—â–æ –≤–∫–ª—é—á–µ–Ω–æ)",
  buttonPositionTitle: "4. üìç –ü–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏",
  instruction11: "–í–∏–±–µ—Ä—ñ—Ç—å –∑ 9 –ø–æ–∑–∏—Ü—ñ–π –¥–ª—è –∫–Ω–æ–ø–∫–∏ '–°–ø–æ–¥–æ–±–∞–ª–∞—Å—å –ª–∏—Å—Ç—ñ–≤–∫–∞?'",
  instruction12: "–£–Ω–∏–∫–∞–π—Ç–µ –ø–æ–∑–∏—Ü—ñ–π, —è–∫—ñ –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å –≤–∞–∂–ª–∏–≤–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç",
  instruction13: "–ö–Ω–æ–ø–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 1/3 —à–∏—Ä–∏–Ω–∏ –µ–∫—Ä–∞–Ω–∞ –¥–ª—è –∞–∫—É—Ä–∞—Ç–Ω–æ–≥–æ –≤–∏–≥–ª—è–¥—É",
  styleTitle: "5. üé® –í–∏–±—ñ—Ä —Å—Ç–∏–ª—é",
  instruction14: "‚ú® –ó–æ–ª–æ—Ç–æ (–∫–ª–∞—Å–∏—á–Ω–∏–π)",
  instruction15: "üåÖ –ó–∞—Ö—ñ–¥ (—Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∏–π)",
  instruction16: "üåä –û–∫–µ–∞–Ω (—Å–≤—ñ–∂–∏–π)",
  instruction17: "üåå –ö–æ—Å–º–æ—Å (—Å—É—á–∞—Å–Ω–∏–π)",
  additionalFeaturesTitle: "üì¢ –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó",
  instruction18: "üé® –î–µ–º–æ-—à–∞–±–ª–æ–Ω–∏: –ì–æ—Ç–æ–≤—ñ —Ç–µ–∫—Å—Ç–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤. –Ü–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è –Ω–∞—Ç—Ö–Ω–µ–Ω–Ω—è.",
  instruction19: "üì¢ –†–µ–∫–ª–∞–º–Ω–∏–π –±–∞–Ω–µ—Ä: –î–æ–¥–∞–π—Ç–µ HTML-–∫–æ–¥ –¥–ª—è –≤–∞—à–æ–≥–æ –±–∞–Ω–µ—Ä–∞. –Ü–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–µ–∫–ª–∞–º–∏ –±—ñ–∑–Ω–µ—Å—É –∞–±–æ –∑–∞—Ö–æ–¥—ñ–≤. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Ç–∞–π–º–µ—Ä –ø–æ—è–≤–∏.",
  instruction20: "üîó –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞: –í–∞—à —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π 7-–∑–Ω–∞—á–Ω–∏–π ID. –î—ñ–ª—ñ—Ç—å—Å—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º. –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–º–∞–π–±—É—Ç–Ω—è —Ñ—É–Ω–∫—Ü—ñ—è).",
  mobileOptimizationTitle: "üéØ –ü–æ—Ä–∞–¥–∏ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–æ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó",
  bestPhotoFormatsTitle: "–ù–∞–π–∫—Ä–∞—â—ñ —Ñ–æ—Ä–º–∞—Ç–∏ —Ñ–æ—Ç–æ:",
  instruction21: "–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Ñ–æ—Ç–æ ‚Üí —ñ–¥–µ–∞–ª—å–Ω—ñ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤–æ–∫",
  instruction22: "–ö–≤–∞–¥—Ä–∞—Ç–Ω—ñ —Ñ–æ—Ç–æ ‚Üí –ø–æ–∫–∞–∂—É—Ç—å—Å—è –∑ —Ñ–æ–Ω–æ–º",
  instruction23: "–£–Ω–∏–∫–∞–π—Ç–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏—Ö ‚Üí –ø–æ–≥–∞–Ω–æ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö",
  mainRule: "üì± –ì–æ–ª–æ–≤–Ω–µ –ø—Ä–∞–≤–∏–ª–æ: –ó–∞–≤–∂–¥–∏ –¥—É–º–∞–π—Ç–µ –ø—Ä–æ –º–æ–±—ñ–ª—å–Ω—ñ! –í–∞—à—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏ –±—É–¥—É—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö. ‚ú®",
  closeInstructionsBtn: "–ó–∞–∫—Ä–∏—Ç–∏",
  blockchainConnection: "–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–ª–æ–∫—á–µ–π–Ω—É",
  connectSafePalWallet: "üîó –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ SafePal –≥–∞–º–∞–Ω–µ—Ü—å",
  media: "–§–æ—Ç–æ/–í—ñ–¥–µ–æ",
  uploadMedia: "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å, —â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ –∞–±–æ –≤—ñ–¥–µ–æ",
  uploadRecommendation: "–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è: –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç (9:16)",
  orInsertVideo: "–ê–±–æ –≤—Å—Ç–∞–≤—Ç–µ URL –≤—ñ–¥–µ–æ:",
  text: "–¢–µ–∫—Å—Ç",
  addEmoji: "–î–æ–¥–∞—Ç–∏ –µ–º–æ–¥–∑—ñ",
  textPosition: "–ü–æ–∑–∏—Ü—ñ—è —Ç–µ–∫—Å—Ç—É",
  useTemplate: "–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —à–∞–±–ª–æ–Ω:",
  birthday: "–î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è",
  newyear: "–ù–æ–≤–∏–π —Ä—ñ–∫",
  love: "–õ—é–±–æ–≤",
  thanks: "–ü–æ–¥—è–∫–∞",
  congrats: "–í—ñ—Ç–∞–Ω–Ω—è",
  instructions: "–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó",
  preview: "–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥",
  style: "–°—Ç–∏–ª—å",
  classic: "–ö–ª–∞—Å–∏—á–Ω–∏–π",
  sunset: "–ó–∞—Ö—ñ–¥",
  ocean: "–û–∫–µ–∞–Ω",
  space: "–ö–æ—Å–º–æ—Å",
  neon: "–ù–µ–æ–Ω",
  advancedSettings: "–†–æ–∑—à–∏—Ä–µ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
  callToAction: "–ó–∞–∫–ª–∏–∫ –¥–æ –¥—ñ—ó",
  buttonPosition: "–ü–æ–∑–∏—Ü—ñ—è –∫–Ω–æ–ø–∫–∏:",
  messageTimer: "–ó–∞—Ç—Ä–∏–º–∫–∞ –ø–æ–∫–∞–∑—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:",
  buttonTimer: "–ó–∞—Ç—Ä–∏–º–∫–∞ –ø–æ–∫–∞–∑—É –∫–Ω–æ–ø–∫–∏:",
  seconds: "—Å–µ–∫—É–Ω–¥",
  marqueeText: "–ë—ñ–∂—É—á–∏–π —Ä—è–¥–æ–∫",
  marqueeTimer: "–ü–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–∂—É—á–∏–π —Ä—è–¥–æ–∫ —á–µ—Ä–µ–∑:",
  banner: "–ë–∞–Ω–µ—Ä",
  bannerTimer: "–ó–∞—Ç—Ä–∏–º–∫–∞ –ø–æ–∫–∞–∑—É –±–∞–Ω–µ—Ä–∞:",
  archive: "–ê—Ä—Ö—ñ–≤",
  archiveAccessTitle: "–î–æ—Å—Ç—É–ø –¥–æ –∞—Ä—Ö—ñ–≤—É",
  archiveFeatures: "‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–∞—Ä—Ç ‚úÖ –ü–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è —à–∞—Ä–∏–Ω–≥—É ‚úÖ –Ü—Å—Ç–æ—Ä—ñ—è –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤",
  archiveDescription: "–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Å–≤–æ—ó –Ω–∞–π–∫—Ä–∞—â—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏ –≤ –∞—Ä—Ö—ñ–≤",
  saveToArchive: "–ó–±–µ—Ä–µ–≥—Ç–∏ –≤ –∞—Ä—Ö—ñ–≤",
  viewArchive: "–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∞—Ä—Ö—ñ–≤",
  archiveLockedTitle: "–ê—Ä—Ö—ñ–≤ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ",
  archiveLockedText: "–ê–∫—Ç–∏–≤—É–π—Ç–µ –≤–∞—à –∞–∫–∞—É–Ω—Ç —É –º–µ—Ä–µ–∂—ñ opBNB –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∞—Ä—Ö—ñ–≤—É —Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π",
  activateAccount: "–ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏ (0.01 BNB)",
  createCard: "–°—Ç–≤–æ—Ä–∏—Ç–∏ –ª–∏—Å—Ç—ñ–≤–∫—É",
  previewHere: "–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ –±—É–¥–µ —Ç—É—Ç",
  edit: "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏",
  create: "–°—Ç–≤–æ—Ä–∏—Ç–∏",
  creating: "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤–∫–∏...",
  contentBlocked: "–ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ",
  contentPolicyViolation: "–í–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞—à–∏–º –ø—Ä–∞–≤–∏–ª–∞–º —Å–ø—ñ–ª—å–Ω–æ—Ç–∏ —ñ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–∏–π.",
  tryAgain: "–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É",
  shareCardTitle: "üéâ –í–∞—à–∞ –ª–∏—Å—Ç—ñ–≤–∫–∞ –≥–æ—Ç–æ–≤–∞!",
  shareCardDescription: "–í–∞—à–∞ –ª–∏—Å—Ç—ñ–≤–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∞ —ñ –≥–æ—Ç–æ–≤–∞ –¥–æ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏:",
  shareImageMethod: "üì± –î–ª—è –º–µ—Å–µ–Ω–¥–∂–µ—Ä—ñ–≤ (–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è)",
  shareImageDescription: "–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∫—Ä–∞—Å–∏–≤–∏–º –ø—Ä–µ–≤—å—é –Ω–∞–ø—Ä—è–º—É",
  downloadImage: "–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –ø—Ä–µ–≤—å—é",
  shareLinkMethod: "üîó –ü–æ—Å–∏–ª–∞–Ω–Ω—è–º",
  shareLinkDescription: "–î–ª—è email –∞–±–æ —Å–æ—Ü–º–µ—Ä–µ–∂",
  copyLink: "–ö–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è",
  shareOn: "–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –≤"
}
};

// ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –®–ê–ë–õ–û–ù–´ –¢–ï–ö–°–¢–û–í
const templates = {
birthday: {
  en: {
      greeting: "üéÇ Happy Birthday! üéâ\nWishing you all the best on your special day!",
      personal: "May all your dreams come true and this year bring you joy, love, and success!"
  },
  ru: {
      greeting: "üéÇ –° –î–Ω–µ–º –†–æ–∂–¥–µ–Ω–∏—è! üéâ\n–ñ–µ–ª–∞—é –≤—Å–µ–≥–æ —Å–∞–º–æ–≥–æ –ª—É—á—à–µ–≥–æ –≤ —Ç–≤–æ–π –æ—Å–æ–±–µ–Ω–Ω—ã–π –¥–µ–Ω—å!",
      personal: "–ü—É—Å—Ç—å –≤—Å–µ —Ç–≤–æ–∏ –º–µ—á—Ç—ã —Å–±—É–¥—É—Ç—Å—è, –∞ —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å–µ—Ç —Ä–∞–¥–æ—Å—Ç—å, –ª—é–±–æ–≤—å –∏ —É—Å–ø–µ—Ö!"
  },
  ua: {
      greeting: "üéÇ –ó –î–Ω–µ–º –ù–∞—Ä–æ–¥–∂–µ–Ω–Ω—è! üéâ\n–ë–∞–∂–∞—é –≤—Å—å–æ–≥–æ –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ –≤ —Ç–≤—ñ–π –æ—Å–æ–±–ª–∏–≤–∏–π –¥–µ–Ω—å!",
      personal: "–ù–µ—Ö–∞–π –≤—Å—ñ —Ç–≤–æ—ó –º—Ä—ñ—ó –∑–¥—ñ–π—Å–Ω—è—Ç—å—Å—è, –∞ —Ü–µ–π —Ä—ñ–∫ –ø—Ä–∏–Ω–µ—Å–µ —Ä–∞–¥—ñ—Å—Ç—å, –ª—é–±–æ–≤ —ñ —É—Å–ø—ñ—Ö!"
  }
},
newyear: {
  en: {
      greeting: "üéÑ Happy New Year! ‚ú®\nMay the coming year be filled with magic!",
      personal: "Wishing you health, happiness, and prosperity in the New Year!"
  },
  ru: {
      greeting: "üéÑ –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! ‚ú®\n–ü—É—Å—Ç—å –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–π –≥–æ–¥ –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –≤–æ–ª—à–µ–±—Å—Ç–≤–∞!",
      personal: "–ñ–µ–ª–∞—é –∑–¥–æ—Ä–æ–≤—å—è, —Å—á–∞—Å—Ç—å—è –∏ –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è –≤ –ù–æ–≤–æ–º –≥–æ–¥—É!"
  },
  ua: {
      greeting: "üéÑ –ó –ù–æ–≤–∏–º –†–æ–∫–æ–º! ‚ú®\n–ù–µ—Ö–∞–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—ñ–∫ –±—É–¥–µ –ø–æ–≤–Ω–∏–π –º–∞–≥—ñ—ó!",
      personal: "–ë–∞–∂–∞—é –∑–¥–æ—Ä–æ–≤'—è, —â–∞—Å—Ç—è —Ç–∞ –ø—Ä–æ—Ü–≤—ñ—Ç–∞–Ω–Ω—è –≤ –ù–æ–≤–æ–º—É —Ä–æ—Ü—ñ!"
  }
},
love: {
  en: {
      greeting: "üíï With Love üíï\nYou make every day special!",
      personal: "Thank you for being in my life. I love you more than words can express!"
  },
  ru: {
      greeting: "üíï –° –ª—é–±–æ–≤—å—é üíï\n–¢—ã –¥–µ–ª–∞–µ—à—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –æ—Å–æ–±–µ–Ω–Ω—ã–º!",
      personal: "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏. –Ø –ª—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º –º–æ–∂–Ω–æ –≤—ã—Ä–∞–∑–∏—Ç—å —Å–ª–æ–≤–∞–º–∏!"
  },
  ua: {
      greeting: "üíï –ó –ª—é–±–æ–≤'—é üíï\n–¢–∏ —Ä–æ–±–∏—à –∫–æ–∂–µ–Ω –¥–µ–Ω—å –æ—Å–æ–±–ª–∏–≤–∏–º!",
      personal: "–î—è–∫—É—é, —â–æ —Ç–∏ —î –≤ –º–æ—î–º—É –∂–∏—Ç—Ç—ñ. –Ø –ª—é–±–ª—é —Ç–µ–±–µ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –º–æ–∂–Ω–∞ –≤–∏—Å–ª–æ–≤–∏—Ç–∏ —Å–ª–æ–≤–∞–º–∏!"
  }
},
thanks: {
  en: {
      greeting: "üôè Thank You! üôè\nYour kindness means the world to me!",
      personal: "I'm truly grateful for everything you've done. You're amazing!"
  },
  ru: {
      greeting: "üôè –°–ø–∞—Å–∏–±–æ! üôè\n–¢–≤–æ—è –¥–æ–±—Ä–æ—Ç–∞ –∑–Ω–∞—á–∏—Ç –¥–ª—è –º–µ–Ω—è –æ—á–µ–Ω—å –º–Ω–æ–≥–æ!",
      personal: "–Ø –∏—Å–∫—Ä–µ–Ω–Ω–µ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –≤—Å–µ, —á—Ç–æ —Ç—ã —Å–¥–µ–ª–∞–ª. –¢—ã –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π!"
  },
  ua: {
      greeting: "üôè –î—è–∫—É—é! üôè\n–¢–≤–æ—è –¥–æ–±—Ä–æ—Ç–∞ –æ–∑–Ω–∞—á–∞—î –¥–ª—è –º–µ–Ω–µ –¥—É–∂–µ –±–∞–≥–∞—Ç–æ!",
      personal: "–Ø —â–∏—Ä–æ –≤–¥—è—á–Ω–∏–π –∑–∞ –≤—Å–µ, —â–æ —Ç–∏ –∑—Ä–æ–±–∏–≤. –¢–∏ –¥–∏–≤–æ–≤–∏–∂–Ω–∏–π!"
  }
},
congrats: {
  en: {
      greeting: "üéâ Congratulations! üéä\nYou did it! So proud of you!",
      personal: "Your hard work and dedication have paid off. Keep shining!"
  },
  ru: {
      greeting: "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! üéä\n–¢—ã —Å–¥–µ–ª–∞–ª —ç—Ç–æ! –ì–æ—Ä–∂—É—Å—å —Ç–æ–±–æ–π!",
      personal: "–¢–≤–æ–π —Ç—Ä—É–¥ –∏ –ø—Ä–µ–¥–∞–Ω–Ω–æ—Å—Ç—å –¥–µ–ª—É –æ–∫—É–ø–∏—Ç—Å—è. –ü—Ä–æ–¥–æ–ª–∂–∞–π —Å–≤–µ—Ç–∏—Ç—å!"
  },
  ua: {
      greeting: "üéâ –í—ñ—Ç–∞—é! üéä\n–¢–∏ –∑—Ä–æ–±–∏–≤ —Ü–µ! –ü–∏—à–∞—é—Å—è —Ç–æ–±–æ—é!",
      personal: "–¢–≤–æ—è –ø—Ä–∞—Ü—è —Ç–∞ –≤—ñ–¥–¥–∞–Ω—ñ—Å—Ç—å —Å–ø—Ä–∞–≤—ñ –æ–∫—É–ø–∏–ª–∏—Å—å. –ü—Ä–æ–¥–æ–≤–∂—É–π —Å—è—è—Ç–∏!"
  }
}
};

// ‚úÖ –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –≠–ú–û–î–ó–ò –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú
const emojis = {
smileys: ['üòÄ', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'üòÇ', 'ü§£', 'üòä', 'üòá', 'üôÇ', 'üôÉ', 'üòâ', 'üòå', 'üòç', 'ü•∞', 'üòò', 'üòó', 'üòô', 'üòö', 'üôÑ', 'üòè', 'üò™', 'üò¥', 'üò∑', 'ü§í', 'ü§ï', 'ü§¢', 'ü§Æ', 'ü§ß', 'ü•µ', 'ü•∂', 'ü•¥', 'üòµ', 'ü§Ø', 'ü§†', 'ü•≥', 'üòé', 'ü§ì', 'üßê'],
animals: ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ', 'ü¶Å', 'üêÆ', 'üê∑', 'üê∏', 'üêµ', 'üôà', 'üôâ', 'üôä', 'üêí', 'üêî', 'üêß', 'üê¶', 'üê§', 'üê£', 'üê•', 'ü¶Ü', 'ü¶Ö', 'ü¶â', 'ü¶á', 'üê∫', 'üêó', 'üê¥', 'ü¶Ñ', 'üêù', 'üêõ', 'ü¶ã', 'üêå', 'üêû', 'üêú', 'ü¶ü'],
food: ['üçè', 'üçé', 'üçê', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì', 'üçà', 'üçí', 'üçë', 'ü•≠', 'üçç', 'ü••', 'ü•ù', 'üçÖ', 'üçÜ', 'ü•ë', 'ü•¶', 'ü•í', 'ü•¨', 'üå∂Ô∏è', 'üåΩ', 'ü•ï', 'üßÑ', 'üßÖ', 'ü•î', 'üç†', 'ü•ê', 'üçû', 'ü•ñ', 'ü•®', 'üßÄ', 'ü•ö', 'üç≥', 'üßà', 'ü•û', 'üßá', 'ü•ì'],
travel: ['‚úàÔ∏è', 'üöó', 'üöï', 'üöô', 'üöå', 'üöé', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí', 'üöê', 'üõª', 'üöö', 'üöõ', 'üöú', 'üõ¥', 'üö≤', 'üõµ', 'üèçÔ∏è', 'üõ∫', 'üö®', 'üöî', 'üöç', 'üöò', 'üöñ', 'üö°', 'üö†', 'üöü', 'üöÉ', 'üöã', 'üöû', 'üöù', 'üöÑ', 'üöÖ', 'üöà', 'üöÇ', 'üöÜ', 'üöá', 'üöä', 'üöâ'],
activities: ['‚öΩ', 'üèÄ', 'üèà', '‚öæ', 'ü•é', 'üéæ', 'üèê', 'üèâ', 'ü•è', 'üé±', 'ü™Ä', 'üèì', 'üè∏', 'üèí', 'üèë', 'ü•ç', 'üèè', 'ü™É', 'ü•Ö', '‚õ≥', 'ü™Å', 'üèπ', 'üé£', 'ü§ø', 'ü•ä', 'ü•ã', 'üéΩ', 'üõπ', 'üõ∑', '‚õ∏Ô∏è', 'ü•å', 'üéø', '‚õ∑Ô∏è', 'üèÇ', 'ü™Ç', 'üèãÔ∏è‚Äç‚ôÇÔ∏è', 'ü§º‚Äç‚ôÇÔ∏è', 'ü§∏‚Äç‚ôÇÔ∏è', '‚õπÔ∏è‚Äç‚ôÇÔ∏è', 'ü§∫'],
objects: ['‚åö', 'üì±', 'üì≤', 'üíª', '‚å®Ô∏è', 'üñ•Ô∏è', 'üñ®Ô∏è', 'üñ±Ô∏è', 'üñ≤Ô∏è', 'üïπÔ∏è', 'üóúÔ∏è', 'üíΩ', 'üíæ', 'üíø', 'üìÄ', 'üìº', 'üì∑', 'üì∏', 'üìπ', 'üé•', 'üìΩÔ∏è', 'üéûÔ∏è', 'üìû', '‚òéÔ∏è', 'üìü', 'üì†', 'üì∫', 'üìª', 'üéôÔ∏è', 'üéöÔ∏è', 'üéõÔ∏è', 'üß≠', '‚è±Ô∏è', '‚è≤Ô∏è', '‚è∞', 'üï∞Ô∏è', '‚åõ', '‚è≥', 'üì°', 'üîã', 'üîå'],
symbols: ['‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'üñ§', 'ü§ç', 'ü§é', 'üíî', '‚ù£Ô∏è', 'üíï', 'üíû', 'üíì', 'üíó', 'üíñ', 'üíò', 'üíù', 'üíü', '‚òÆÔ∏è', '‚úùÔ∏è', '‚ò™Ô∏è', 'üïâÔ∏è', '‚ò∏Ô∏è', '‚ú°Ô∏è', 'üîØ', 'üïé', '‚òØÔ∏è', '‚ò¶Ô∏è', 'üõê', '‚õé', '‚ôà', '‚ôâ', '‚ôä', '‚ôã', '‚ôå', '‚ôç', '‚ôé', '‚ôè', '‚ôê'],
flags: ['üèÅ', 'üö©', 'üéå', 'üè¥', 'üè≥Ô∏è', 'üè≥Ô∏è‚Äçüåà', 'üè≥Ô∏è‚Äç‚ößÔ∏è', 'üè¥‚Äç‚ò†Ô∏è', 'üá¶üá´', 'üá¶üáΩ', 'üá¶üá±', 'üá©üáø', 'üá¶üá∏', 'üá¶üá©', 'üá¶üá¥', 'üá¶üáÆ', 'üá¶üá∂', 'üá¶üá¨', 'üá¶üá∑', 'üá¶üá≤', 'üá¶üáº', 'üá¶üá∫', 'üá¶üáπ', 'üá¶üáø', 'üáßüá∏', 'üáßüá≠', 'üáßüá©', 'üáßüáß', 'üáßüáæ', 'üáßüá™', 'üáßüáø', 'üáßüáØ', 'üáßüá≤', 'üáßüáπ', 'üáßüá¥', 'üáßüá¶', 'üáßüáº', 'üáßüá∑', 'üáªüá¨']
};

// ==================== ‚úÖ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

window.addEventListener('DOMContentLoaded', function() {
   initializeWeb3App();
});

// ‚úÖ WEB3: –£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
async function initializeWeb3App() {
try {
  console.log('üöÄ WEB3 Generator initialization started...');

// ‚úÖ –í–û–°–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –ö–û–®–ï–õ–ï–ö –í –ì–ï–ù–ï–†–ê–¢–û–†–ï
const savedWallet = walletState.load();
if (savedWallet) {
    console.log('üîÑ Restoring wallet in generator...');
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –í–°–ï –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    window.walletAddress = savedWallet.address;
    walletAddress = savedWallet.address;
    currentUser = {
        userId: savedWallet.userId,
        level: savedWallet.level,
        isActive: savedWallet.isActive,
        walletAddress: savedWallet.address
    };
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    document.querySelectorAll('.locked, .disabled').forEach(el => {
        el.classList.remove('locked', 'disabled');
    });
    
    console.log('‚úÖ Wallet fully restored:', savedWallet.userId);
}
  
  const detectedLang = detectLanguage();
  switchLanguage(detectedLang);

  const urlParams = new URLSearchParams(window.location.search);
  const isNewUser = urlParams.get('newUser');
  const userId = urlParams.get('userId');
  
  if (isNewUser && userId) {
      showWelcomeBanner(userId);
      window.history.replaceState({}, document.title, window.location.pathname);
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Web3 —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
  setTimeout(async () => {
      if (typeof walletManager !== 'undefined' && walletManager) {
          try {
              await walletManager.initWeb3();
              console.log('‚úÖ WEB3 wallet manager initialized');
          } catch (error) {
              console.warn('‚ö†Ô∏è WEB3 init failed:', error);
          }
      } else {
          console.warn('‚ö†Ô∏è WEB3 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ');
      }
  }, 500);
  
  await loadWeb3User();
  initializeEmojiPicker();
  await autoConnectWallet();
  initializeToggles();
  checkCreateButtonState();
  setupEventListeners();
  updateNetworkStatus();
  
  console.log('‚úÖ WEB3 Generator fully initialized');
  
} catch (error) {
  console.error('‚ùå WEB3 initialization error:', error);
  notificationManager.show('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Web3', 'error');
}
}

// ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
function detectLanguage() {
const urlParams = new URLSearchParams(window.location.search);
const langFromUrl = urlParams.get('lang');

if (langFromUrl && ['en', 'ru', 'ua'].includes(langFromUrl)) {
  return langFromUrl;
}

const savedLang = localStorage.getItem('generatorLanguage');
if (savedLang && ['en', 'ru', 'ua'].includes(savedLang)) {
  return savedLang;
}

const browserLang = navigator.language || navigator.userLanguage;
if (browserLang.startsWith('uk')) return 'ua';
if (browserLang.startsWith('ru')) return 'ru';
return 'en';
}

// ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
function switchLanguage(lang) {
currentLanguage = lang;
localStorage.setItem('generatorLanguage', lang);

document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
const langBtn = document.getElementById(`lang${lang.charAt(0).toUpperCase() + lang.slice(1)}`);
if (langBtn) {
   langBtn.classList.add('active');
}

updateAllTexts();
}

// ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤
function updateAllTexts() {
const t = translations[currentLanguage];

Object.keys(t).forEach(key => {
  const element = document.getElementById(key);
  if (element) {
      if (element.tagName === 'INPUT' && element.type === 'text') {
          element.placeholder = t[key];
      } else {
          element.textContent = t[key];
      }
  }
});

document.getElementById('pageTitle').textContent = t.pageTitle;
document.title = t.pageTitle;

const greetingTextarea = document.getElementById('greetingText');
if (greetingTextarea) {
  greetingTextarea.placeholder = currentLanguage === 'en' ? 'Enter your greeting here...' : 
                                currentLanguage === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–¥–µ—Å—å...' : 
                                '–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –≤—ñ—Ç–∞–Ω–Ω—è —Ç—É—Ç...';
}
}

// ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
function initializeToggles() {
const ctaToggle = document.getElementById('ctaToggle');
const ctaSettings = document.getElementById('ctaSettings');

if (ctaToggle && ctaSettings) {
   ctaToggle.checked = true;
   ctaSettings.style.display = 'block';
}

console.log('‚úÖ Toggles initialized: CTA enabled by default');
}

// ‚úÖ WEB3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
async function loadWeb3User() {
try {
  const localUser = localStorage.getItem('currentUser');
  
  if (localUser) {
      currentUser = JSON.parse(localUser);
      levelManager.updateUserInterface(currentUser);
  } else {
      currentUser = {
          userId: generateUserId(),
          level: 0,
          isActive: false,
          cardCount: 0,
          archiveCount: 0
      };
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      levelManager.updateUserInterface(currentUser);
  }
  
  checkArchiveAccess();
  
} catch (error) {
  console.error('‚ùå Error loading user:', error);
  currentUser = {
      userId: generateUserId(),
      level: 0,
      isActive: false,
      cardCount: 0,
      archiveCount: 0
  };
  levelManager.updateUserInterface(currentUser);
}
}

// ‚úÖ WEB3: –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
async function autoConnectWallet() {
if (typeof walletManager !== 'undefined' && walletManager && walletManager.isWalletConnected()) {
  try {
      const address = await walletManager.getAddress();
      if (address) {
          showWalletConnected(address);
          walletConnected = true;
          updateNetworkStatus();
      }
  } catch (error) {
      console.warn('‚ö†Ô∏è Auto-connect wallet failed:', error);
  }
}
}

// ‚úÖ WEB3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞—Ä—Ö–∏–≤—É —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
function checkArchiveAccess() {
const saveBtn = document.getElementById('saveToArchiveBtn');
const viewBtn = document.getElementById('viewArchiveBtn');
const lockedSection = document.getElementById('archiveLocked');

if (saveBtn && viewBtn && lockedSection) {
   if (currentUser && currentUser.level >= 1) {
       // –†–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –∞—Ä—Ö–∏–≤—É
       saveBtn.style.display = 'block';
       viewBtn.style.display = 'block';
       saveBtn.disabled = false;
       saveBtn.className = 'archive-btn save';
       lockedSection.style.display = 'none';
   } else {
       // –ê—Ä—Ö–∏–≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
       saveBtn.style.display = 'none';
       viewBtn.style.display = 'none';
       lockedSection.style.display = 'block';
   }
}
}

// ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ç–∏
async function updateNetworkStatus() {
const networkStatus = document.getElementById('networkStatus');
if (!networkStatus) return;

if (window.ethereum) {
   try {
       const chainId = await window.ethereum.request({ method: 'eth_chainId' });
       const currentChainId = parseInt(chainId, 16);
       
       if (currentChainId === 204) {
           networkStatus.innerHTML = 'üü¢ opBNB Mainnet';
           networkStatus.style.color = '#4CAF50';
       } else {
           networkStatus.innerHTML = 'üü° Wrong Network (Switch to opBNB)';
           networkStatus.style.color = '#FF9800';
       }
   } catch (error) {
       networkStatus.innerHTML = 'üî¥ Network Error';
       networkStatus.style.color = '#f44336';
   }
} else {
   networkStatus.innerHTML = '‚ö™ No Wallet Detected';
   networkStatus.style.color = '#888';
}
}

// ==================== ‚úÖ WEB3 –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö–û–®–ï–õ–¨–ö–ê –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

async function connectWallet() {
   try {
       const walletBtn = document.getElementById('walletConnectBtn');
       if (!walletBtn) return;
       
       walletBtn.textContent = currentLanguage === 'en' ? 'üîÑ Connecting...' : 
                             currentLanguage === 'ru' ? 'üîÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...' : 
                             'üîÑ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...';
       walletBtn.disabled = true;
       
       if (!window.ethereum) {
           throw new Error('–ö–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ SafePal –∏–ª–∏ MetaMask.');
       }
       
       // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
       const accounts = await window.ethereum.request({
           method: 'eth_requestAccounts'
       });
       
       if (!accounts || accounts.length === 0) {
           throw new Error('–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤');
       }
       
       const walletAddress = accounts[0];
       console.log('üíº Wallet connected:', walletAddress);

// ‚úÖ –ü–û–õ–ù–´–ô –î–û–°–¢–£–ü –î–õ–Ø –í–°–ï–•
if (walletAddress) {
    console.log('üíº Full access granted to all connected wallets!');
    currentUser = {
        userId: 'USER_' + walletAddress.substring(2, 8).toUpperCase(),
        level: 6,
        isActive: true,
        walletAddress: walletAddress
    };
    
    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
    document.querySelectorAll('.locked, .disabled').forEach(el => {
        el.classList.remove('locked', 'disabled');
    });
    
    // ‚úÖ –°–û–•–†–ê–ù–Ø–ï–ú –°–û–°–¢–û–Ø–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
    walletState.save({
        address: walletAddress,
        userId: currentUser.userId,
        level: currentUser.level,
        isActive: currentUser.isActive
    });
}
       
       // ‚úÖ –ü–†–û–í–ï–†–Ø–ï–ú –ò –ü–ï–†–ï–ö–õ–Æ–ß–ê–ï–ú –ù–ê opBNB
       const chainId = await window.ethereum.request({ method: 'eth_chainId' });
       const currentChainId = parseInt(chainId, 16);
       
       if (currentChainId !== 204) {
           console.log('üîÑ Switching to opBNB...');
           try {
               await window.ethereum.request({
                   method: 'wallet_switchEthereumChain',
                   params: [{ chainId: '0xCC' }] // 204 –≤ hex
               });
               notificationManager.show('‚úÖ Switched to opBNB!', 'success');
           } catch (switchError) {
               if (switchError.code === 4902) {
                   await window.ethereum.request({
                       method: 'wallet_addEthereumChain',
                       params: [{
                           chainId: '0xCC',
                           chainName: 'opBNB Mainnet',
                           nativeCurrency: { name: 'BNB', symbol: 'BNB', decimals: 18 },
                           rpcUrls: ['https://opbnb-mainnet-rpc.bnbchain.org'],
                           blockExplorerUrls: ['https://mainnet.opbnbscan.com/']
                       }]
                   });
                   notificationManager.show('‚úÖ opBNB network added!', 'success');
               } else {
                   throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ opBNB');
               }
           }
       } else {
           console.log('‚úÖ Already on opBNB');
       }
       
       // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
       showWalletConnected(walletAddress);
       walletConnected = true;
       updateNetworkStatus();
       
       // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º
       await syncUserWithBlockchain(walletAddress);
       
       const walletType = window.ethereum.isSafePal ? 'SafePal' : 
                         window.ethereum.isMetaMask ? 'MetaMask' : 'Web3 Wallet';
       
       const message = `‚úÖ ${walletType} –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ opBNB!`;
       notificationManager.show(message, 'success');
       
   } catch (error) {
       console.error('‚ùå Wallet connection error:', error);
       notificationManager.show(error.message, 'error');
       
       const walletBtn = document.getElementById('walletConnectBtn');
       if (walletBtn) {
           walletBtn.textContent = translations[currentLanguage].connectSafePalWallet;
           walletBtn.disabled = false;
       }
   }
}

// ‚úÖ WEB3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º
async function syncUserWithBlockchain(walletAddress) {
try {
  if (!currentUser || !currentUser.userId) {
      console.warn('‚ö†Ô∏è No current user to sync');
      return;
  }
  
  if (typeof walletManager !== 'undefined' && walletManager.getUser) {
      const web3User = await walletManager.getUser(currentUser.userId);
      
      if (web3User && web3User.wallet) {
          currentUser = { ...currentUser, ...web3User };
          localStorage.setItem('currentUser', JSON.stringify(currentUser));
          levelManager.updateUserInterface(currentUser);
          checkArchiveAccess();
          console.log('‚úÖ User synced with blockchain');
      } else {
          console.log('‚ÑπÔ∏è User not found in blockchain');
      }
  }
  
} catch (error) {
  console.warn('‚ö†Ô∏è Could not sync user with blockchain:', error);
}
}

// ‚úÖ WEB3: –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫
function showWalletConnected(address) {
    walletConnected = true;
    const walletStatusElement = document.getElementById('walletStatus');
    if (walletStatusElement) {
       walletStatusElement.innerHTML = `
          <div style="background: rgba(76, 175, 80, 0.1); color: #4CAF50; padding: 10px; border-radius: 10px; margin-top: 10px; text-align: center;">
              <div style="font-weight: bold;">‚úÖ ${currentLanguage === 'en' ? 'Wallet connected' : currentLanguage === 'ru' ? '–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω' : '–ì–∞–º–∞–Ω–µ—Ü—å –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ'}</div>
              <div style="font-size: 12px; color: #CCC; margin-top: 5px;">${address.substring(0, 6)}...${address.substring(address.length - 4)}</div>
              <button onclick="disconnectWallet()" id="disconnectBtnGen" 
                      style="background: #FF4444; color: white; border: none; border-radius: 8px; 
                             padding: 8px 15px; cursor: pointer; margin-top: 10px; font-size: 12px;">
                  üö™ ${currentLanguage === 'en' ? 'Disconnect' : currentLanguage === 'ru' ? '–û—Ç–∫–ª—é—á–∏—Ç—å' : '–í—ñ–¥–∫–ª—é—á–∏—Ç–∏'}
              </button>
          </div>
       `;
    }
}

// ‚úÖ –û–¢–ö–õ–Æ–ß–ï–ù–ò–ï –ö–û–®–ï–õ–¨–ö–ê –í –ì–ï–ù–ï–†–ê–¢–û–†–ï
function disconnectWallet() {
    if (confirm('Disconnect wallet?')) {
        walletAddress = null;
        walletConnected = false;
        currentUser = null;
        
        // –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        walletState.clear();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        const walletStatusElement = document.getElementById('walletStatus');
        if (walletStatusElement) {
            walletStatusElement.innerHTML = '';
        }
        
        console.log('üö™ Wallet disconnected from generator');
        location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
    }
}
const walletBtn = document.getElementById('walletConnectBtn');
if (walletBtn) {
   walletBtn.style.display = 'none';
  }
}

// ==================== ‚úÖ –°–û–ó–î–ê–ù–ò–ï –ö–ê–†–¢–´ –° –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ú –ü–†–ï–í–¨–Æ ====================

async function createCard() {
   console.log('üé® Starting card creation...');

   // ‚úÖ –ê–í–¢–û–û–ß–ò–°–¢–ö–ê –ü–ê–ú–Ø–¢–ò –ü–ï–†–ï–î –°–û–ó–î–ê–ù–ò–ï–ú –ö–ê–†–¢–´
   console.log('üßπ Auto-cleaning memory before card creation...');

   // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø—Ä–µ–≤—å—é –∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
   Object.keys(localStorage).forEach(key => {
       const item = localStorage.getItem(key);
       if (item && (
           key.startsWith('cardPreview_') || 
           key.startsWith('tempCard_') || 
           item.length > 50000 // –§–∞–π–ª—ã –±–æ–ª—å—à–µ 50KB
       )) {
           localStorage.removeItem(key);
       }
   });

   // –û—á–∏—â–∞–µ–º canvas
   document.querySelectorAll('canvas').forEach(canvas => {
       const ctx = canvas.getContext('2d');
       if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
   });

   // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º blob URLs
   document.querySelectorAll('img[src^="blob:"]').forEach(img => {
       URL.revokeObjectURL(img.src);
   });

   console.log('‚úÖ Memory auto-cleaned successfully');
}   
   // ‚úÖ –ü–†–û–í–ï–†–Ø–ï–ú –°–ï–¢–¨ opBNB –ü–ï–†–ï–î –°–û–ó–î–ê–ù–ò–ï–ú
   if (window.ethereum) {
       try {
           const chainId = await window.ethereum.request({ method: 'eth_chainId' });
           const currentChainId = parseInt(chainId, 16);
           
           if (currentChainId !== 204) {
               console.log('‚ùå Wrong network! Current:', currentChainId, 'Need: 204 (opBNB)');
               
               try {
                   await window.ethereum.request({
                       method: 'wallet_switchEthereumChain',
                       params: [{ chainId: '0xCC' }] // 204 –≤ hex
                   });
                   notificationManager.show('‚úÖ Switched to opBNB!', 'success');
               } catch (switchError) {
                   if (switchError.code === 4902) {
                       await window.ethereum.request({
                           method: 'wallet_addEthereumChain',
                           params: [{
                               chainId: '0xCC',
                               chainName: 'opBNB Mainnet',
                               nativeCurrency: { name: 'BNB', symbol: 'BNB', decimals: 18 },
                               rpcUrls: ['https://opbnb-mainnet-rpc.bnbchain.org'],
                               blockExplorerUrls: ['https://mainnet.opbnbscan.com/']
                           }]
                       });
                       notificationManager.show('‚úÖ opBNB network added!', 'success');
                   } else {
                       notificationManager.show('‚ùå Switch to opBNB network manually!', 'error');
                       return;
                   }
               }
           } else {
               console.log('‚úÖ Already on opBNB network');
           }
       } catch (error) {
           console.error('Network check failed:', error);
           notificationManager.show('‚ùå Please switch to opBNB network', 'error');
           return;
       }
   }

   const greetingText = document.getElementById('greetingText').value.trim();
   const videoUrl = document.getElementById('videoUrl').value.trim();

   // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   if (!levelManager.canCreateCard(currentUser.level, currentUser.cardCount || 0)) {
       const levelInfo = levelManager.getLevelInfo(currentUser.level);
       notificationManager.show(
           currentLanguage === 'en' ? `Card limit reached (${levelInfo.cardLimit}). Upgrade your account.` :
           currentLanguage === 'ru' ? `–î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∫–∞—Ä—Ç (${levelInfo.cardLimit}). –£–ª—É—á—à–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç.` :
           `–î–æ—Å—è–≥–Ω—É—Ç–æ –ª—ñ–º—ñ—Ç –∫–∞—Ä—Ç (${levelInfo.cardLimit}). –ü–æ–∫—Ä–∞—â—Ç–µ –∞–∫–∞—É–Ω—Ç.`,
           'warning', 5000
       );
       return;
   }

   // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   const contentCheck = checkContent(greetingText);
   if (!contentCheck.isClean) {
       console.warn('üö´ –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:', contentCheck.badWords);
       showContentBlockedModal();
       return;
   }

   // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–µ–æ
   if (videoUrl) {
       const videoData = videoProcessor.parseVideoUrl(videoUrl);
       if (!videoData.isValid) {
           notificationManager.show(
               currentLanguage === 'en' ? `Video error: ${videoData.error}` :
               currentLanguage === 'ru' ? `–û—à–∏–±–∫–∞ –≤–∏–¥–µ–æ: ${videoData.error}` :
               `–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–µ–æ: ${videoData.error}`,
               'error'
           );
           return;
       }
   }

   // –í–∞–ª–∏–¥–∞—Ü–∏—è
   if (!greetingText && !uploadedMedia && !videoUrl) {
       notificationManager.show(
           currentLanguage === 'en' ? 'Add greeting text or media' :
           currentLanguage === 'ru' ? '–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ –º–µ–¥–∏–∞' :
           '–î–æ–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç –≤—ñ—Ç–∞–Ω–Ω—è –∞–±–æ –º–µ–¥—ñ–∞',
           'error'
       );
       return;
   }

   if (!currentUser || !currentUser.userId) {
       notificationManager.show('–û—à–∏–±–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω', 'error');
       return;
   }

   const createBtn = document.getElementById('createCardBtn');
   if (createBtn) {
       createBtn.classList.add('loading');
       createBtn.disabled = true;
   }

   try {
       console.log('üé® Creating Web3 card with preview...');
       
       const cardMetadata = await prepareCardMetadata();
       
       // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–≤—å—é
       console.log('üñºÔ∏è –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–≤—å—é...');
       const previewResult = await generateCardPreview(cardMetadata);
       
       // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ç–∞-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
       try {
           console.log('üì° –°–æ–∑–¥–∞–µ–º –º–µ—Ç–∞-—Å—Ç—Ä–∞–Ω–∏—Ü—É...');
           const response = await fetch('/api/save-card', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json',
               },
               body: JSON.stringify({
                   cardId: cardMetadata.cardId,
                   cardData: cardMetadata,
                   previewImage: previewResult.previewImageUrl
               })
           });
           
           const result = await response.json();
           console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', result);
           
           // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞
           if (result.shareUrl) {
               cardMetadata.shareUrl = result.shareUrl;
           }
       } catch (error) {
           console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–µ—Ç–∞-—Å—Ç—Ä–∞–Ω–∏—Ü—ã:', error);
       }
       
       // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–°–´–õ–ö–ê –° –£–ù–ò–ö–ê–õ–¨–ù–´–ú ID
       const shareableLink = `${window.location.origin}/api/card/${cardMetadata.cardId}`;
       cardMetadata.shareUrl = shareableLink;
       
       // ‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–∞—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
       currentUser.cardCount = (currentUser.cardCount || 0) + 1;
       localStorage.setItem('currentUser', JSON.stringify(currentUser));
       levelManager.updateUserInterface(currentUser);
       
       // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
       showEnhancedCardResult(cardMetadata, { 
           ...previewResult, 
           shareUrl: shareableLink 
       });
       
       const message = currentLanguage === 'en' ? '‚ú® Card created successfully!' :
                     currentLanguage === 'ru' ? '‚ú® –û—Ç–∫—Ä—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!' :
                     '‚ú® –õ–∏—Å—Ç—ñ–≤–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ!';
       notificationManager.show(message, 'success');
       
       // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è
       clearForm();
       
   } catch (error) {
       console.error('‚ùå Card creation error:', error);
       const message = error.message || (currentLanguage === 'en' ? 'Card creation error' :
                                       currentLanguage === 'ru' ? '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç–∫–∏' :
                                       '–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤–∫–∏');
       notificationManager.show(message, 'error');
       
   } finally {
       if (createBtn) {
           createBtn.classList.remove('loading');
           createBtn.disabled = false;
       }
   }
}

// ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã
function clearForm() {
   const greetingText = document.getElementById('greetingText');
   const videoUrl = document.getElementById('videoUrl');
   
   if (greetingText) greetingText.value = '';
   if (videoUrl) videoUrl.value = '';
   
   removeMedia();
   checkCreateButtonState();
}

// ‚úÖ WEB3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∫–∏ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
async function prepareCardMetadata() {
   // ‚úÖ –ì–ï–ù–ï–†–ò–†–£–ï–ú –£–ù–ò–ö–ê–õ–¨–ù–´–ô ID –ö–ê–ñ–î–´–ô –†–ê–ó
   const timestamp = Date.now();
   const randomSuffix = Math.random().toString(36).substring(2, 8);
   const cardId = `card_${timestamp}_${randomSuffix}`;
   
   console.log('üÜî Generated UNIQUE card ID:', cardId);
   
   const greetingText = sanitizeInput(document.getElementById('greetingText')?.value?.trim() || '');
   const videoUrl = sanitizeInput(document.getElementById('videoUrl')?.value?.trim() || '');

   const metadata = {
       cardId: cardId, // ‚úÖ –ö–ê–ñ–î–´–ô –†–ê–ó –ù–û–í–´–ô ID
       userId: currentUser?.userId || generateUserId(),
       userLevel: currentUser?.level || 0,
       greeting: greetingText,
       personalMessage: '',
       videoUrl: videoUrl,
       style: selectedStyle,
       textPosition: selectedTextPosition,
       ctaEnabled: document.getElementById('ctaToggle')?.checked || false,
       ctaTitle: sanitizeInput(document.getElementById('ctaTitle')?.value || ''),
       ctaButton: sanitizeInput(document.getElementById('ctaButton')?.value || ''),
       ctaUrl: sanitizeInput(document.getElementById('ctaUrl')?.value || ''),
       ctaPosition: selectedCTAPosition,
       marqueeEnabled: document.getElementById('marqueeToggle')?.checked || false,
       marqueeText: sanitizeInput(document.getElementById('marqueeTextInput')?.value || ''),
       marqueeUrl: sanitizeInput(document.getElementById('marqueeUrl')?.value || ''),
       marqueeTimer: parseInt(document.getElementById('marqueeTimerInput')?.value) || 7,
       bannerEnabled: document.getElementById('bannerToggle')?.checked || false,
       bannerHtml: sanitizeInput(document.getElementById('bannerHtml')?.value || ''),
       bannerUrl: sanitizeInput(document.getElementById('bannerUrl')?.value || ''),
       timers: {
           message: parseInt(document.getElementById('messageTimerInput')?.value) || 0,
           button: parseInt(document.getElementById('buttonTimerInput')?.value) || 3,
           banner: parseInt(document.getElementById('bannerTimerInput')?.value) || 5
       },
       createdAt: new Date().toISOString(),
       viewCount: 0,
       isArchived: false,
       language: currentLanguage
   };

   if (uploadedMedia && uploadedMedia.file) {
       const mediaBase64 = await fileToBase64(uploadedMedia.file);
       metadata.mediaType = uploadedMedia.type;
       metadata.mediaUrl = mediaBase64;
   }

   // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ URL
   if (videoUrl) {
       const videoData = videoProcessor.parseVideoUrl(videoUrl);
       if (videoData.isValid) {
           metadata.videoData = videoData;
           metadata.mediaType = 'video';
           metadata.videoUrl = videoUrl;
           metadata.embedUrl = videoData.embedUrl;
           console.log('‚úÖ Video URL –æ–±—Ä–∞–±–æ—Ç–∞–Ω:', videoUrl);
       }
   }

   return metadata;
}

// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò –ü–†–ï–í–¨–Æ
async function generateCardPreview(cardMetadata) {
   try {
       console.log('üé® Generating card preview...');
       
       const previewImage = await socialPreviewGenerator.generatePreviewImage(cardMetadata);
       const cardUrl = `${window.location.origin}/api/card/${cardMetadata.cardId}`;
       
       // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
       await saveCard(cardMetadata);
       
       return {
           success: true,
           previewImageUrl: previewImage,
           cardViewUrl: cardUrl,
           shareUrl: cardUrl,
           fallback: false
       };
       
   } catch (error) {
       console.error('‚ùå Preview generation error:', error);
       
       // –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
       const fallbackPreview = socialPreviewGenerator.generateFallbackPreview(cardMetadata);
       const cardUrl = `${window.location.origin}/api/card/${cardMetadata.cardId}`;
       
       await saveCard(cardMetadata);
       
       return {
           success: true,
           previewImageUrl: fallbackPreview,
           cardViewUrl: cardUrl,
           shareUrl: cardUrl,
           fallback: true
       };
   }
}

// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê –° –ü–†–ï–í–¨–Æ
function showEnhancedCardResult(cardMetadata, previewResult) {
const t = translations[currentLanguage];

const overlay = document.createElement('div');
overlay.className = 'share-modal';

const modal = document.createElement('div');
modal.className = 'share-modal-content';

modal.innerHTML = `
  <button onclick="this.parentElement.parentElement.remove(); document.body.style.overflow = 'auto';" style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #FFD700; font-size: 24px; cursor: pointer;">√ó</button>
  
  <h2 style="color: #FFD700; margin-bottom: 20px; text-align: center; font-size: 24px;">${t.shareCardTitle}</h2>
  
  <p style="color: #CCC; margin-bottom: 20px; text-align: center;">${t.shareCardDescription}</p>
  
  ${previewResult.previewImageUrl ? `
  <div class="preview-image-container">
      <img src="${previewResult.previewImageUrl}" alt="Card Preview" style="max-width: 100%; height: auto; border-radius: 10px; border: 2px solid #FFD700;">
  </div>
  ` : ''}
  
  <div class="share-methods">
      <div class="share-method">
          <h4>${t.shareImageMethod}</h4>
          <p>${t.shareImageDescription}</p>
          <div class="share-method-buttons">
              <button class="share-method-btn" onclick="sharePreviewDirectly('${cardMetadata.cardId}', '${previewResult.shareUrl}')">
                  üì± ${t.downloadImage}
              </button>
          </div>
          <div class="social-platforms">
              <button class="social-platform-btn whatsapp" onclick="shareToMessenger('whatsapp', '${previewResult.shareUrl}')">
                  üì±<br>WhatsApp
              </button>
              <button class="social-platform-btn telegram" onclick="shareToMessenger('telegram', '${previewResult.shareUrl}')">
                  ‚úàÔ∏è<br>Telegram
              </button>
              <button class="social-platform-btn viber" onclick="shareToMessenger('viber', '${previewResult.shareUrl}')">
                  üíú<br>Viber
              </button>
              <button class="social-platform-btn email" onclick="shareToMessenger('email', '${previewResult.shareUrl}')">
                  üìß<br>Email
              </button>
          </div>
      </div>
      
      <div class="share-method">
          <h4>${t.shareLinkMethod}</h4>
          <p>${t.shareLinkDescription}</p>
          <div style="background: #333; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
              <div style="color: #FFF; word-break: break-all; font-size: 14px;" id="shareableUrl">${previewResult.shareUrl}</div>
          </div>
          <div class="share-method-buttons">
               <button class="share-method-btn" onclick="copyToClipboard('${previewResult.shareUrl}')">
                   üìã ${t.copyLink}
               </button>
               <button class="share-method-btn secondary" onclick="window.open('${previewResult.shareUrl}', '_blank')">
                   üëÅÔ∏è ${translations[currentLanguage].preview || 'View'}
               </button>
           </div>
           <div class="social-platforms">
               <button class="social-platform-btn facebook" onclick="shareToSocial('facebook', '${previewResult.shareUrl}')">
                   üë•<br>Facebook
               </button>
               <button class="social-platform-btn x" onclick="shareToSocial('x', '${previewResult.shareUrl}')">
                   üê¶<br>X
               </button>
               <button class="social-platform-btn instagram" onclick="shareToSocial('instagram', '${previewResult.shareUrl}')">
                   üì∑<br>Instagram
               </button>
               <button class="social-platform-btn tiktok" onclick="shareToSocial('tiktok', '${previewResult.shareUrl}')">
                   üéµ<br>TikTok
               </button>
           </div>
      </div>
  </div>
`;

overlay.appendChild(modal);
document.body.appendChild(overlay);
document.body.style.overflow = 'hidden';

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
overlay.addEventListener('click', function(e) {
  if (e.target === overlay) {
      overlay.remove();
      document.body.style.overflow = 'auto';
  }
});
}

// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –®–ï–†–ò–ù–ì–ê

function sharePreviewDirectly(cardId, shareUrl) {
   const messages = {
       en: "üéâ Look at this beautiful greeting card!",
       ru: "üéâ –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç—É –∫—Ä–∞—Å–∏–≤—É—é –æ—Ç–∫—Ä—ã—Ç–∫—É!", 
       ua: "üéâ –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ —Ü—é –∫—Ä–∞—Å–∏–≤—É –ª–∏—Å—Ç—ñ–≤–∫—É!"
   };
   
   const message = `${messages[currentLanguage] || messages.ru} ${shareUrl}`;
   
   if (navigator.share) {
       navigator.share({
           title: 'CardGift - Beautiful Greeting Card',
           text: message,
           url: shareUrl
       }).then(() => {
           notificationManager.show(
               currentLanguage === 'en' ? 'üì± Shared successfully!' :
               currentLanguage === 'ru' ? 'üì± –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–µ–ª–∏–ª–∏—Å—å!' :
               'üì± –£—Å–ø—ñ—à–Ω–æ –ø–æ–¥—ñ–ª–∏–ª–∏—Å—å!',
               'success'
           );
       }).catch(console.error);
   } else {
       copyToClipboard(message);
       notificationManager.show(
           currentLanguage === 'en' ? 'üìã Link copied! Open messenger and paste to see preview' :
           currentLanguage === 'ru' ? 'üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–∫—Ä–æ–π—Ç–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –¥–ª—è –ø—Ä–µ–≤—å—é' :
           'üìã –ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! –í—ñ–¥–∫—Ä–∏–π—Ç–µ –º–µ—Å–µ–Ω–¥–∂–µ—Ä —ñ –≤—Å—Ç–∞–≤—Ç–µ –¥–ª—è –ø—Ä–µ–≤—å—é',
           'info', 4000
       );
   }
}

function shareToMessenger(platform, shareUrl) {
  const messages = {
      en: "üéâ Look at this beautiful greeting card!",
      ru: "üéâ –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç—É –∫—Ä–∞—Å–∏–≤—É—é –æ—Ç–∫—Ä—ã—Ç–∫—É!", 
      ua: "üéâ –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ —Ü—é –∫—Ä–∞—Å–∏–≤—É –ª–∏—Å—Ç—ñ–≤–∫—É!"
  };
  
  const message = messages[currentLanguage] || messages.ru;
  const fullMessage = `${message} ${shareUrl}`;
  
  const shareUrls = {
      whatsapp: `https://wa.me/?text=${encodeURIComponent(fullMessage)}`,
      telegram: `https://t.me/share/url?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(message)}`,
      viber: `viber://forward?text=${encodeURIComponent(fullMessage)}`,
      email: `mailto:?subject=${encodeURIComponent('Beautiful Greeting Card - CardGift')}&body=${encodeURIComponent(fullMessage)}`
  };
  
  if (shareUrls[platform]) {
      if (platform === 'viber' || platform === 'email') {
          copyToClipboard(fullMessage);
          notificationManager.show(
              currentLanguage === 'en' ? `Text copied! Open ${platform.charAt(0).toUpperCase() + platform.slice(1)} and paste` :
              currentLanguage === 'ru' ? `–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –û—Ç–∫—Ä–æ–π—Ç–µ ${platform === 'viber' ? 'Viber' : 'Email'} –∏ –≤—Å—Ç–∞–≤—å—Ç–µ` :
              `–¢–µ–∫—Å—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! –í—ñ–¥–∫—Ä–∏–π—Ç–µ ${platform === 'viber' ? 'Viber' : 'Email'} —ñ –≤—Å—Ç–∞–≤—Ç–µ`,
              'info', 4000
          );
      } else {
          window.open(shareUrls[platform], '_blank');
      }
  }
}

function shareToSocial(platform, url) {
const text = currentLanguage === 'en' ? 'Check out this beautiful greeting card!' : 
          currentLanguage === 'ru' ? '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç—É –∫—Ä–∞—Å–∏–≤—É—é –æ—Ç–∫—Ä—ã—Ç–∫—É!' : 
          '–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ —Ü—é –∫—Ä–∞—Å–∏–≤—É –ª–∏—Å—Ç—ñ–≤–∫—É!';

const shareUrls = {
  facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,
  x: `https://x.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,
  instagram: url,
  tiktok: url
};

if (platform === 'instagram' || platform === 'tiktok') {
  copyToClipboard(url);
  const appName = platform === 'instagram' ? 'Instagram' : 'TikTok';
  const message = currentLanguage === 'en' ? `Link copied! Open ${appName} and paste in your story/post` :
                currentLanguage === 'ru' ? `–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–∫—Ä–æ–π—Ç–µ ${appName} –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –∏—Å—Ç–æ—Ä–∏—é/–ø–æ—Å—Ç` :
                `–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! –í—ñ–¥–∫—Ä–∏–π—Ç–µ ${appName} —ñ –≤—Å—Ç–∞–≤—Ç–µ –≤ —ñ—Å—Ç–æ—Ä—ñ—é/–ø–æ—Å—Ç`;
  notificationManager.show(message, 'info', 4000);
} else if (shareUrls[platform]) {
  window.open(shareUrls[platform], '_blank');
}
}

function copyToClipboard(text) {
if (navigator.clipboard) {
  navigator.clipboard.writeText(text).then(() => {
      const message = currentLanguage === 'en' ? 'üìã Link copied!' : 
                    currentLanguage === 'ru' ? 'üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!' : 
                    'üìã –ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!';
      notificationManager.show(message, 'success');
  });
} else {
  const textarea = document.createElement('textarea');
  textarea.value = text;
  textarea.style.position = 'fixed';
  textarea.style.opacity = '0';
  document.body.appendChild(textarea);
  textarea.select();
  document.execCommand('copy');
  document.body.removeChild(textarea);
  
  const message = currentLanguage === 'en' ? 'üìã Link copied!' : 
                currentLanguage === 'ru' ? 'üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!' : 
                'üìã –ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!';
  notificationManager.show(message, 'success');
}
}

// ==================== ‚úÖ –ë–õ–û–ö–ò–†–û–í–ö–ê –ù–ï–ü–û–î–•–û–î–Ø–©–ï–ì–û –ö–û–ù–¢–ï–ù–¢–ê ====================

function showContentBlockedModal() {
const modal = document.createElement('div');
modal.className = 'content-blocked-modal';

const content = document.createElement('div');
content.className = 'content-blocked-content';

content.innerHTML = `
  <div class="content-blocked-icon">üö´</div>
  <div class="content-blocked-title">${translations[currentLanguage].contentBlocked}</div>
  <div class="content-blocked-message">${translations[currentLanguage].contentPolicyViolation}</div>
  <button class="content-blocked-button" onclick="this.parentElement.parentElement.remove()">
      ${translations[currentLanguage].tryAgain}
  </button>
`;

modal.appendChild(content);
document.body.appendChild(modal);

setTimeout(() => {
  modal.remove();
}, 5000);
}

// ==================== ‚úÖ –ò–ù–¢–ï–†–§–ï–ô–° –ò –ú–ï–î–ò–ê –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –ú–ï–î–ò–ê –§–ê–ô–õ–ê –° –ü–û–î–î–ï–†–ñ–ö–û–ô –í–ò–î–ï–û
function handleMediaUpload(event) {
const file = event.target.files[0];
if (!file) return;

if (file.size > 10 * 1024 * 1024) {
  notificationManager.show(
      currentLanguage === 'en' ? 'File too large. Maximum 10MB.' :
      currentLanguage === 'ru' ? '–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º—É–º 10MB.' :
      '–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π. –ú–∞–∫—Å–∏–º—É–º 10MB.',
      'error'
  );
  return;
}

const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'video/mp4', 'video/webm', 'video/mov'];
if (!allowedTypes.includes(file.type)) {
  notificationManager.show(
      currentLanguage === 'en' ? 'Unsupported file type. Use JPG, PNG, GIF, MP4, WebM.' :
      currentLanguage === 'ru' ? '–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JPG, PNG, GIF, MP4, WebM.' :
      '–ù–µ–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏–π —Ç–∏–ø —Ñ–∞–π–ª—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ JPG, PNG, GIF, MP4, WebM.',
      'error'
  );
  return;
}

const reader = new FileReader();
reader.onload = function(e) {
  uploadedMedia = {
      type: file.type.startsWith('video/') ? 'video' : 'image',
      data: e.target.result,
      file: file
  };
  
  displayMediaPreview();
  checkCreateButtonState();
  
  // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–∏–¥–µ–æ URL –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞
  const videoUrlField = document.getElementById('videoUrl');
  if (videoUrlField) {
      videoUrlField.value = '';
      videoUrlField.style.borderColor = '#444';
      videoUrlField.style.background = '#333';
  }
};
reader.readAsDataURL(file);
}

// ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–µ–¥–∏–∞
function displayMediaPreview() {
const preview = document.getElementById('mediaPreview');
if (!preview) return;

preview.style.display = 'block';
preview.style.position = 'relative';
preview.innerHTML = '';

if (uploadedMedia.type === 'image') {
  const img = document.createElement('img');
  img.src = uploadedMedia.data;
  img.style.cssText = 'width: 100%; height: auto; border-radius: 10px;';
  img.alt = 'Preview';
  
  const button = document.createElement('button');
  button.textContent = '√ó';
  button.style.cssText = 'position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; z-index: 10;';
  button.onclick = removeMedia;
  
  preview.appendChild(img);
  preview.appendChild(button);
  
} else {
  const video = document.createElement('video');
  video.src = uploadedMedia.data;
  video.controls = true;
  video.style.cssText = 'width: 100%; height: auto; border-radius: 10px;';
  
  const button = document.createElement('button');
  button.textContent = '√ó';
  button.style.cssText = 'position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; z-index: 10;';
  button.onclick = removeMedia;
  
  preview.appendChild(video);
  preview.appendChild(button);
}
}

// ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞
function removeMedia() {
uploadedMedia = null;
const preview = document.getElementById('mediaPreview');
const mediaUpload = document.getElementById('mediaUpload');

if (preview) {
   preview.style.display = 'none';
   preview.innerHTML = '';
}
if (mediaUpload) {
   mediaUpload.value = '';
}
checkCreateButtonState();
}

// ==================== ‚úÖ –≠–ú–û–î–ó–ò –§–£–ù–ö–¶–ò–ò –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

// ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä–∞
function initializeEmojiPicker() {
loadEmojis('smileys');

document.querySelectorAll('.emoji-categories button').forEach(btn => {
  btn.addEventListener('click', function() {
      document.querySelectorAll('.emoji-categories button').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      loadEmojis(this.dataset.category);
  });
});
}

// ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –ø–∏–∫–µ—Ä–∞
function toggleEmojiPicker() {
const emojiPicker = document.getElementById('emojiPicker');
if (!emojiPicker) return;

if (emojiPicker.style.display === 'block') {
  emojiPicker.style.display = 'none';
} else {
  emojiPicker.style.display = 'block';
  loadEmojis('smileys');
}
}

// ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —ç–º–æ–¥–∑–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
function loadEmojis(category) {
const container = document.querySelector('.emoji-container');
if (!container) return;

container.innerHTML = '';

document.querySelectorAll('.emoji-categories button').forEach(btn => {
  btn.classList.remove('active');
});

const activeBtn = document.querySelector(`.emoji-categories button[data-category="${category}"]`);
if (activeBtn) {
   activeBtn.classList.add('active');
}

if (emojis[category]) {
   emojis[category].forEach(emoji => {
       const button = document.createElement('button');
       button.textContent = emoji;
       button.onclick = () => insertEmoji(emoji);
       container.appendChild(button);
   });
}
}

// ‚úÖ –í—Å—Ç–∞–≤–∫–∞ —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
function insertEmoji(emoji) {
const textarea = document.getElementById('greetingText');
if (!textarea) return;

const start = textarea.selectionStart;
const end = textarea.selectionEnd;
const text = textarea.value;

textarea.value = text.substring(0, start) + emoji + text.substring(end);
textarea.focus();
textarea.selectionStart = textarea.selectionEnd = start + emoji.length;

const emojiPicker = document.getElementById('emojiPicker');
if (emojiPicker) {
   emojiPicker.style.display = 'none';
}

checkCreateButtonState();
}

// ==================== ‚úÖ –ü–û–ó–ò–¶–ò–û–ù–ò–†–û–í–ê–ù–ò–ï –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

// ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞
function setTextPosition(position) {
selectedTextPosition = position;

document.querySelectorAll('#text .position-btn').forEach(btn => {
  btn.classList.remove('active');
});

const targetBtn = document.querySelector(`#text .position-btn[data-position="${position}"]`);
if (targetBtn) {
   targetBtn.classList.add('active');
}
}

// ‚úÖ –í—ã–±–æ—Ä —Å—Ç–∏–ª—è
function selectStyle(style) {
selectedStyle = style;
document.querySelectorAll('.style-option').forEach(opt => {
  opt.classList.remove('active');
});

const targetStyle = document.querySelector(`[data-style="${style}"]`);
if (targetStyle) {
   targetStyle.classList.add('active');
}
}

// ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ CTA
function toggleCTA() {
const ctaToggle = document.getElementById('ctaToggle');
const settings = document.getElementById('ctaSettings');

if (ctaToggle && settings) {
   settings.style.display = ctaToggle.checked ? 'block' : 'none';
}
}

// ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ CTA –∫–Ω–æ–ø–∫–∏
function setCTAPosition(position) {
selectedCTAPosition = position;

const ctaPositionBtns = document.querySelectorAll('#ctaSettings .position-btn');
ctaPositionBtns.forEach(btn => {
  btn.classList.remove('active');
  if (btn.dataset.position === position) {
      btn.classList.add('active');
  }
});
}

// ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
function toggleMarquee() {
const marqueeToggle = document.getElementById('marqueeToggle');
const settings = document.getElementById('marqueeSettings');

if (marqueeToggle && settings) {
   settings.style.display = marqueeToggle.checked ? 'block' : 'none';
}
}

// ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞
function toggleBanner() {
const bannerToggle = document.getElementById('bannerToggle');
const settings = document.getElementById('bannerSettings');

if (bannerToggle && settings) {
   settings.style.display = bannerToggle.checked ? 'block' : 'none';
}
}

// ==================== ‚úÖ –®–ê–ë–õ–û–ù–´ –ò –ü–†–ï–î–ü–†–û–°–ú–û–¢–† –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

// ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
function useTemplate(templateName) {
const greetingTextarea = document.getElementById('greetingText');
if (!greetingTextarea || !templates[templateName] || !templates[templateName][currentLanguage]) {
   return;
}

const template = templates[templateName][currentLanguage];
greetingTextarea.value = template.greeting;
checkCreateButtonState();

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —à–∞–±–ª–æ–Ω–∞
notificationManager.show(
   currentLanguage === 'en' ? `Template "${templateName}" applied!` :
   currentLanguage === 'ru' ? `–®–∞–±–ª–æ–Ω "${templateName}" –ø—Ä–∏–º–µ–Ω–µ–Ω!` :
   `–®–∞–±–ª–æ–Ω "${templateName}" –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ!`,
   'success', 2000
);
}

// ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è
function checkCreateButtonState() {
const greetingText = document.getElementById('greetingText')?.value?.trim() || '';
const videoUrl = document.getElementById('videoUrl')?.value?.trim() || '';
const createBtn = document.getElementById('createCardBtn');
const saveBtn = document.getElementById('saveToArchiveBtn');

if (!createBtn) return;

const hasContent = greetingText || uploadedMedia || videoUrl;

if (hasContent) {
  createBtn.disabled = false;
  createBtn.style.background = 'linear-gradient(45deg, #43A047, #2E7D32)';
  createBtn.style.cursor = 'pointer';
  
  // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏–≤ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∏ –¥–æ—Å—Ç—É–ø
  if (saveBtn && currentUser && currentUser.level >= 1) {
      saveBtn.disabled = false;
      saveBtn.className = 'archive-btn save';
  }
} else {
  createBtn.disabled = true;
  createBtn.style.background = '#666';
  createBtn.style.cursor = 'not-allowed';
  
  // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏–≤
  if (saveBtn) {
      saveBtn.disabled = true;
      saveBtn.style.background = '#666';
      saveBtn.style.cursor = 'not-allowed';
  }
}
}

// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–ï–î–ü–†–û–°–ú–û–¢–†–ê –° –ü–û–î–î–ï–†–ñ–ö–û–ô –í–°–ï–• –í–ò–î–ï–û
function showPreview() {
const greetingText = document.getElementById('greetingText')?.value?.trim() || '';
const videoUrl = document.getElementById('videoUrl')?.value?.trim() || '';

if (!greetingText && !uploadedMedia && !videoUrl) {
  notificationManager.show(
      currentLanguage === 'en' ? 'Add text or media for preview' :
      currentLanguage === 'ru' ? '–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ –º–µ–¥–∏–∞ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞' :
      '–î–æ–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç –∞–±–æ –º–µ–¥—ñ–∞ –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É',
      'error'
  );
  return;
}

createPreview();
const previewModal = document.getElementById('previewModal');
if (previewModal) {
   previewModal.style.display = 'flex';
   document.body.style.overflow = 'hidden';
}
}

// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–û–ó–î–ê–ù–ò–Ø –ü–†–ï–î–ü–†–û–°–ú–û–¢–†–ê
function createPreview() {
const container = document.getElementById('previewContainer');
if (!container) return;

const greetingText = document.getElementById('greetingText')?.value?.trim() || '';
const videoUrl = document.getElementById('videoUrl')?.value?.trim() || '';

container.innerHTML = '';

const mainDiv = document.createElement('div');
mainDiv.style.cssText = 'width: 100%; height: 100%; position: relative; overflow: hidden; border-radius: 15px;';

const bgDiv = document.createElement('div');
bgDiv.className = `style-background style-${selectedStyle}`;
mainDiv.appendChild(bgDiv);

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –º–µ–¥–∏–∞
if (uploadedMedia) {
  if (uploadedMedia.type === 'image') {
      const img = document.createElement('img');
      img.src = uploadedMedia.data;
      img.style.cssText = 'width: 100%; height: 100%; object-fit: contain; position: absolute; top: 0; left: 0; z-index: 2;';
      mainDiv.appendChild(img);
  } else {
      const video = document.createElement('video');
      video.src = uploadedMedia.data;
      video.style.cssText = 'width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; z-index: 2;';
      video.autoplay = true;
      video.muted = true;
      video.loop = true;
      mainDiv.appendChild(video);
  }
} 
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ URL
else if (videoUrl) {
const videoData = videoProcessor.parseVideoUrl(videoUrl);

if (videoData.isValid) {
    const videoContainer = document.createElement('div');
    videoContainer.className = 'video-container';
    videoContainer.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2;';
    
    const iframe = document.createElement('iframe');
    iframe.width = '100%';
    iframe.height = '100%';
    iframe.src = videoData.embedUrl;
    iframe.frameBorder = '0';
    iframe.allowFullscreen = true;
    iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
    iframe.style.cssText = 'width: 100%; height: 100%; border: none;';
    
    videoContainer.appendChild(iframe);
    mainDiv.appendChild(videoContainer);
} else {
    const errorDiv = document.createElement('div');
    errorDiv.innerHTML = `‚ùå ${videoData.error}`;
    errorDiv.style.cssText = 'position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(255, 68, 68, 0.8); color: white; padding: 20px; border-radius: 10px; text-align: center; z-index: 2;';
    mainDiv.appendChild(errorDiv);
}
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è
if (greetingText) {
  const greetingDiv = document.createElement('div');
  greetingDiv.className = 'card-greeting-new';
  
  let textPositionStyle = '';
  if (selectedTextPosition.includes('top')) {
      textPositionStyle += 'top: 20px;';
  } else if (selectedTextPosition.includes('bottom')) {
      textPositionStyle += 'bottom: 20px;';
  } else {
      textPositionStyle += 'top: 50%; transform: translateY(-50%);';
  }

  if (selectedTextPosition.includes('Left')) {
      textPositionStyle += 'left: 20px; right: auto; text-align: left; width: calc(100% - 40px);';
  } else if (selectedTextPosition.includes('Right')) {
      textPositionStyle += 'right: 20px; left: auto; text-align: right; width: calc(100% - 40px);';
  } else {
      textPositionStyle += 'left: 20px; right: 20px; text-align: center; width: calc(100% - 40px);';
  }
  
  greetingDiv.style.cssText = textPositionStyle + ' display: block; box-sizing: border-box;';
  
  const lines = greetingText.split('\n');
  lines.forEach((line, index) => {
      if (index > 0) {
          greetingDiv.appendChild(document.createElement('br'));
      }
      greetingDiv.appendChild(document.createTextNode(line));
  });
  
  mainDiv.appendChild(greetingDiv);
}

container.appendChild(mainDiv);

// –î–æ–±–∞–≤–ª—è–µ–º CTA, –±–µ–≥—É—â—É—é —Å—Ç—Ä–æ–∫—É –∏ –±–∞–Ω–Ω–µ—Ä –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
const ctaToggle = document.getElementById('ctaToggle');
if (ctaToggle && ctaToggle.checked) {
  const ctaTitle = document.getElementById('ctaTitle')?.value?.trim() || '';
  const ctaButton = document.getElementById('ctaButton')?.value?.trim() || '';
  const ctaUrl = document.getElementById('ctaUrl')?.value?.trim() || '';
  
  if (ctaTitle && ctaButton) {
      displayCTAButton(ctaTitle, ctaButton, ctaUrl, selectedCTAPosition);
  }
}

const marqueeToggle = document.getElementById('marqueeToggle');
if (marqueeToggle && marqueeToggle.checked) {
  const marqueeText = document.getElementById('marqueeTextInput')?.value?.trim() || '';
  const marqueeUrl = document.getElementById('marqueeUrl')?.value?.trim() || '';
  
  if (marqueeText) {
      displayMarquee(marqueeText, marqueeUrl);
  }
}

const bannerToggle = document.getElementById('bannerToggle');
if (bannerToggle && bannerToggle.checked) {
  const bannerHtml = document.getElementById('bannerHtml')?.value?.trim() || '';
  const bannerUrl = document.getElementById('bannerUrl')?.value?.trim() || '';
  
  if (bannerHtml || bannerUrl) {
      displayBanner(bannerHtml, bannerUrl);
  }
}
}

// ‚úÖ –§—É–Ω–∫—Ü–∏—è displayCTAButton
function displayCTAButton(ctaTitle, ctaButton, ctaUrl, position) {
const existingCTA = document.querySelector('.cta-container');
if (existingCTA) {
  existingCTA.remove();
}

const ctaEl = document.createElement('div');
ctaEl.className = 'cta-container';
ctaEl.style.position = 'absolute';
ctaEl.style.zIndex = '20';
ctaEl.style.textAlign = 'center';
ctaEl.style.color = 'white';
ctaEl.style.fontWeight = 'bold';

if (position.includes('Left')) {
  ctaEl.style.left = '20px';
} else if (position.includes('Right')) {
  ctaEl.style.right = '20px';
} else {
  ctaEl.style.left = '50%';
  ctaEl.style.transform = 'translateX(-50%)';
}

if (position.includes('top')) {
  ctaEl.style.top = '20px';
} else if (position.includes('bottom')) {
  ctaEl.style.bottom = '20px';
} else {
  ctaEl.style.top = '50%';
  if (ctaEl.style.transform) {
      ctaEl.style.transform += ' translateY(-50%)';
  } else {
      ctaEl.style.transform = 'translateY(-50%)';
  }
}

const titleDiv = document.createElement('div');
titleDiv.style.marginBottom = '5px';
titleDiv.textContent = ctaTitle;

const button = document.createElement('button');
button.style.cssText = 'background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-weight: bold;';
button.textContent = ctaButton;

if (ctaUrl && ctaUrl.trim()) {
  button.onclick = () => window.open(ctaUrl, '_blank');
} else {
  button.onclick = () => window.open('registration.html', '_blank');
}

ctaEl.appendChild(titleDiv);
ctaEl.appendChild(button);

const previewContainer = document.getElementById('previewContainer');
if (previewContainer) {
   previewContainer.appendChild(ctaEl);
}
}

// ‚úÖ –§—É–Ω–∫—Ü–∏—è displayMarquee –¥–ª—è –±–µ–≥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
function displayMarquee(marqueeText, marqueeUrl) {
const marqueeEl = document.createElement('div');
marqueeEl.className = 'marquee-container';

const marqueeTextDiv = document.createElement('div');
marqueeTextDiv.className = 'marquee-text';
marqueeTextDiv.textContent = marqueeText;
marqueeEl.appendChild(marqueeTextDiv);

if (marqueeUrl && marqueeUrl.trim()) {
  marqueeEl.style.cursor = 'pointer';
  marqueeEl.onclick = () => {
      if (marqueeUrl.startsWith('http://') || marqueeUrl.startsWith('https://')) {
          window.open(marqueeUrl, '_blank');
      }
  };
}

const previewContainer = document.getElementById('previewContainer');
if (previewContainer) {
   previewContainer.appendChild(marqueeEl);
}
}

// ‚úÖ –§—É–Ω–∫—Ü–∏—è displayBanner
function displayBanner(bannerHtml, bannerUrl) {
const bannerEl = document.createElement('div');
bannerEl.style.position = 'absolute';
bannerEl.style.top = '0';
bannerEl.style.left = '0';
bannerEl.style.width = '100%';
bannerEl.style.zIndex = '25';
bannerEl.style.textAlign = 'center';
bannerEl.style.padding = '10px';
bannerEl.style.background = 'rgba(255, 0, 0, 0.9)';
bannerEl.style.color = 'white';
bannerEl.style.fontWeight = 'bold';

if (bannerHtml) {
  bannerEl.innerHTML = sanitizeInput(bannerHtml);
} else {
  bannerEl.innerHTML = '<div>–†–µ–∫–ª–∞–º–∞</div>';
}

if (bannerUrl) {
  bannerEl.style.cursor = 'pointer';
  bannerEl.onclick = () => window.open(bannerUrl, '_blank');
}

const previewContainer = document.getElementById('previewContainer');
if (previewContainer) {
   previewContainer.appendChild(bannerEl);
}
}

// ‚úÖ –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
function closePreview() {
const previewModal = document.getElementById('previewModal');
if (previewModal) {
   previewModal.style.display = 'none';
   document.body.style.overflow = 'auto';
}
}

// ==================== ‚úÖ –ò–ù–°–¢–†–£–ö–¶–ò–ò –ò –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ====================

function showInstructions() {
const instructionsModal = document.getElementById('instructionsModal');
if (instructionsModal) {
   instructionsModal.style.display = 'block';
   document.body.style.overflow = 'hidden';
}
}

function hideInstructions() {
const instructionsModal = document.getElementById('instructionsModal');
if (instructionsModal) {
   instructionsModal.style.display = 'none';
   document.body.style.overflow = 'auto';
}
}

// ‚úÖ –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –ù–ê–í–ò–ì–ê–¶–ò–ò

// –ü–µ—Ä–µ—Ö–æ–¥ –∫ Dashboard
function goToDashboard() {
window.location.href = `/dashboard.html?lang=${currentLanguage}`;
}

// –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∞—Ä—Ö–∏–≤—É
function goToArchive() {
if (currentUser && currentUser.level >= 1) {
   window.location.href = `/dashboard.html?section=archive&lang=${currentLanguage}`;
} else {
   notificationManager.show(
       currentLanguage === 'en' ? 'Archive access requires account activation' :
       currentLanguage === 'ru' ? '–î–æ—Å—Ç—É–ø –∫ –∞—Ä—Ö–∏–≤—É —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞' :
       '–î–æ—Å—Ç—É–ø –¥–æ –∞—Ä—Ö—ñ–≤—É –ø–æ—Ç—Ä–µ–±—É—î –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –∞–∫–∞—É–Ω—Ç—É',
       'warning'
   );
}
}

// ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∞—Ä—Ö–∏–≤ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
async function saveCurrentToArchive() {
const greetingText = document.getElementById('greetingText')?.value?.trim() || '';
const videoUrl = document.getElementById('videoUrl')?.value?.trim() || '';

if (!greetingText && !uploadedMedia && !videoUrl) {
  notificationManager.show(
      currentLanguage === 'en' ? 'Create content first before saving to archive' :
      currentLanguage === 'ru' ? '–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –∞—Ä—Ö–∏–≤' :
      '–°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –≤ –∞—Ä—Ö—ñ–≤',
      'error'
  );
  return;
}

if (!currentUser || currentUser.level < 1) {
  notificationManager.show(
      currentLanguage === 'en' ? 'Archive access requires account activation' :
      currentLanguage === 'ru' ? '–î–æ—Å—Ç—É–ø –∫ –∞—Ä—Ö–∏–≤—É —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞' :
      '–î–æ—Å—Ç—É–ø –¥–æ –∞—Ä—Ö—ñ–≤—É –ø–æ—Ç—Ä–µ–±—É—î –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –∞–∫–∞—É–Ω—Ç—É',
      'warning'
  );
  return;
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç—ã –∞—Ä—Ö–∏–≤–∞
if (!levelManager.canSaveToArchive(currentUser.level, currentUser.archiveCount || 0)) {
  const levelInfo = levelManager.getLevelInfo(currentUser.level);
  notificationManager.show(
      currentLanguage === 'en' ? `Archive limit reached (${levelInfo.archiveLimit}). Upgrade your account.` :
      currentLanguage === 'ru' ? `–î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∞—Ä—Ö–∏–≤–∞ (${levelInfo.archiveLimit}). –£–ª—É—á—à–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç.` :
      `–î–æ—Å—è–≥–Ω—É—Ç–æ –ª—ñ–º—ñ—Ç –∞—Ä—Ö—ñ–≤—É (${levelInfo.archiveLimit}). –ü–æ–∫—Ä–∞—â—Ç–µ –∞–∫–∞—É–Ω—Ç.`,
      'warning', 5000
  );
  return;
}

try {
   const cardMetadata = await prepareCardMetadata();
   cardMetadata.isArchived = true;
   cardMetadata.archivedAt = new Date().toISOString();
   
   // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∞—Ä—Ö–∏–≤
   await saveCard(cardMetadata);
   
   // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∞—Ä—Ö–∏–≤–∞
   currentUser.archiveCount = (currentUser.archiveCount || 0) + 1;
   localStorage.setItem('currentUser', JSON.stringify(currentUser));
   levelManager.updateUserInterface(currentUser);
   
   notificationManager.show(
       currentLanguage === 'en' ? 'üíæ Card saved to archive!' :
       currentLanguage === 'ru' ? 'üíæ –ö–∞—Ä—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –∞—Ä—Ö–∏–≤!' :
       'üíæ –ö–∞—Ä—Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–∞ –≤ –∞—Ä—Ö—ñ–≤!',
       'success'
   );
   
   // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
   clearForm();
   
} catch (error) {
   console.error('‚ùå Archive save error:', error);
   notificationManager.show(
       currentLanguage === 'en' ? 'Error saving to archive' :
       currentLanguage === 'ru' ? '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏–≤' :
       '–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –∞—Ä—Ö—ñ–≤',
       'error'
   );
}
}

// –ü–µ—Ä–µ—Ö–æ–¥ –∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
function goToActivation() {
window.location.href = `/dashboard.html?section=wallet&lang=${currentLanguage}`;
}

// ==================== ‚úÖ –£–¢–ò–õ–ò–¢–´ –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

// ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function generateUserId() {
try {
  const array = new Uint32Array(2);
  window.crypto.getRandomValues(array);
  const randomNum = (array[0] % 9000000) + 1000000;
  return randomNum.toString();
} catch (error) {
  return Math.floor(1000000 + Math.random() * 9000000).toString();
}
}

// ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–∞ –≤ base64
function fileToBase64(file) {
return new Promise((resolve, reject) => {
  const reader = new FileReader();
  reader.readAsDataURL(file);
  reader.onload = () => resolve(reader.result);
  reader.onerror = error => reject(error);
});
}

// ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ö–µ—à–∞
async function createSecureHash(data) {
try {
  const encoder = new TextEncoder();
  const dataBuffer = encoder.encode(data);
  const hashBuffer = await crypto.subtle.digest('SHA-256', dataBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
} catch (error) {
  console.warn('‚ö†Ô∏è Could not create hash:', error);
  return 'hash_' + Date.now();
}
}

// ‚úÖ WEB3: –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏
async function saveCard(cardMetadata) {
   try {
       console.log('üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞—Ä—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä...');
       
       // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
       const response = await fetch('/api/save-card', {
           method: 'POST',
           headers: {
               'Content-Type': 'application/json',
           },
           body: JSON.stringify({
               cardId: cardMetadata.cardId,
               cardData: cardMetadata
           })
       });
       
       if (!response.ok) {
           throw new Error(`Server error: ${response.status}`);
       }
       
       const result = await response.json();
       
       if (result.success) {
           console.log('‚úÖ –ö–∞—Ä—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', cardMetadata.cardId);
           
           // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
           const lightMetadata = { ...cardMetadata };
           delete lightMetadata.previewImageUrl;
           localStorage.setItem(`card_${cardMetadata.cardId}`, JSON.stringify(lightMetadata));
           
           return cardMetadata;
       } else {
           throw new Error(result.error || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä');
       }
       
   } catch (error) {
       console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã:', error);
       
       // Fallback –∫ localStorage
       const lightMetadata = { ...cardMetadata };
       delete lightMetadata.previewImageUrl;
       localStorage.setItem(`card_${cardMetadata.cardId}`, JSON.stringify(lightMetadata));
       
       console.log('üíæ –ö–∞—Ä—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –∫–∞–∫ fallback');
       return cardMetadata;
   }
}

// ‚úÖ –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function showWelcomeBanner(userId) {
const banner = document.createElement('div');
banner.className = 'welcome-banner show';
banner.innerHTML = `
   <h3>${currentLanguage === 'en' ? 'Welcome to CardGift!' : 
         currentLanguage === 'ru' ? '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CardGift!' : 
         '–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ CardGift!'}</h3>
   <p>${currentLanguage === 'en' ? `Your unique ID: ${userId}. Start creating beautiful digital cards!` : 
       currentLanguage === 'ru' ? `–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID: ${userId}. –ù–∞—á–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏!` : 
       `–í–∞—à —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID: ${userId}. –ü–æ—á–Ω—ñ—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫—Ä–∞—Å–∏–≤—ñ —Ü–∏—Ñ—Ä–æ–≤—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏!`}</p>
`;

const firstSection = document.querySelector('.section');
if (firstSection) {
   firstSection.parentNode.insertBefore(banner, firstSection);
   
   setTimeout(() => {
       banner.classList.remove('show');
       setTimeout(() => {
           if (banner.parentNode) {
               banner.parentNode.removeChild(banner);
           }
       }, 600);
   }, 5000);
}
}

// ==================== ‚úÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô –° –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò ====================

// ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
function setupEventListeners() {
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
const greetingTextarea = document.getElementById('greetingText');
if (greetingTextarea) {
   greetingTextarea.addEventListener('input', checkCreateButtonState);
}

// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –ò–ó–ú–ï–ù–ï–ù–ò–Ø VIDEO URL
const videoUrlField = document.getElementById('videoUrl');
if (videoUrlField) {
   videoUrlField.addEventListener('input', function() {
       checkCreateButtonState();
       
       // –û—á–∏—â–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –º–µ–¥–∏–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ URL
       if (this.value.trim() && uploadedMedia) {
           removeMedia();
       }
       
       const url = this.value.trim();
       if (url) {
           const videoData = videoProcessor.parseVideoUrl(url);
           
           if (videoData.isValid) {
               this.style.borderColor = '#4CAF50';
               this.style.background = 'rgba(76, 175, 80, 0.05)';
               
               // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
               const platformIndicator = document.createElement('div');
               platformIndicator.style.cssText = 'position: absolute; top: 5px; right: 5px; background: #4CAF50; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; z-index: 10;';
               platformIndicator.textContent = videoData.platform.toUpperCase();
               
               if (!this.parentElement.querySelector('.platform-indicator')) {
                   this.parentElement.style.position = 'relative';
                   platformIndicator.className = 'platform-indicator';
                   this.parentElement.appendChild(platformIndicator);
                   
                   setTimeout(() => {
                       if (platformIndicator.parentElement) {
                           platformIndicator.parentElement.removeChild(platformIndicator);
                       }
                   }, 3000);
               }
           } else {
               this.style.borderColor = '#f44336';
               this.style.background = 'rgba(244, 67, 54, 0.05)';
           }
       } else {
           this.style.borderColor = '#444';
           this.style.background = '#333';
       }
   });
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏
const instructionsModal = document.getElementById('instructionsModal');
if (instructionsModal) {
   instructionsModal.addEventListener('click', function(e) {
       if (e.target === this) {
           hideInstructions();
       }
   });
}

const previewModal = document.getElementById('previewModal');
if (previewModal) {
   previewModal.addEventListener('click', function(e) {
       if (e.target === this) {
           closePreview();
       }
   });
}

// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –ù–ê–ñ–ê–¢–ò–Ø –ö–õ–ê–í–ò–®
document.addEventListener('keydown', function(e) {
   if (e.key === 'Escape') {
       // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
       document.querySelectorAll('.modal[style*="flex"], .instructions-modal[style*="block"], .share-modal').forEach(modal => {
           modal.style.display = 'none';
       });
       
       const emojiPicker = document.getElementById('emojiPicker');
       if (emojiPicker && emojiPicker.style.display === 'block') {
           emojiPicker.style.display = 'none';
       }
       
       document.body.style.overflow = 'auto';
   }
   
   // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
   if (e.ctrlKey || e.metaKey) {
       switch(e.key) {
           case 'Enter':
               e.preventDefault();
               if (!document.getElementById('createCardBtn').disabled) {
                   createCard();
               }
               break;
           case 'p':
               e.preventDefault();
               showPreview();
               break;
           case 'i':
               e.preventDefault();
               showInstructions();
               break;
       }
   }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
const searchInputs = document.querySelectorAll('input[type="text"]');
searchInputs.forEach(input => {
   input.addEventListener('keypress', function(e) {
       if (e.key === 'Enter') {
           e.preventDefault();
       }
   });
});

// –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
const settingsInputs = document.querySelectorAll('input, select, textarea');
settingsInputs.forEach(input => {
   input.addEventListener('change', function() {
       if (this.id && this.id !== 'greetingText' && this.id !== 'videoUrl') {
           // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ localStorage
           const settingKey = `generator_setting_${this.id}`;
           const settingValue = this.type === 'checkbox' ? this.checked : this.value;
           localStorage.setItem(settingKey, JSON.stringify(settingValue));
       }
   });
});

console.log('‚úÖ Event listeners setup completed');
}

// ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
function loadSavedSettings() {
const settingsInputs = document.querySelectorAll('input, select, textarea');
settingsInputs.forEach(input => {
   if (input.id && input.id !== 'greetingText' && input.id !== 'videoUrl' && input.id !== 'mediaUpload') {
       const settingKey = `generator_setting_${input.id}`;
       const savedValue = localStorage.getItem(settingKey);
       
       if (savedValue !== null) {
           try {
               const parsedValue = JSON.parse(savedValue);
               if (input.type === 'checkbox') {
                   input.checked = parsedValue;
               } else {
                   input.value = parsedValue;
               }
               
               // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
               if (input.id === 'ctaToggle') toggleCTA();
               if (input.id === 'marqueeToggle') toggleMarquee();
               if (input.id === 'bannerToggle') toggleBanner();
           } catch (error) {
               console.warn('Error loading setting:', settingKey, error);
           }
       }
   }
});
}

// ==================== ‚úÖ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ====================

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
checkCreateButtonState();
loadSavedSettings();
});

// –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –µ—Å–ª–∏ DOMContentLoaded —É–∂–µ –ø—Ä–æ—à–µ–ª
if (document.readyState === 'loading') {
   document.addEventListener('DOMContentLoaded', initializeWeb3App);
} else {
   initializeWeb3App();
}

// ==================== ‚úÖ –≠–ö–°–ü–û–†–¢ –§–£–ù–ö–¶–ò–ô –î–õ–Ø –ì–õ–û–ë–ê–õ–¨–ù–û–ì–û –î–û–°–¢–£–ü–ê ====================

// –î–µ–ª–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è onclick –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
window.switchLanguage = switchLanguage;
window.connectWallet = connectWallet;
window.handleMediaUpload = handleMediaUpload;
window.toggleEmojiPicker = toggleEmojiPicker;
window.loadEmojis = loadEmojis;
window.setTextPosition = setTextPosition;
window.selectStyle = selectStyle;
window.useTemplate = useTemplate;
window.showInstructions = showInstructions;
window.hideInstructions = hideInstructions;
window.showPreview = showPreview;
window.closePreview = closePreview;
window.createCard = createCard;
window.toggleCTA = toggleCTA;
window.setCTAPosition = setCTAPosition;
window.toggleMarquee = toggleMarquee;
window.toggleBanner = toggleBanner;
window.saveCurrentToArchive = saveCurrentToArchive;
window.goToDashboard = goToDashboard;
window.goToArchive = goToArchive;
window.goToActivation = goToActivation;
window.sharePreviewDirectly = sharePreviewDirectly;
window.shareToMessenger = shareToMessenger;
window.shareToSocial = shareToSocial;
window.copyToClipboard = copyToClipboard;

// ==================== ‚úÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô WEB3 ====================

// ‚úÖ –û–ë–†–ê–ë–û–¢–ß–ò–ö –°–ú–ï–ù–´ –°–ï–¢–ò - –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ù–ê opBNB
if (window.ethereum) {
   window.ethereum.on('chainChanged', (chainId) => {
       const currentChainId = parseInt(chainId, 16);
       console.log('üîÑ Network changed to:', currentChainId);
       
       if (currentChainId !== 204) {
           notificationManager.show('‚ö†Ô∏è Switch to opBNB (Chain ID: 204) for proper operation', 'warning', 5000);
           updateNetworkStatus();
       } else {
           notificationManager.show('‚úÖ Connected to opBNB!', 'success');
           updateNetworkStatus();
       }
   });
   
   window.ethereum.on('accountsChanged', (accounts) => {
       if (accounts.length === 0) {
           console.log('üîå Wallet disconnected');
           walletConnected = false;
           
           notificationManager.show(
               currentLanguage === 'en' ? 'Wallet disconnected. Reconnecting...' :
               currentLanguage === 'ru' ? '–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω. –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...' :
               '–ì–∞–º–∞–Ω–µ—Ü—å –≤—ñ–¥–∫–ª—é—á–µ–Ω–æ. –ü–µ—Ä–µ–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...',
               'info'
           );
           
           setTimeout(() => {
               location.reload();
           }, 2000);
       } else {
           console.log('üë§ Account changed to:', accounts[0]);
           
           notificationManager.show(
               currentLanguage === 'en' ? 'Account changed. Refreshing...' :
               currentLanguage === 'ru' ? '–ê–∫–∫–∞—É–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...' :
               '–ê–∫–∞—É–Ω—Ç –∑–º—ñ–Ω–µ–Ω–æ. –û–Ω–æ–≤–ª–µ–Ω–Ω—è...',
               'info'
           );
           
           setTimeout(() => {
               location.reload();
           }, 1500);
       }
   });
}

// ==================== ‚úÖ –§–£–ù–ö–¶–ò–ò –û–¢–õ–ê–î–ö–ò (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) ====================

window.cardGiftDebug = {
   // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
   currentUser: () => {
       console.log('Current User:', currentUser);
       return currentUser;
   },
   
   // –°–±—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   resetUser: () => {
       currentUser = { 
           userId: generateUserId(), 
           level: 0, 
           isActive: false, 
           walletAddress: null,
           cardCount: 0,
           archiveCount: 0
       };
       localStorage.setItem('currentUser', JSON.stringify(currentUser));
       levelManager.updateUserInterface(currentUser);
       checkArchiveAccess();
       console.log('User reset to:', currentUser);
   },
   
   // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Ä–æ–≤–Ω—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   setLevel: (level) => {
       const newLevel = parseInt(level);
       if (newLevel >= 0 && newLevel <= 6) {
           currentUser.level = newLevel;
           localStorage.setItem('currentUser', JSON.stringify(currentUser));
           levelManager.updateUserInterface(currentUser);
           checkArchiveAccess();
           console.log('User level set to:', newLevel);
           
           notificationManager.show(
               `Debug: Level set to ${newLevel} (${levelManager.getLevelInfo(newLevel).name})`,
               'info'
           );
       } else {
           console.error('Invalid level. Use 0-6');
           notificationManager.show('Invalid level. Use 0-6', 'error');
       }
   },
   
   // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞—Ä—Ç
   setCardCount: (count) => {
       const newCount = parseInt(count);
       if (newCount >= 0) {
           currentUser.cardCount = newCount;
           localStorage.setItem('currentUser', JSON.stringify(currentUser));
           levelManager.updateUserInterface(currentUser);
           console.log('Card count set to:', newCount);
           notificationManager.show(`Debug: Card count set to ${newCount}`, 'info');
       } else {
           console.error('Invalid count. Use positive number');
       }
   },
   
   // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –∫–∞—Ä—Ç
   setArchiveCount: (count) => {
       const newCount = parseInt(count);
       if (newCount >= 0) {
           currentUser.archiveCount = newCount;
           localStorage.setItem('currentUser', JSON.stringify(currentUser));
           levelManager.updateUserInterface(currentUser);
           console.log('Archive count set to:', newCount);
           notificationManager.show(`Debug: Archive count set to ${newCount}`, 'info');
       } else {
           console.error('Invalid count. Use positive number');
       }
   },
   
   // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
   clearStorage: () => {
       localStorage.clear();
       console.log('Storage cleared');
       notificationManager.show('Debug: Storage cleared', 'warning');
       setTimeout(() => location.reload(), 1000);
   },
   
   // –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   exportDebugData: () => {
       const debugData = {
           currentUser,
           walletConnected,
           currentLanguage,
           selectedStyle,
           selectedTextPosition,
           selectedCTAPosition,
           uploadedMedia: uploadedMedia ? {
               type: uploadedMedia.type,
               hasData: !!uploadedMedia.data,
               hasFile: !!uploadedMedia.file
           } : null,
           localStorage: {...localStorage},
           timestamp: Date.now(),
           userAgent: navigator.userAgent,
           url: window.location.href
       };
       console.log('Debug Data:', debugData);
       
       // –°–∫–∞—á–∏–≤–∞–µ–º –∫–∞–∫ JSON —Ñ–∞–π–ª
       const dataStr = JSON.stringify(debugData, null, 2);
       const dataBlob = new Blob([dataStr], {type: 'application/json'});
       const link = document.createElement('a');
       link.href = URL.createObjectURL(dataBlob);
       link.download = `cardgift_debug_${Date.now()}.json`;
       document.body.appendChild(link);
       link.click();
       document.body.removeChild(link);
       
       return debugData;
   },
   
   // –°–∏–º—É–ª—è—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
   simulateCardCreation: () => {
       console.log('üé≠ Simulating card creation...');
       
       // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
       const greetingText = document.getElementById('greetingText');
       if (greetingText) {
           greetingText.value = 'üéâ Test Card\nThis is a debug test card!';
       }
       
       checkCreateButtonState();
       notificationManager.show('Debug: Test data filled', 'info');
   },
   
   // –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   testNotifications: () => {
       notificationManager.show('Test Success Notification', 'success');
       setTimeout(() => notificationManager.show('Test Error Notification', 'error'), 1000);
       setTimeout(() => notificationManager.show('Test Warning Notification', 'warning'), 2000);
       setTimeout(() => notificationManager.show('Test Info Notification', 'info'), 3000);
   },
   
   // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏–º–∏—Ç–∞—Ö
   showLimits: () => {
       const level = currentUser.level;
       const levelInfo = levelManager.getLevelInfo(level);
       
       console.log('Current Level Info:', {
           level: level,
           name: levelInfo.name,
           cardLimit: levelInfo.cardLimit,
           archiveLimit: levelInfo.archiveLimit,
           features: levelInfo.features,
           currentCards: currentUser.cardCount || 0,
           currentArchive: currentUser.archiveCount || 0,
           canCreateCard: levelManager.canCreateCard(level, currentUser.cardCount || 0),
           canSaveToArchive: levelManager.canSaveToArchive(level, currentUser.archiveCount || 0)
       });
   },
   
   // –í–µ—Ä—Å–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
   version: () => {
       const info = {
           version: '2.0.0',
           buildDate: '2025-01-31',
           environment: 'production',
           features: [
               'Web3 Integration',
               'opBNB Network Support',
               'Multi-level User System',
               'Advanced Archive System',
               'Enhanced Video Support',
               'Social Media Sharing',
               'Multi-language Support'
           ],
           browser: navigator.userAgent,
           screen: `${screen.width}x${screen.height}`,
           viewport: `${window.innerWidth}x${window.innerHeight}`,
           language: currentLanguage,
           walletSupport: !!window.ethereum,
           localStorage: localStorage.length + ' items'
       };
       
       console.log('CardGift Generator Info:', info);
       return info;
   }
};

// ==================== ‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∑–∫–µ
console.log('üéâ CardGift Generator –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω!');
console.log('üí° –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç–ª–∞–¥–∫–∏:');
console.log('  cardGiftDebug.currentUser() - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ');
console.log('  cardGiftDebug.setLevel(1-6) - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
console.log('  cardGiftDebug.simulateCardCreation() - –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏');
console.log('  cardGiftDebug.testNotifications() - —Ç–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π');
console.log('  cardGiftDebug.showLimits() - –ø–æ–∫–∞–∑–∞—Ç—å –ª–∏–º–∏—Ç—ã');
console.log('  cardGiftDebug.version() - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏');

// ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞
function checkBrowserCompatibility() {
   const features = {
       webgl: !!window.WebGLRenderingContext,
       canvas: !!document.createElement('canvas').getContext,
       localStorage: !!window.localStorage,
       fetch: !!window.fetch,
       crypto: !!(window.crypto && window.crypto.getRandomValues),
       fileReader: !!window.FileReader,
       clipboardAPI: !!(navigator.clipboard && navigator.clipboard.writeText),
       notifications: !!window.Notification,
       webShare: !!navigator.share,
       ethereum: !!window.ethereum
   };
   
   const unsupported = Object.keys(features).filter(key => !features[key]);
   
   if (unsupported.length > 0) {
       console.warn('‚ö†Ô∏è Unsupported browser features:', unsupported);
       
       if (!features.localStorage) {
           notificationManager.show(
               currentLanguage === 'en' ? 'Your browser doesn\'t support localStorage. Some features may not work.' :
               currentLanguage === 'ru' ? '–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç localStorage. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å.' :
               '–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î localStorage. –î–µ—è–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–æ–∂—É—Ç—å –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.',
               'warning', 8000
           );
       }
       
       if (!features.ethereum) {
           console.log('‚ÑπÔ∏è No Web3 wallet detected. App will work in local mode.');
       }
   } else {
       console.log('‚úÖ All browser features supported!');
   }
   
   return features;
}

// ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
async function autoNetworkCheck() {
   if (window.ethereum && walletConnected) {
       try {
           const chainId = await window.ethereum.request({ method: 'eth_chainId' });
           const currentChainId = parseInt(chainId, 16);
           
           if (currentChainId !== 204) {
               console.log('‚ö†Ô∏è Wrong network detected. Suggesting opBNB switch...');
               
               setTimeout(() => {
                   if (confirm(
                       currentLanguage === 'en' ? 'Switch to opBNB network for better performance?' :
                       currentLanguage === 'ru' ? '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Å–µ—Ç—å opBNB –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏?' :
                       '–ü–µ—Ä–µ–º–∏–∫–Ω—É—Ç–∏—Å—è –Ω–∞ –º–µ—Ä–µ–∂—É opBNB –¥–ª—è –∫—Ä–∞—â–æ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ?'
                   )) {
                       connectWallet();
                   }
               }, 3000);
           }
       } catch (error) {
           console.warn('Auto network check failed:', error);
       }
   }
}

// ‚úÖ –ó–∞–ø—É—Å–∫ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
setTimeout(() => {
   checkBrowserCompatibility();
   autoNetworkCheck();
   
   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
   if (currentUser && currentUser.userId) {
       notificationManager.show(
           currentLanguage === 'en' ? 'üé® CardGift ready! Start creating amazing cards!' :
           currentLanguage === 'ru' ? 'üé® CardGift –≥–æ—Ç–æ–≤! –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏!' :
           'üé® CardGift –≥–æ—Ç–æ–≤–∏–π! –°—Ç–≤–æ—Ä—é–π—Ç–µ –ø—Ä–∏–≥–æ–ª–æ–º—à–ª–∏–≤—ñ –ª–∏—Å—Ç—ñ–≤–∫–∏!',
           'success', 3000
       );
   }
}, 2000);

// ==================== ‚úÖ –°–õ–£–ñ–ï–ë–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================

// ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
function isMobileDevice() {
   return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
          window.innerWidth <= 768;
}

// ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
if (isMobileDevice()) {
   // –û—Ç–∫–ª—é—á–∞–µ–º hover —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
   document.body.classList.add('mobile-device');
   
   // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
   const mobileStyles = document.createElement('style');
   mobileStyles.textContent = `
       .mobile-device .style-option:hover,
       .mobile-device .template-btn:hover,
       .mobile-device .position-btn:hover {
           transform: none !important;
           box-shadow: none !important;
       }
       
       .mobile-device .notification {
           bottom: 10px !important;
           margin: 0 10px !important;
           max-width: calc(100vw - 20px) !important;
       }
   `;
   document.head.appendChild(mobileStyles);
   
   console.log('üì± Mobile optimizations applied');
}

// ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ JavaScript
window.addEventListener('error', function(event) {
   console.error('JavaScript Error:', {
       message: event.message,
       filename: event.filename,
       lineno: event.lineno,
       colno: event.colno,
       error: event.error
   });
   
   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
   if (event.message.includes('fetch') || event.message.includes('network')) {
       notificationManager.show(
           currentLanguage === 'en' ? 'Network error. Please check your connection.' :
           currentLanguage === 'ru' ? '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.' :
           '–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É.',
           'error'
       );
   }
});

// ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ unhandled promise rejections
window.addEventListener('unhandledrejection', function(event) {
   console.error('Unhandled Promise Rejection:', event.reason);
   
   // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–æ–∫–∞–∑ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
   if (event.reason && event.reason.message && 
       (event.reason.message.includes('User rejected') || 
        event.reason.message.includes('User denied'))) {
       event.preventDefault();
   }
});

// ‚úÖ Cleanup —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
window.addEventListener('beforeunload', function() {
   // –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   if (uploadedMedia && uploadedMedia.data && uploadedMedia.data.startsWith('blob:')) {
       URL.revokeObjectURL(uploadedMedia.data);
   }
   
   // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   if (currentUser) {
       localStorage.setItem('currentUser', JSON.stringify(currentUser));
   }
   
   console.log('üßπ Cleanup completed');
});

// ==================== üéâ –§–ò–ù–ê–õ ====================

console.log(`
üé® ====================================
üéÅ CardGift Generator v2.0 –ì–û–¢–û–í!
üé® ====================================

‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
  üîó Web3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å opBNB
  üë• 6 —É—Ä–æ–≤–Ω–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
  üíæ –£–º–Ω–∞—è –∞—Ä—Ö–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
  üé¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ YouTube/TikTok/Instagram
  üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
  üåç 3 —è–∑—ã–∫–∞ (EN/RU/UA)
  üé® 5 —Å—Ç–∏–ª–µ–π –¥–∏–∑–∞–π–Ω–∞
  üìä –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  üõ°Ô∏è –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
  üîÑ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

üöÄ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ cardGiftDebug –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
`);

</script>
</body>
</html>
